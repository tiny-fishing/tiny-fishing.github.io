sc&&(sc.pc||(sc.pc={}));var Constants=pc.createScript("constants");Constants.prototype.initialize=function(){window.Events={OnLoadLevel:"OnLoadLevel",OnUnloadLevel:"OnUnloadLevel",OnGetLevel:"OnGetLevel",OnSwipe:"OnSwipe",OnTouchBegin:"OnTouchBegin",OnTouchEnd:"OnTouchEnd",OnTouchMove:"OnTouchMove",OnLevelLoaded:"OnLevelLoaded",OnStartGame:"OnStartGame",OnCollectablePicked:"OnCollectablePicked",OnPlayerProgress:"OnPlayerProgress",OnFinishLineReached:"OnFinishLineReached",OnSetCrownState:"OnSetCrownState",OnDebugProgression:"OnDebugProgression",OnPlayerDead:"OnPlayerDead",OnHitObstacle:"OnHitObstacle",OnLevelCompleted:"OnLevelCompleted",OnFightSequenceBegins:"OnFightSequenceBegins",OnFightSequenceCompleted:"OnFightSequenceCompleted",OnAttack:"OnAttack",OnDamage:"OnDamage",OnTap:"OnTap",OnTapBonus:"OnTapBonus",OnHealthChanged:"OnHealthChanged",OnChangeMenuState:"changeMenuState",OnChangeCameraState:"OnChangeCameraState",OnResetLevel:"OnResetLevel",OnUpgradeKick:"OnUpgradeKick",OnUpgradeMultiplier:"OnUpgradeMultiplier",OnRevivePlayer:"OnRevivePlayer",OnKillBoss:"OnKillBoss",OnUpdateLevelNumber:"OnUpdateLevelNumber",OnBossSpawned:"OnBossSpawned",OnFlightBegins:"OnFlightBegins",OnFlightCompleted:"OnFlightCompleted",OnRageModeActivated:"OnRageModeActivated",OnRageModeDeactivated:"OnRageModeDeactivated",OnColorChangedRageMode:"OnColorChangedRageMode",OnGetRandomBonusLevel:"OnGetRandomBonusLevel",OnBonusSequenceBegins:"OnBonusSequenceBegins",OnBonusSequenceCompleted:"OnBonusSequenceCompleted",OnFinishLineStarted:"OnFinishLineStarted",UpdateBossPosition:"UpdateBossPosition",ShakeCamera:"ShakeCamera",BigBoss:{FightBegins:"BigBoss:FightBegins"},OnKeysRefill:"OnKeysRefill",OnSkinSelected:"OnSkinSelected",OnSkinUnselected:"OnSkinUnselected",OnLoseLooksGoodOffer:"OnLoseLooksGoodOffer",OnKeepLooksGoodOffer:"OnKeepLooksGoodOffer",OnUpdateGemsView:"OnUpdateGemsView",OnRageRvCompleted:"OnRageRvCompleted"},window.CollectableType={MobGreen:0,MobOrange:1,Gem:2,Key:3,PainterGreen:4,PainterOrange:5,MobYellow:6,PainterYellow:7,PainterBlue:8,MobBlue:9,BreakableWall:10,Pole:11,Rail:12,RailSmall:13,RailDouble:14,FlapperLeft:15,FlapperRight:16,FlapperDouble:17,FlapperTwoSided:18,Totem:19,Gate:20,Arrow1:21,Arrow2:22,Arrow3:23,Arrow4:24,Arrow5:25,Arrow6:26,Arrow7:27,Arrow8:28,Arrow9:29,PainterGreenHalf:30,PainterOrangeHalf:31,PainterYellowHalf:32,PainterBlueHalf:33,Lava:34,Gem_Group_1:35,Gem_Group_2:36,Gem_Group_3:37,Gem_Group_4:38,Gem_Group_5:39,Totem_Double:40,ShoesShoes:41,SharkShoes:42,BigfootShoes:43,SocksShoes:44,BunnyShoes:45,WingsShoes:46,BootsShoes:47,KedsShoes:48,PointesShoes:49},window.ColorType={Green:0,Blue:1,Orange:2,Yellow:3,Red:4},window.Patch={RoadFlat:0,RoadSlide:1,RoadDoubleSlide:2,RoadLeftHalf:3,RoadLeftThird:4,RoadRightHalf:5,RoadRightThird:6,RoadStart_Arena:7,RoadEnd_Arena:8,RoadEnd_ArenaBig:9,RoadMiddle_Arena:10,RoadFinishSegment:11,RoadRotatingCircle:12,RoadPainterCircle:13,RoadPainterHalf:14},window.AttackTarget={Player:0,Boss:1,Chest:2},window.Attack={PunchLeft:0,PunchRight:1},window.Action={Enable:0,Disable:1},window.CameraState={Mainmenu:0,Gameplay:1,Fight:2,Flight:3,End:4,Wall:5,WallBreak:6,Dodge1:7,Dodge2:8,Dodge3:9,Dodge4:10,Dead:11},window.FightingMode={Winner:0,AlmostLoose:1,Looser:2},window.BigBossStates={idle:0,attack:1,punchLeft:2,punchRight:3},window.SkinType={Hats:0,Shoes:1,Kicks:2},window.SkinRarity={Common:0,Premium:1},window.SkinStatus={Unlocked:"Unlocked",Locked:"Locked",Selected:"Selected",Available:"Available"},window.SkinPurchaseType={Gems:0,Rewarded:1},window.FireworkType={topCenter:0,bottomCenter:1},window.PendulumReward={Skin:0,Key:1,GemsSmall:2,GemsLarge:3},this.app.events={configManager:{initialized:"ConfigManager:Initialized"},facebook:{tournamentButton:"Facebook:Tournament"}}},Constants.prototype.update=function(e){};function getRandomArbitrary(t,r){return Math.random()*(r-t)+t}function getRandomInt(t,r){return t=Math.ceil(t),r=Math.floor(r),Math.floor(Math.random()*(r-t+1))+t}function getRandomColor(){for(var t="#",r=0;r<6;r++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}function changeRange(t,r,n,e,a){return(t-r)*(a-e)/(n-r)+e}Math.dist=function(t,r,n,e){return n||(n=0),e||(e=0),Math.sqrt((n-t)*(n-t)+(e-r)*(e-r))},Math.noiseAbs=function(t){return t^=t<<13,Math.abs(parseFloat(1-(t*(t*t*15731+789221)+1376312589&2147483647)/1073741824))},Math.checkCircleRectangleOverlap=function(t,r,n,e,a,o,l){let u=Math.max(e,Math.min(r,o))-r,h=Math.max(a,Math.min(n,l))-n;return u*u+h*h<=t*t},Math.findRectangleOppositeCorners=function(t,r,n,e){return{x1:n-t,y1:e-r,x2:n+t,y2:e+r}},Math.randomPlusMinus=function(){return parseInt(pc.math.random(0,100))%2==0?1:-1},Math.clamp01=function(t){return pc.math.clamp(t,0,1)},Math.hex2rgb=function(t){return{r:("0x"+t[1]+t[2]|0)/255,g:("0x"+t[3]+t[4]|0)/255,b:("0x"+t[5]+t[6]|0)/255}},Math.evaluateColorObj=function(t,r){let n,e=t.length,a=r*e;for(let r=0;r<e;r++)if(a<=r+1){let o=a-r;Debug.log(o),r+1>=e?n=t[r].color:n.lerp(t[r].color,t[r+1].color,o);break}return Debug.log("evaluteColor: ",r,e,a,n),n},Math.evaluateColor=function(t,r){let n=t.length,e=r*n,a=new pc.Color;for(let r=0;r<n;r++){if(e<=r+1){let o=e-r;r+1>=n?a=t[r]:a.lerp(t[r],t[r+1],o);break}a=t[r]}return a};var Utils={setEntityAlpha:function(t,r){if(t.model&&t.model.enabled)for(var n=pc.math.clamp(r,0,1),e=t.model.meshInstances,a=0;a<e.length;++a)e[a].setParameter("material_opacity",n)},randomName:function(t){for(var r="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=n.length,a=0;a<t;a++)r+=n.charAt(Math.floor(Math.random()*e));return r},compareArrays:function(t,r){return((t,r)=>{if(t.length!==r.length)return!1;const n=new Set([...t,...r]);for(const e of n){if(t.filter((t=>t===e)).length!==r.filter((t=>t===e)).length)return!1}return!0})(t,r)},compareStateArray:function(t,r){if(t.length!==r.length)return!1;for(var n=0;n<t.length;++n)if(t[n].state!=r[n].state)return!1;return!0}};!function(u,o){var i,a;"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define("underscore",o):(u="undefined"!=typeof globalThis?globalThis:u||self,i=u._,(a=u._=o()).noConflict=function(){return u._=i,a})}(this,(function(){var u="1.13.2",o="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},i=Array.prototype,a=Object.prototype,l="undefined"!=typeof Symbol?Symbol.prototype:null,s=i.push,p=i.slice,v=a.toString,h=a.hasOwnProperty,y="undefined"!=typeof ArrayBuffer,d="undefined"!=typeof DataView,g=Array.isArray,b=Object.keys,m=Object.create,M=y&&ArrayBuffer.isView,S=isNaN,O=isFinite,B=!{toString:null}.propertyIsEnumerable("toString"),E=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],N=Math.pow(2,53)-1;function j(u,o){return o=null==o?u.length-1:+o,function(){for(var i=Math.max(arguments.length-o,0),a=Array(i),l=0;l<i;l++)a[l]=arguments[l+o];switch(o){case 0:return u.call(this,a);case 1:return u.call(this,arguments[0],a);case 2:return u.call(this,arguments[0],arguments[1],a)}var s=Array(o+1);for(l=0;l<o;l++)s[l]=arguments[l];return s[o]=a,u.apply(this,s)}}function _(u){var o=typeof u;return"function"===o||"object"===o&&!!u}function w(u){return void 0===u}function A(u){return!0===u||!1===u||"[object Boolean]"===v.call(u)}function x(u){var o="[object "+u+"]";return function(u){return v.call(u)===o}}var P=x("String"),k=x("Number"),T=x("Date"),D=x("RegExp"),I=x("Error"),R=x("Symbol"),V=x("ArrayBuffer"),F=x("Function"),q=o.document&&o.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof q&&(F=function(u){return"function"==typeof u||!1});var z=F,U=x("Object"),L=d&&U(new DataView(new ArrayBuffer(8))),H="undefined"!=typeof Map&&U(new Map),X=x("DataView"),Y=L?function(u){return null!=u&&z(u.getInt8)&&V(u.buffer)}:X,Q=g||x("Array");function W(u,o){return null!=u&&h.call(u,o)}var G=x("Arguments");!function(){G(arguments)||(G=function(u){return W(u,"callee")})}();var un=G;function $(u){return k(u)&&S(u)}function C(u){return function(){return u}}function K(u){return function(o){var i=u(o);return"number"==typeof i&&i>=0&&i<=N}}function J(u){return function(o){return null==o?void 0:o[u]}}var cn=J("byteLength"),ln=K(cn),sn=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/,pn=y?function(u){return M?M(u)&&!Y(u):ln(u)&&sn.test(v.call(u))}:C(!1),vn=J("length");function Z(u,o){o=function(u){for(var o={},i=u.length,a=0;a<i;++a)o[u[a]]=!0;return{contains:function(u){return!0===o[u]},push:function(i){return o[i]=!0,u.push(i)}}}(o);var i=E.length,l=u.constructor,s=z(l)&&l.prototype||a,p="constructor";for(W(u,p)&&!o.contains(p)&&o.push(p);i--;)(p=E[i])in u&&u[p]!==s[p]&&!o.contains(p)&&o.push(p)}function nn(u){if(!_(u))return[];if(b)return b(u);var o=[];for(var i in u)W(u,i)&&o.push(i);return B&&Z(u,o),o}function rn(u,o){var i=nn(o),a=i.length;if(null==u)return!a;for(var l=Object(u),s=0;s<a;s++){var p=i[s];if(o[p]!==l[p]||!(p in l))return!1}return!0}function tn(u){return u instanceof tn?u:this instanceof tn?void(this._wrapped=u):new tn(u)}function en(u){return new Uint8Array(u.buffer||u,u.byteOffset||0,cn(u))}tn.VERSION=u,tn.prototype.value=function(){return this._wrapped},tn.prototype.valueOf=tn.prototype.toJSON=tn.prototype.value,tn.prototype.toString=function(){return String(this._wrapped)};var hn="[object DataView]";function on(u,o,i,a){if(u===o)return 0!==u||1/u==1/o;if(null==u||null==o)return!1;if(u!=u)return o!=o;var s=typeof u;return("function"===s||"object"===s||"object"==typeof o)&&function n(u,o,i,a){u instanceof tn&&(u=u._wrapped),o instanceof tn&&(o=o._wrapped);var s=v.call(u);if(s!==v.call(o))return!1;if(L&&"[object Object]"==s&&Y(u)){if(!Y(o))return!1;s=hn}switch(s){case"[object RegExp]":case"[object String]":return""+u==""+o;case"[object Number]":return+u!=+u?+o!=+o:0==+u?1/+u==1/o:+u==+o;case"[object Date]":case"[object Boolean]":return+u==+o;case"[object Symbol]":return l.valueOf.call(u)===l.valueOf.call(o);case"[object ArrayBuffer]":case hn:return n(en(u),en(o),i,a)}var p="[object Array]"===s;if(!p&&pn(u)){if(cn(u)!==cn(o))return!1;if(u.buffer===o.buffer&&u.byteOffset===o.byteOffset)return!0;p=!0}if(!p){if("object"!=typeof u||"object"!=typeof o)return!1;var h=u.constructor,y=o.constructor;if(h!==y&&!(z(h)&&h instanceof h&&z(y)&&y instanceof y)&&"constructor"in u&&"constructor"in o)return!1}a=a||[];for(var d=(i=i||[]).length;d--;)if(i[d]===u)return a[d]===o;if(i.push(u),a.push(o),p){if((d=u.length)!==o.length)return!1;for(;d--;)if(!on(u[d],o[d],i,a))return!1}else{var g,b=nn(u);if(d=b.length,nn(o).length!==d)return!1;for(;d--;)if(!W(o,g=b[d])||!on(u[g],o[g],i,a))return!1}return i.pop(),a.pop(),!0}(u,o,i,a)}function an(u){if(!_(u))return[];var o=[];for(var i in u)o.push(i);return B&&Z(u,o),o}function fn(u){var o=vn(u);return function(i){if(null==i)return!1;var a=an(i);if(vn(a))return!1;for(var l=0;l<o;l++)if(!z(i[u[l]]))return!1;return u!==mn||!z(i[yn])}}var yn="forEach",dn=["clear","delete"],gn=["get","has","set"],bn=dn.concat(yn,gn),mn=dn.concat(gn),xn=["add"].concat(dn,yn,"has"),Sn=H?fn(bn):x("Map"),On=H?fn(mn):x("WeakMap"),Wn=H?fn(xn):x("Set"),$n=x("WeakSet");function jn(u){for(var o=nn(u),i=o.length,a=Array(i),l=0;l<i;l++)a[l]=u[o[l]];return a}function _n(u){for(var o={},i=nn(u),a=0,l=i.length;a<l;a++)o[u[i[a]]]=i[a];return o}function wn(u){var o=[];for(var i in u)z(u[i])&&o.push(i);return o.sort()}function An(u,o){return function(i){var a=arguments.length;if(o&&(i=Object(i)),a<2||null==i)return i;for(var l=1;l<a;l++)for(var s=arguments[l],p=u(s),v=p.length,h=0;h<v;h++){var y=p[h];o&&void 0!==i[y]||(i[y]=s[y])}return i}}var Jn=An(an),Ln=An(nn),Cn=An(an,!0);function Mn(u){if(!_(u))return{};if(m)return m(u);var r=function(){};r.prototype=u;var o=new r;return r.prototype=null,o}function En(u){return Q(u)?u:[u]}function Bn(u){return tn.toPath(u)}function Nn(u,o){for(var i=o.length,a=0;a<i;a++){if(null==u)return;u=u[o[a]]}return i?u:void 0}function In(u,o,i){var a=Nn(u,Bn(o));return w(a)?i:a}function Tn(u){return u}function kn(u){return u=Ln({},u),function(o){return rn(o,u)}}function Dn(u){return u=Bn(u),function(o){return Nn(o,u)}}function Rn(u,o,i){if(void 0===o)return u;switch(null==i?3:i){case 1:return function(i){return u.call(o,i)};case 3:return function(i,a,l){return u.call(o,i,a,l)};case 4:return function(i,a,l,s){return u.call(o,i,a,l,s)}}return function(){return u.apply(o,arguments)}}function Fn(u,o,i){return null==u?Tn:z(u)?Rn(u,o,i):_(u)&&!Q(u)?kn(u):Dn(u)}function Vn(u,o){return Fn(u,o,1/0)}function Pn(u,o,i){return tn.iteratee!==Vn?tn.iteratee(u,o):Fn(u,o,i)}function qn(){}function Un(u,o){return null==o&&(o=u,u=0),u+Math.floor(Math.random()*(o-u+1))}tn.toPath=En,tn.iteratee=Vn;var Kn=Date.now||function(){return(new Date).getTime()};function zn(u){var r=function(o){return u[o]},o="(?:"+nn(u).join("|")+")",i=RegExp(o),a=RegExp(o,"g");return function(u){return u=null==u?"":""+u,i.test(u)?u.replace(a,r):u}}var Hn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Xn=zn(Hn),Yn=zn(_n(Hn)),Gn=tn.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},nr=/(.)^/,rr={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},tr=/\\|'|\r|\n|\u2028|\u2029/g;function Qn(u){return"\\"+rr[u]}var ur=/^\s*(\w|\$)+\s*$/,or=0;function Zn(u,o,i,a,l){if(!(a instanceof o))return u.apply(i,l);var s=Mn(u.prototype),p=u.apply(s,l);return _(p)?p:s}var ir=j((function(u,o){var i=ir.placeholder,e=function(){for(var a=0,l=o.length,s=Array(l),p=0;p<l;p++)s[p]=o[p]===i?arguments[a++]:o[p];for(;a<arguments.length;)s.push(arguments[a++]);return Zn(u,e,this,this,s)};return e}));ir.placeholder=tn;var cr=j((function(u,o,i){if(!z(u))throw new TypeError("Bind must be called on a function");var a=j((function(l){return Zn(u,a,o,this,i.concat(l))}));return a})),pr=K(vn);function er(u,o,i,a){if(a=a||[],o||0===o){if(o<=0)return a.concat(u)}else o=1/0;for(var l=a.length,s=0,p=vn(u);s<p;s++){var v=u[s];if(pr(v)&&(Q(v)||un(v)))if(o>1)er(v,o-1,i,a),l=a.length;else for(var h=0,y=v.length;h<y;)a[l++]=v[h++];else i||(a[l++]=v)}return a}var vr=j((function(u,o){var i=(o=er(o,!1,!1)).length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var a=o[i];u[a]=cr(u[a],u)}return u})),dr=j((function(u,o,i){return setTimeout((function(){return u.apply(null,i)}),o)})),gr=ir(dr,tn,1);function ar(u){return function(){return!u.apply(this,arguments)}}function fr(u,o){var i;return function(){return--u>0&&(i=o.apply(this,arguments)),u<=1&&(o=null),i}}var wr=ir(fr,2);function lr(u,o,i){o=Pn(o,i);for(var a,l=nn(u),s=0,p=l.length;s<p;s++)if(o(u[a=l[s]],a,u))return a}function sr(u){return function(o,i,a){i=Pn(i,a);for(var l=vn(o),s=u>0?0:l-1;s>=0&&s<l;s+=u)if(i(o[s],s,o))return s;return-1}}var Ar=sr(1),Er=sr(-1);function hr(u,o,i,a){for(var l=(i=Pn(i,a,1))(o),s=0,p=vn(u);s<p;){var v=Math.floor((s+p)/2);i(u[v])<l?s=v+1:p=v}return s}function yr(u,o,i){return function(a,l,s){var v=0,h=vn(a);if("number"==typeof s)u>0?v=s>=0?s:Math.max(s+h,v):h=s>=0?Math.min(s+1,h):s+h+1;else if(i&&s&&h)return a[s=i(a,l)]===l?s:-1;if(l!=l)return(s=o(p.call(a,v,h),$))>=0?s+v:-1;for(s=u>0?v:h-1;s>=0&&s<h;s+=u)if(a[s]===l)return s;return-1}}var Pr=yr(1,Ar,hr),Ir=yr(-1,Er);function br(u,o,i){var a=(pr(u)?Ar:lr)(u,o,i);if(void 0!==a&&-1!==a)return u[a]}function mr(u,o,i){var a,l;if(o=Rn(o,i),pr(u))for(a=0,l=u.length;a<l;a++)o(u[a],a,u);else{var s=nn(u);for(a=0,l=s.length;a<l;a++)o(u[s[a]],s[a],u)}return u}function jr(u,o,i){o=Pn(o,i);for(var a=!pr(u)&&nn(u),l=(a||u).length,s=Array(l),p=0;p<l;p++){var v=a?a[p]:p;s[p]=o(u[v],v,u)}return s}function _r(u){var r=function(o,i,a,l){var s=!pr(o)&&nn(o),p=(s||o).length,v=u>0?0:p-1;for(l||(a=o[s?s[v]:v],v+=u);v>=0&&v<p;v+=u){var h=s?s[v]:v;a=i(a,o[h],h,o)}return a};return function(u,o,i,a){var l=arguments.length>=3;return r(u,Rn(o,a,4),i,l)}}var Rr=_r(1),Wr=_r(-1);function xr(u,o,i){var a=[];return o=Pn(o,i),mr(u,(function(u,i,l){o(u,i,l)&&a.push(u)})),a}function Sr(u,o,i){o=Pn(o,i);for(var a=!pr(u)&&nn(u),l=(a||u).length,s=0;s<l;s++){var p=a?a[s]:s;if(!o(u[p],p,u))return!1}return!0}function Or(u,o,i){o=Pn(o,i);for(var a=!pr(u)&&nn(u),l=(a||u).length,s=0;s<l;s++){var p=a?a[s]:s;if(o(u[p],p,u))return!0}return!1}function Mr(u,o,i,a){return pr(u)||(u=jn(u)),("number"!=typeof i||a)&&(i=0),Pr(u,o,i)>=0}var Vr=j((function(u,o,i){var a,l;return z(o)?l=o:(o=Bn(o),a=o.slice(0,-1),o=o[o.length-1]),jr(u,(function(u){var s=l;if(!s){if(a&&a.length&&(u=Nn(u,a)),null==u)return;s=u[o]}return null==s?s:s.apply(u,i)}))}));function Br(u,o){return jr(u,Dn(o))}function Nr(u,o,i){var a,l,s=-1/0,p=-1/0;if(null==o||"number"==typeof o&&"object"!=typeof u[0]&&null!=u)for(var v=0,h=(u=pr(u)?u:jn(u)).length;v<h;v++)null!=(a=u[v])&&a>s&&(s=a);else o=Pn(o,i),mr(u,(function(u,i,a){((l=o(u,i,a))>p||l===-1/0&&s===-1/0)&&(s=u,p=l)}));return s}var Fr=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Tr(u){return u?Q(u)?p.call(u):P(u)?u.match(Fr):pr(u)?jr(u,Tn):jn(u):[]}function kr(u,o,i){if(null==o||i)return pr(u)||(u=jn(u)),u[Un(u.length-1)];var a=Tr(u),l=vn(a);o=Math.max(Math.min(o,l),0);for(var s=l-1,p=0;p<o;p++){var v=Un(p,s),h=a[p];a[p]=a[v],a[v]=h}return a.slice(0,o)}function Dr(u,o){return function(i,a,l){var s=o?[[],[]]:{};return a=Pn(a,l),mr(i,(function(o,l){var p=a(o,l,i);u(s,o,p)})),s}}var Ur=Dr((function(u,o,i){W(u,i)?u[i].push(o):u[i]=[o]})),Zr=Dr((function(u,o,i){u[i]=o})),Cr=Dr((function(u,o,i){W(u,i)?u[i]++:u[i]=1})),Kr=Dr((function(u,o,i){u[i?0:1].push(o)}),!0);function qr(u,o,i){return o in i}var Qr=j((function(u,o){var i={},a=o[0];if(null==u)return i;z(a)?(o.length>1&&(a=Rn(a,o[1])),o=an(u)):(a=qr,o=er(o,!1,!1),u=Object(u));for(var l=0,s=o.length;l<s;l++){var p=o[l],v=u[p];a(v,p,u)&&(i[p]=v)}return i})),Gr=j((function(u,o){var i,a=o[0];return z(a)?(a=ar(a),o.length>1&&(i=o[1])):(o=jr(er(o,!1,!1),String),a=function(u,i){return!Mr(o,i)}),Qr(u,a,i)}));function zr(u,o,i){return p.call(u,0,Math.max(0,u.length-(null==o||i?1:o)))}function Lr(u,o,i){return null==u||u.length<1?null==o||i?void 0:[]:null==o||i?u[0]:zr(u,u.length-o)}function $r(u,o,i){return p.call(u,null==o||i?1:o)}var nt=j((function(u,o){return o=er(o,!0,!0),xr(u,(function(u){return!Mr(o,u)}))})),rt=j((function(u,o){return nt(u,o)}));function Jr(u,o,i,a){A(o)||(a=i,i=o,o=!1),null!=i&&(i=Pn(i,a));for(var l=[],s=[],p=0,v=vn(u);p<v;p++){var h=u[p],y=i?i(h,p,u):h;o&&!i?(p&&s===y||l.push(h),s=y):i?Mr(s,y)||(s.push(y),l.push(h)):Mr(l,h)||l.push(h)}return l}var tt=j((function(u){return Jr(er(u,!0,!0))}));function Hr(u){for(var o=u&&Nr(u,vn).length||0,i=Array(o),a=0;a<o;a++)i[a]=Br(u,a);return i}var et=j(Hr);function Xr(u,o){return u._chain?tn(o).chain():o}function Yr(u){return mr(wn(u),(function(o){var i=tn[o]=u[o];tn.prototype[o]=function(){var u=[this._wrapped];return s.apply(u,arguments),Xr(this,i.apply(tn,u))}})),tn}mr(["pop","push","reverse","shift","sort","splice","unshift"],(function(u){var o=i[u];tn.prototype[u]=function(){var i=this._wrapped;return null!=i&&(o.apply(i,arguments),"shift"!==u&&"splice"!==u||0!==i.length||delete i[0]),Xr(this,i)}})),mr(["concat","join","slice"],(function(u){var o=i[u];tn.prototype[u]=function(){var u=this._wrapped;return null!=u&&(u=o.apply(u,arguments)),Xr(this,u)}}));var ut=Yr({__proto__:null,VERSION:u,restArguments:j,isObject:_,isNull:function(u){return null===u},isUndefined:w,isBoolean:A,isElement:function(u){return!(!u||1!==u.nodeType)},isString:P,isNumber:k,isDate:T,isRegExp:D,isError:I,isSymbol:R,isArrayBuffer:V,isDataView:Y,isArray:Q,isFunction:z,isArguments:un,isFinite:function(u){return!R(u)&&O(u)&&!isNaN(parseFloat(u))},isNaN:$,isTypedArray:pn,isEmpty:function(u){if(null==u)return!0;var o=vn(u);return"number"==typeof o&&(Q(u)||P(u)||un(u))?0===o:0===vn(nn(u))},isMatch:rn,isEqual:function(u,o){return on(u,o)},isMap:Sn,isWeakMap:On,isSet:Wn,isWeakSet:$n,keys:nn,allKeys:an,values:jn,pairs:function(u){for(var o=nn(u),i=o.length,a=Array(i),l=0;l<i;l++)a[l]=[o[l],u[o[l]]];return a},invert:_n,functions:wn,methods:wn,extend:Jn,extendOwn:Ln,assign:Ln,defaults:Cn,create:function(u,o){var i=Mn(u);return o&&Ln(i,o),i},clone:function(u){return _(u)?Q(u)?u.slice():Jn({},u):u},tap:function(u,o){return o(u),u},get:In,has:function(u,o){for(var i=(o=Bn(o)).length,a=0;a<i;a++){var l=o[a];if(!W(u,l))return!1;u=u[l]}return!!i},mapObject:function(u,o,i){o=Pn(o,i);for(var a=nn(u),l=a.length,s={},p=0;p<l;p++){var v=a[p];s[v]=o(u[v],v,u)}return s},identity:Tn,constant:C,noop:qn,toPath:En,property:Dn,propertyOf:function(u){return null==u?qn:function(o){return In(u,o)}},matcher:kn,matches:kn,times:function(u,o,i){var a=Array(Math.max(0,u));o=Rn(o,i,1);for(var l=0;l<u;l++)a[l]=o(l);return a},random:Un,now:Kn,escape:Xn,unescape:Yn,templateSettings:Gn,template:function(u,o,i){!o&&i&&(o=i),o=Cn({},o,tn.templateSettings);var a=RegExp([(o.escape||nr).source,(o.interpolate||nr).source,(o.evaluate||nr).source].join("|")+"|$","g"),l=0,s="__p+='";u.replace(a,(function(o,i,a,p,v){return s+=u.slice(l,v).replace(tr,Qn),l=v+o.length,i?s+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":a?s+="'+\n((__t=("+a+"))==null?'':__t)+\n'":p&&(s+="';\n"+p+"\n__p+='"),o})),s+="';\n";var p,v=o.variable;if(v){if(!ur.test(v))throw new Error("variable is not a bare identifier: "+v)}else s="with(obj||{}){\n"+s+"}\n",v="obj";s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{p=new Function(v,"_",s)}catch(u){throw u.source=s,u}var f=function(u){return p.call(this,u,tn)};return f.source="function("+v+"){\n"+s+"}",f},result:function(u,o,i){var a=(o=Bn(o)).length;if(!a)return z(i)?i.call(u):i;for(var l=0;l<a;l++){var s=null==u?void 0:u[o[l]];void 0===s&&(s=i,l=a),u=z(s)?s.call(u):s}return u},uniqueId:function(u){var o=++or+"";return u?u+o:o},chain:function(u){var o=tn(u);return o._chain=!0,o},iteratee:Vn,partial:ir,bind:cr,bindAll:vr,memoize:function(u,o){var t=function(i){var a=t.cache,l=""+(o?o.apply(this,arguments):i);return W(a,l)||(a[l]=u.apply(this,arguments)),a[l]};return t.cache={},t},delay:dr,defer:gr,throttle:function(u,o,i){var a,l,s,p,v=0;i||(i={});var f=function(){v=!1===i.leading?0:Kn(),a=null,p=u.apply(l,s),a||(l=s=null)},c=function(){var h=Kn();v||!1!==i.leading||(v=h);var y=o-(h-v);return l=this,s=arguments,y<=0||y>o?(a&&(clearTimeout(a),a=null),v=h,p=u.apply(l,s),a||(l=s=null)):a||!1===i.trailing||(a=setTimeout(f,y)),p};return c.cancel=function(){clearTimeout(a),v=0,a=l=s=null},c},debounce:function(u,o,i){var a,l,s,p,v,f=function(){var h=Kn()-l;o>h?a=setTimeout(f,o-h):(a=null,i||(p=u.apply(v,s)),a||(s=v=null))},h=j((function(h){return v=this,s=h,l=Kn(),a||(a=setTimeout(f,o),i&&(p=u.apply(v,s))),p}));return h.cancel=function(){clearTimeout(a),a=s=v=null},h},wrap:function(u,o){return ir(o,u)},negate:ar,compose:function(){var u=arguments,o=u.length-1;return function(){for(var i=o,a=u[o].apply(this,arguments);i--;)a=u[i].call(this,a);return a}},after:function(u,o){return function(){if(--u<1)return o.apply(this,arguments)}},before:fr,once:wr,findKey:lr,findIndex:Ar,findLastIndex:Er,sortedIndex:hr,indexOf:Pr,lastIndexOf:Ir,find:br,detect:br,findWhere:function(u,o){return br(u,kn(o))},each:mr,forEach:mr,map:jr,collect:jr,reduce:Rr,foldl:Rr,inject:Rr,reduceRight:Wr,foldr:Wr,filter:xr,select:xr,reject:function(u,o,i){return xr(u,ar(Pn(o)),i)},every:Sr,all:Sr,some:Or,any:Or,contains:Mr,includes:Mr,include:Mr,invoke:Vr,pluck:Br,where:function(u,o){return xr(u,kn(o))},max:Nr,min:function(u,o,i){var a,l,s=1/0,p=1/0;if(null==o||"number"==typeof o&&"object"!=typeof u[0]&&null!=u)for(var v=0,h=(u=pr(u)?u:jn(u)).length;v<h;v++)null!=(a=u[v])&&a<s&&(s=a);else o=Pn(o,i),mr(u,(function(u,i,a){((l=o(u,i,a))<p||l===1/0&&s===1/0)&&(s=u,p=l)}));return s},shuffle:function(u){return kr(u,1/0)},sample:kr,sortBy:function(u,o,i){var a=0;return o=Pn(o,i),Br(jr(u,(function(u,i,l){return{value:u,index:a++,criteria:o(u,i,l)}})).sort((function(u,o){var i=u.criteria,a=o.criteria;if(i!==a){if(i>a||void 0===i)return 1;if(i<a||void 0===a)return-1}return u.index-o.index})),"value")},groupBy:Ur,indexBy:Zr,countBy:Cr,partition:Kr,toArray:Tr,size:function(u){return null==u?0:pr(u)?u.length:nn(u).length},pick:Qr,omit:Gr,first:Lr,head:Lr,take:Lr,initial:zr,last:function(u,o,i){return null==u||u.length<1?null==o||i?void 0:[]:null==o||i?u[u.length-1]:$r(u,Math.max(0,u.length-o))},rest:$r,tail:$r,drop:$r,compact:function(u){return xr(u,Boolean)},flatten:function(u,o){return er(u,o,!1)},without:rt,uniq:Jr,unique:Jr,union:tt,intersection:function(u){for(var o=[],i=arguments.length,a=0,l=vn(u);a<l;a++){var s=u[a];if(!Mr(o,s)){var p;for(p=1;p<i&&Mr(arguments[p],s);p++);p===i&&o.push(s)}}return o},difference:nt,unzip:Hr,transpose:Hr,zip:et,object:function(u,o){for(var i={},a=0,l=vn(u);a<l;a++)o?i[u[a]]=o[a]:i[u[a][0]]=u[a][1];return i},range:function(u,o,i){null==o&&(o=u||0,u=0),i||(i=o<u?-1:1);for(var a=Math.max(Math.ceil((o-u)/i),0),l=Array(a),s=0;s<a;s++,u+=i)l[s]=u;return l},chunk:function(u,o){if(null==o||o<1)return[];for(var i=[],a=0,l=u.length;a<l;)i.push(p.call(u,a,a+=o));return i},mixin:Yr,default:tn});return ut._=ut,ut}));const TweenWrapper_App=pc.Application.getApplication(),TweenWrapper={Tween:function(e,t,n,o,p,r,i,c){return e.tween(t).to(n,o,r||pc.Linear).start().loop(!0===i).yoyo(!0===c).on("complete",(function(){p&&p()}))},TweenOpacity:function(e,t,n,o,p){e.opacity=t;let r={opacity:t};return TweenWrapper_App.tween(r).to({opacity:n},o,pc.Linear).on("update",(function(){e.opacity=r.opacity})).on("complete",(function(){e.opacity=n,p&&p()})).start()},TweenColor:function(e,t,n,o,p){if(e.color!==n){var r=t.clone();return TweenWrapper_App.tween(r).to(n,1,pc.Linear).on("update",function(){e.color=r,e.color===r&&p&&p()}.bind(this)).start()}},TweenNumberO:function(e,t,n,o,p){if(e===t)return[!1,e];var r=pc.math.lerp(e,t,n),i=e<t?e>=t:e<=t;return e=e<t?Math.ceil(r):Math.floor(r),i?(e=t,void 0!==o&&(o.text=p+e),[!1,e]):(void 0!==o&&(o.text=p+e),[!0,e])},TweenNumber:function(e,t,n,o,p,r,i,c){if(e!==t){let a={number:e};return TweenWrapper_App.tween(a).to({number:t},n,r||pc.Linear).loop(!0===i).yoyo(!0===c).on("update",o.bind(this,a)).on("complete",(function(){p&&p()})).start()}},StopTween:function(e){e&&e.stop()}};var LocalStorageManager=pc.createScript("localStorageManager"),isLSAvailable=!0;function lsTest(){var a="test";try{return localStorage.setItem(a,a),localStorage.removeItem(a),!0}catch(a){return!1}}LocalStorageManager.prototype.initialize=function(){},LocalStorageManager.prototype.checkForLocalStoage=function(){isLSAvailable=!0===lsTest()},LocalStorageManager.prototype.update=function(a){};!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).TWEEN={})}(this,(function(t){"use strict";var e,n={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-n.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*n.Bounce.In(2*t):.5*n.Bounce.Out(2*t-1)+.5}}},i="undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},r=function(){function Group(){this._tweens={},this._tweensAddedDuringUpdate={}}return Group.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map((function(e){return t._tweens[e]}))},Group.prototype.removeAll=function(){this._tweens={}},Group.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},Group.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},Group.prototype.update=function(t,e){void 0===t&&(t=i()),void 0===e&&(e=!1);var n=Object.keys(this._tweens);if(0===n.length)return!1;for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<n.length;r++){var s=this._tweens[n[r]],o=!e;s&&!1===s.update(t,o)&&!e&&delete this._tweens[n[r]]}n=Object.keys(this._tweensAddedDuringUpdate)}return!0},Group}(),s={Linear:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),o=s.Utils.Linear;return e<0?o(t[0],t[1],i):e>1?o(t[n],t[n-1],n-i):o(t[r],t[r+1>n?n:r+1],i-r)},Bezier:function(t,e){for(var n=0,i=t.length-1,r=Math.pow,o=s.Utils.Bernstein,a=0;a<=i;a++)n+=r(1-e,i-a)*r(e,a)*t[a]*o(i,a);return n},CatmullRom:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),o=s.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(r=Math.floor(i=n*(1+e))),o(t[(r-1+n)%n],t[r],t[(r+1)%n],t[(r+2)%n],i-r)):e<0?t[0]-(o(t[0],t[0],t[1],t[1],-i)-t[0]):e>1?t[n]-(o(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):o(t[r?r-1:0],t[r],t[n<r+1?n:r+1],t[n<r+2?n:r+2],i-r)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=s.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:(e=[1],function(t){var n=1;if(e[t])return e[t];for(var i=t;i>1;i--)n*=i;return e[t]=n,n}),CatmullRom:function(t,e,n,i,r){var s=.5*(n-t),o=.5*(i-e),a=r*r;return(2*e-2*n+s+o)*(r*a)+(-3*e+3*n-2*s-o)*a+s*r+e}}},o=function(){function Sequence(){}return Sequence.nextId=function(){return Sequence._nextId++},Sequence._nextId=0,Sequence}(),a=new r,u=function(){function Tween(t,e){void 0===e&&(e=a),this._object=t,this._group=e,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=n.Linear.None,this._interpolationFunction=s.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=o.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return Tween.prototype.getId=function(){return this._id},Tween.prototype.isPlaying=function(){return this._isPlaying},Tween.prototype.isPaused=function(){return this._isPaused},Tween.prototype.to=function(t,e){return this._valuesEnd=Object.create(t),void 0!==e&&(this._duration=e),this},Tween.prototype.duration=function(t){return this._duration=t,this},Tween.prototype.start=function(t){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var e in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(e),this._valuesStart[e]=this._valuesStartRepeat[e];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==t?"string"==typeof t?i()+parseFloat(t):t:i(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},Tween.prototype._setupProperties=function(t,e,n,i){for(var r in n){var s=t[r],o=Array.isArray(s),a=o?"array":typeof s,u=!o&&Array.isArray(n[r]);if("undefined"!==a&&"function"!==a){if(u){var h=n[r];if(0===h.length)continue;h=h.map(this._handleRelativeValue.bind(this,s)),n[r]=[s].concat(h)}if("object"!==a&&!o||!s||u)void 0===e[r]&&(e[r]=s),o||(e[r]*=1),i[r]=u?n[r].slice().reverse():e[r]||0;else{for(var p in e[r]=o?[]:{},s)e[r][p]=s[p];i[r]=o?[]:{},this._setupProperties(s,e[r],n[r],i[r])}}}},Tween.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},Tween.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},Tween.prototype.pause=function(t){return void 0===t&&(t=i()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this)),this},Tween.prototype.resume=function(t){return void 0===t&&(t=i()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},Tween.prototype.stopChainedTweens=function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this},Tween.prototype.group=function(t){return this._group=t,this},Tween.prototype.delay=function(t){return this._delayTime=t,this},Tween.prototype.repeat=function(t){return this._initialRepeat=t,this._repeat=t,this},Tween.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},Tween.prototype.yoyo=function(t){return this._yoyo=t,this},Tween.prototype.easing=function(t){return this._easingFunction=t,this},Tween.prototype.interpolation=function(t){return this._interpolationFunction=t,this},Tween.prototype.chain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._chainedTweens=t,this},Tween.prototype.onStart=function(t){return this._onStartCallback=t,this},Tween.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},Tween.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},Tween.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},Tween.prototype.onStop=function(t){return this._onStopCallback=t,this},Tween.prototype.update=function(t,e){if(void 0===t&&(t=i()),void 0===e&&(e=!0),this._isPaused)return!0;var n,r,s=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(t>s)return!1;e&&this.start(t)}if(this._goToEnd=!1,t<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),r=(t-this._startTime)/this._duration,r=0===this._duration||r>1?1:r;var o=this._easingFunction(r);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&this._onUpdateCallback(this._object,r),1===r){if(this._repeat>0){for(n in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[n]||(this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(this._valuesEnd[n])),this._yoyo&&this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,u=this._chainedTweens.length;a<u;a++)this._chainedTweens[a].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},Tween.prototype._updateProperties=function(t,e,n,i){for(var r in n)if(void 0!==e[r]){var s=e[r]||0,o=n[r],a=Array.isArray(t[r]),u=Array.isArray(o);!a&&u?t[r]=this._interpolationFunction(o,i):"object"==typeof o&&o?this._updateProperties(t[r],s,o,i):"number"==typeof(o=this._handleRelativeValue(s,o))&&(t[r]=s+(o-s)*i)}},Tween.prototype._handleRelativeValue=function(t,e){return"string"!=typeof e?e:"+"===e.charAt(0)||"-"===e.charAt(0)?t+parseFloat(e):parseFloat(e)},Tween.prototype._swapEndStartRepeatValues=function(t){var e=this._valuesStartRepeat[t],n=this._valuesEnd[t];this._valuesStartRepeat[t]="string"==typeof n?this._valuesStartRepeat[t]+parseFloat(n):this._valuesEnd[t],this._valuesEnd[t]=e},Tween}(),h="18.6.4",p=o.nextId,_=a,l=_.getAll.bind(_),c=_.removeAll.bind(_),d=_.add.bind(_),f=_.remove.bind(_),y=_.update.bind(_),v={Easing:n,Group:r,Interpolation:s,now:i,Sequence:o,nextId:p,Tween:u,VERSION:h,getAll:l,removeAll:c,add:d,remove:f,update:y};t.Easing=n,t.Group=r,t.Interpolation=s,t.Sequence=o,t.Tween=u,t.VERSION=h,t.add=d,t.default=v,t.getAll=l,t.nextId=p,t.now=i,t.remove=f,t.removeAll=c,t.update=y,Object.defineProperty(t,"__esModule",{value:!0})}));var LevelsData=pc.createScript("levelsData");LevelsData.attributes.add("difficultyData",{title:"Difficulty Data",type:"json",schema:[{name:"minLevel",title:"Min Level",type:"number"},{name:"bossLevelDelta",title:"Boss Level Delta",type:"number"},{name:"heroSpeed",title:"Hero Speed",type:"number"}],array:!0}),LevelsData.attributes.add("Levels",{type:"json",schema:[{name:"Preset",type:"entity"}],array:!0}),LevelsData.attributes.add("BonusLevels",{type:"json",schema:[{name:"Preset",type:"entity"}],array:!0}),LevelsData.prototype.initialize=function(){this.app.on(Events.OnGetLevel,this.OnGetLevel,this),this.app.on(Events.OnGetRandomBonusLevel,this.OnGetRandomBonusLevel,this)},LevelsData.prototype.OnGetLevel=function(e){e%=this.Levels.length,this.app.fire(Events.OnLoadLevel,this.Levels[e])},LevelsData.prototype.OnGetRandomBonusLevel=function(){let e=Math.floor(getRandomArbitrary(0,this.BonusLevels.length));this.app.fire(Events.OnLoadLevel,this.BonusLevels[e])},LevelsData.prototype.update=function(e){};var PatchContainer=pc.createScript("patchContainer");PatchContainer.attributes.add("Patches",{type:"json",schema:[{name:"Patch",type:"entity"},{name:"ID",type:"number",enum:[{RoadFlat:0},{RoadSlide:1},{RoadDoubleSlide:2},{RoadLeftHalf:3},{RoadLeftThird:4},{RoadRightHalf:5},{RoadRightThird:6},{RoadStart_Arena:7},{RoadEnd_Arena:8},{RoadEnd_ArenaBig:9},{RoadMiddle_Arena:10},{RoadFinishSegment:11},{RoadRotatingCircle:12},{RoadPainterCircle:13},{RoadPainterHalf:14},{RoadFlatWall:15},{RoadFlatObstacle:16},{RoadFlatQuarter:17}]}],array:!0}),PatchContainer.prototype.initialize=function(){PatchContainer=this},PatchContainer.prototype.GetPatch=function(a){return _.findWhere(this.Patches,{ID:a})},PatchContainer.prototype.update=function(a){};var LevelGenerator=pc.createScript("levelGenerator");LevelGenerator.attributes.add("levelsLimit",{type:"number",title:"Levels Limit",default:9}),LevelGenerator.attributes.add("PathParent",{type:"entity"}),LevelGenerator.prototype.initialize=function(){this.generatedPatches=[],this.app.on(Events.OnLoadLevel,this.OnLoadLevel,this),this.app.on(Events.OnUnloadLevel,this.OnUnloadLevel,this),this.app.on(Events.OnDebugProgression,this.OnDebugProgression,this),this.app.on(Events.OnLevelCompleted,this.OnLevelCompleted,this),this.app.on(Events.OnResetLevel,this.OnResetLevel,this),this.app.on(Events.OnColorChangedRageMode,this.OnColorChangedRageMode,this),this.index=parseInt(this.GetCurrentLevel()),this.currentTotalLevel=parseInt(this.GetCurrentTotalLevel()),this.mobs=[];setTimeout((()=>{this.currentTotalLevel%6==0?this.app.fire(Events.OnGetRandomBonusLevel):this.app.fire(Events.OnGetLevel,this.index)}),500)},LevelGenerator.prototype.postInitialize=function(){},LevelGenerator.prototype.OnColorChangedRageMode=function(e){for(let t=0;t<this.mobs.length;t++){this.mobs[t].script.materialChanger.OnColorChangedRageMode(e)}},LevelGenerator.prototype.OnResetLevel=function(){this.app.fire(Events.OnStartGame,!1),this.app.fire(Events.OnGetLevel,this.index),this.app.fire("changeMenuState",MenuManager.States.Home)},LevelGenerator.prototype.GetCurrentLevel=function(){var e=localStorage.getItem("currentLevel");return(null===e||e<0)&&(e=0,localStorage.setItem("currentLevel",e)),e},LevelGenerator.prototype.checkForLevelType=function(){},LevelGenerator.prototype.GetCurrentTotalLevel=function(){var e=localStorage.getItem("currentTotalLevel");return(null===e||e<1)&&(e=1,localStorage.setItem("currentTotalLevel",e)),e},LevelGenerator.prototype.loadPreviousLevel=function(){this.index-=2,this.currentTotalLevel-=2,this.index<=0&&(this.index=this.levelsLimit-1),this.OnLevelCompleted()},LevelGenerator.prototype.OnLevelCompleted=function(){this.index++,this.currentTotalLevel++,this.index>this.levelsLimit&&(this.index=0);var e=this.index,t=this.currentTotalLevel;this.currentTotalLevel%6==0?this.app.fire(Events.OnGetRandomBonusLevel):this.app.fire(Events.OnGetLevel,e),this.app.fire(Events.OnUpdateLevelNumber,t),this.app.fire(Events.OnStartGame,!1),this.app.fire("changeMenuState",MenuManager.States.Home),localStorage.setItem("currentLevel",e),localStorage.setItem("currentTotalLevel",t)},LevelGenerator.prototype.OnDebugProgression=function(){this.app.fire(Events.OnLevelCompleted)},LevelGenerator.prototype.OnLoadLevel=function(e){this.mobs=[];var t=pc.Vec3.ZERO,l=e.Preset.script.levelData.Segments.ColorType,o=e.Preset.script.levelData.Segments.Patches,n=e.Preset.script.levelData.CollectableData,r=e.Preset.script.bossModifier;let a=this.calculateMaxHeroLevel(n,e.Preset.script.levelData.Segments.ColorType);var i=e.Preset.script.chestModifier;let s=0;for(let e=0;e<this.generatedPatches.length;e++){this.generatedPatches[e].destroy()}this.generatedPatches=[];for(let e=0;e<o.length;e++){let l=PatchContainer.GetPatch(o[e]).Patch.clone();this.PathParent.addChild(l),l.setPosition(t);var p=l.script.patchObject.PatchNextPos;p&&(t=p.getPosition().clone()),this.generatedPatches.push(l)}let c=Settings.biggBossFighting.levelsBetweenBigBoss,h=this.currentTotalLevel%c==0,v=Settings.finishTrack.generalSettings.biggBossForwardOffset,u=Settings.finishTrack.generalSettings.miniBossForwardOffset,C=h?v:u,d=this.generatedPatches[this.generatedPatches.length-1].getPosition().z+C;CustomCoroutine.Instance.set((()=>{for(let l=0;l<this.generatedPatches.length;l++){if(i&&l===i.info.patchIndex){var e=ChestContainer.template.clone();e.enabled=!0,this.generatedPatches[l].script.patchObject.AddChild(e),e.script.chestController.prepare(i.info)}for(let e=0;e<n.length;e++)if(n[e].PatchIndex==l)for(let r=0;r<n[e].Placements.length;r++){var t=CollectableContainer.GetCollectable(n[e].CollectableType).clone();this.generatedPatches[l].script.patchObject.AddChild(t),t.setLocalPosition(n[e].Placements[r]),n[e].CollectableType!=CollectableType.MobGreen&&n[e].CollectableType!=CollectableType.MobBlue&&n[e].CollectableType!=CollectableType.MobYellow&&n[e].CollectableType!=CollectableType.MobOrange||(this.mobs.push(t)),n[e].CollectableType!=CollectableType.Gem_Group_1&&n[e].CollectableType!=CollectableType.Gem_Group_2&&n[e].CollectableType!=CollectableType.Gem_Group_3&&n[e].CollectableType!=CollectableType.Gem_Group_4&&n[e].CollectableType!=CollectableType.Gem_Group_5||(s+=t.children.length),n[e].CollectableType==CollectableType.Gem&&s++;var o=t.getPosition().clone();o.y=20;var p=new pc.Vec3(o.x,o.y-100,o.z),c=this.app.systems.rigidbody.raycastAll(o,p);for(let e=0;e<c.length;e++)if(c[e].entity.tags.has("road")){var u=c[e].point;t.setPosition(u)}}if(r&&l===r.info.patchIndex){let e;if(h){e=BossContainer.templates.biggBoss.clone(),e.enabled=!0,this.generatedPatches[l].script.patchObject.AddChild(e),r.info.maxHeroLevel=a,r.info.position.z+=.5*v,e.script.biggBossController.prepare(r.info,this.currentTotalLevel)}else{e=BossContainer.templates.miniBoss.clone(),e.enabled=!0,this.generatedPatches[l].script.patchObject.AddChild(e),r.info.maxHeroLevel=a,e.script.bossController.prepare(r.info,this.currentTotalLevel)}}}let C=this.currentTotalLevel%6==0,g={maxForward:d,initialColorType:l,mobsCount:a,gemsCount:s,level:this.currentTotalLevel,nextLevel:this.currentTotalLevel+1,isBigBossLevel:h,maxHeroLevel:C?Settings.scale.maxScale/1.5:a,isBonusLevel:C};Settings.pathColor.updateColors(g),this.app.fire(Events.OnLevelLoaded,g),LevelInfo=g}),.25)},LevelGenerator.prototype.isPlayerMobColorSame=function(e,t){return e===ColorType.Green&&t===CollectableType.MobGreen||e===ColorType.Blue&&t===CollectableType.MobBlue||e===ColorType.Orange&&t===CollectableType.MobOrange||e===ColorType.Yellow&&t===CollectableType.MobYellow},LevelGenerator.prototype.calculateMaxHeroLevel=function(e,t){let l=[],o=0;l.push({type:t,count:0});let n=!1;for(let t=0;t<e.length;t++){let r=JSON.parse(JSON.stringify(this.detectType(e[t].CollectableType)));if(r.isPainter){if(n)l.push({type:r.color,count:0});else{let e=l[0].count;l.forEach((t=>{t.count<e&&(e=t.count)})),o+=e,l=[],l.push({type:r.color,count:0})}n=!0}else if(r.isMob){for(let o=0;o<l.length;o++)if(this.isPlayerMobColorSame(l[o].type,e[t].CollectableType)){let n=[],r=0;e[t].Placements.forEach((e=>{-1===n.findIndex((t=>t===e.z))&&(n.push(e.z),r++)})),l[o].count+=r}n=!1}else n=!1}let r=l[0].count;return l.forEach((e=>{e.count<r&&(r=e.count)})),o+=r,l=[],o},LevelGenerator.prototype.detectType=function(e){let t={isPainter:!1,isMob:!1};return e===CollectableType.PainterGreen||e===CollectableType.PainterGreenHalf?(t.isPainter=!0,t.color=ColorType.Green):e===CollectableType.PainterOrange||e===CollectableType.PainterOrangeHalf?(t.isPainter=!0,t.color=ColorType.Orange):e===CollectableType.PainterYellow||e===CollectableType.PainterYellowHalf?(t.isPainter=!0,t.color=ColorType.Yellow):e!==CollectableType.PainterBlue&&e!==CollectableType.PainterBlueHalf||(t.isPainter=!0,t.color=ColorType.Blue),t.isMob=e===CollectableType.MobBlue||e===CollectableType.MobGreen||e===CollectableType.MobYellow||e===CollectableType.MobOrange,t},LevelGenerator.prototype.OnUnloadLevel=function(){},LevelGenerator.prototype.update=function(e){};var PatchObject=pc.createScript("patchObject");PatchObject.attributes.add("label",{type:"entity",title:"Label"}),PatchObject.attributes.add("PatchNextPos",{type:"entity"}),PatchObject.attributes.add("PlacementsParent",{type:"entity"}),PatchObject.prototype.initialize=function(){this.entity.on("setMul",this.setMultiplier,this),this.entity.on("setMat",this.setMaterial,this),this.entity.on("setBoss",this.setBoss,this),this.entity.on("setColor",this.setColor,this),this.onEnable(),this.on("enable",this.onEnable,this)},PatchObject.prototype.onEnable=function(){this.boss=void 0,this.passedColor=void 0,this.label&&(this.label.enabled=!1)},PatchObject.prototype.update=function(t){this.boss&&this.boss.script&&this.boss.script.bossController.posReference.getPosition().z+4>this.entity.getPosition().z&&this.passedColor&&(this.entity.render.meshInstances[1].material.diffuse.set(this.passedColor.r,this.passedColor.g,this.passedColor.b),this.entity.render.meshInstances[1].material.update(),this.passedColor=void 0,this.boss=void 0,this.app.fire("Track:CurrentMultiplier",this.multiplier))},PatchObject.prototype.setMultiplier=function(t){this.label&&(this.label.enabled=!!t,this.label.enabled&&(this.multiplier=t,this.label.element.text=`X${t.toFixed(1)}`))},PatchObject.prototype.setMaterial=function(t){this.entity.render.meshInstances[1].material=t,this.entity.render.meshInstances[1].material.update()},PatchObject.prototype.setColor=function(t){this.passedColor=t},PatchObject.prototype.setBoss=function(t){this.boss=t},PatchObject.prototype.AddChild=function(t){this.PlacementsParent?t.reparent(this.PlacementsParent):t.reparent(this.entity)};var Tween=pc.createScript("tween");Tween.attributes.add("tweens",{type:"json",schema:[{name:"autoPlay",title:"Autoplay",description:"Play tween immediately.",type:"boolean",default:!1},{name:"event",title:"Trigger Event",description:"Play tween on the specified event name. This event must be fired on the global application object (e.g. this.app.fire('eventname');).",type:"string"},{name:"path",title:"Path",description:"The path from the entity to the property. e.g. 'light.color', 'camera.fov' or 'script.vehicle.speed'.",type:"string"},{name:"relative",title:"Relative",description:"If checked, the start value is ingored and the end value will be the relative offset from the property's current value.",type:"boolean",default:!1},{name:"start",title:"Start",type:"vec4"},{name:"end",title:"End",type:"vec4"},{name:"easingFunction",title:"Easing Function",type:"number",enum:[{Linear:0},{Quadratic:1},{Cubic:2},{Quartic:3},{Quintic:4},{Sinusoidal:5},{Exponential:6},{Circular:7},{Elastic:8},{Back:9},{Bounce:10}]},{name:"easingType",title:"Easing Type",type:"number",enum:[{In:0},{Out:1},{InOut:2}]},{name:"duration",title:"Duration",description:"Time to execute the tween in milliseconds. Defaults to 1000.",type:"number",default:1e3},{name:"delay",title:"Delay",description:"Time to wait in milliseconds after receiving the trigger event before executing the tween. Defaults to 0.",type:"number",default:0},{name:"repeat",title:"Repeat",description:"The number of times the tween should be repeated after the initial playback. Defaults to 0.",type:"number",default:0},{name:"repeatDelay",title:"Repeat Delay",description:"Time to wait in milliseconds before executing each repeat of the tween. Defaults to 0.",type:"number",default:0},{name:"yoyo",title:"Yoyo",description:"This function only has effect if used along with repeat. When active, the behaviour of the tween will be like a yoyo, i.e. it will bounce to and from the start and end values, instead of just repeating the same sequence from the beginning. Defaults to false.",type:"boolean",default:!1},{name:"startEvent",title:"Start Event",description:"Executed right before the tween starts animating, after any delay time specified by the delay method. This will be executed only once per tween, i.e. it will not be run when the tween is repeated via repeat(). It is great for synchronising to other events or triggering actions you want to happen when a tween starts.",type:"string"},{name:"stopEvent",title:"Stop Event",description:"Executed when a tween is explicitly stopped via stop(), but not when it is completed normally.",type:"string"},{name:"updateEvent",title:"Update Event",description:"Executed each time the tween is updated, after the values have been actually updated.",type:"string"},{name:"completeEvent",title:"Complete Event",description:"Executed when a tween is finished normally (i.e. not stopped).",type:"string"},{name:"repeatEvent",title:"Repeat Event",description:"Executed whenever a tween has just finished one repetition and will begin another.",type:"string"}],array:!0}),Tween.prototype.initialize=function(){var e,t=this.app;this.tweenInstances=[],this.tweenCallbacks=[];var makeStartCallback=function(e){return function(){this.start(e)}};for(e=0;e<this.tweens.length;e++){var n=this.tweens[e];n.autoPlay&&this.start(e),n.event.length>0&&(this.tweenCallbacks[e]={event:n.event,cb:makeStartCallback(e)},t.on(this.tweenCallbacks[e].event,this.tweenCallbacks[e].cb,this))}this.on("enable",(function(){for(e=0;e<this.tweens.length;e++)this.tweenInstances[e]&&this.tweenInstances[e].isPaused()&&this.tweenInstances[e].resume()})),this.on("disable",(function(){for(e=0;e<this.tweens.length;e++)this.tweenInstances[e]&&this.tweenInstances[e].pause()})),this.on("attr",(function(n,a,i){for(e=0;e<this.tweenCallbacks.length;e++)this.tweenCallbacks[e]&&(t.off(this.tweenCallbacks[e].event,this.tweenCallbacks[e].cb,this),this.tweenCallbacks[e]=null);for(e=0;e<this.tweens.length;e++){var s=this.tweens[e];s.event.length>0&&(this.tweenCallbacks[e]={event:s.event,cb:makeStartCallback(e)},t.on(this.tweenCallbacks[e].event,this.tweenCallbacks[e].cb,this))}}))},Tween.prototype.start=function(e){var t,n=this.app,a=this.tweens[e],s=["Linear","Quadratic","Cubic","Quartic","Quintic","Sinusoidal","Exponential","Circular","Elastic","Back","Bounce"];t=0===a.easingFunction?TWEEN.Easing[s[a.easingFunction]].None:TWEEN.Easing[s[a.easingFunction]][["In","Out","InOut"][a.easingType]];var o=this.tweenInstances;o[e]&&o[e].stop();var l=a.path.split("."),c=this.entity;for(i=0;i<l.length-1;i++)c=c[l[i]];var r,p,u=l[l.length-1],h=c[u],d="number"==typeof h,f=a.start,w=a.end;if(d)r={x:f.x},p={x:w.x};else if(h instanceof pc.Vec2)r=new pc.Vec2(f.x,f.y),p=new pc.Vec2(w.x,w.y);else if(h instanceof pc.Vec3)r=new pc.Vec3(f.x,f.y,f.z),p=new pc.Vec3(w.x,w.y,w.z);else if(h instanceof pc.Vec4)r=f.clone(),p=w.clone();else{if(!(h instanceof pc.Color))return void console.error("ERROR: tween - specified property must be a number, vec2, vec3, vec4 or color");r=new pc.Color(f.x,f.y,f.z,f.w),p=new pc.Color(w.x,w.y,w.z,w.w)}switch(c[u]=d?r.x:r,u){case"localPosition":c.setLocalPosition(r);break;case"localEulerAngles":c.setLocalEulerAngles(r);break;case"localScale":c.setLocalScale(r);break;case"position":c.setPosition(r);break;case"eulerAngles":c.setEulerAngles(r)}c instanceof pc.Material&&c.update(),o[e]=new TWEEN.Tween(r).to(p,a.duration).easing(t).onStart((function(e){""!==a.startEvent&&n.fire(a.startEvent)})).onStop((function(t){""!==a.stopEvent&&n.fire(a.stopEvent),o[e]=null})).onUpdate((function(e){switch(c[u]=d?e.x:e,u){case"localPosition":c.setLocalPosition(e);break;case"localEulerAngles":c.setLocalEulerAngles(e);break;case"localScale":c.setLocalScale(e);break;case"position":c.setPosition(e);break;case"eulerAngles":c.setEulerAngles(e)}c instanceof pc.Material&&c.update(),""!==a.updateEvent&&n.fire(a.updateEvent)})).onComplete((function(t){""!==a.completeEvent&&n.fire(a.completeEvent),o[e]=null})).onRepeat((function(e){""!==a.repeatEvent&&n.fire(a.repeatEvent)})).repeat(a.repeat).repeatDelay(a.repeatDelay).yoyo(a.yoyo).delay(a.delay).start()};var app=pc.Application.getApplication();app&&app.on("update",(function(e){TWEEN.update()}));pc.extend(pc,function(){var TweenManager=function(t){this._app=t,this._tweens=[],this._add=[]};TweenManager.prototype={add:function(t){return this._add.push(t),t},update:function(t){for(var i=0,e=this._tweens.length;i<e;)this._tweens[i].update(t)?i++:(this._tweens.splice(i,1),e--);this._add.length&&(this._tweens=this._tweens.concat(this._add),this._add.length=0)}};var Tween=function(t,i,e){pc.events.attach(this),this.manager=i,e&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=t,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new pc.Quat,this._toQuat=new pc.Quat,this._quat=new pc.Quat,this.easing=pc.EASE_LINEAR,this._sv={},this._ev={}},_parseProperties=function(t){var i;return t instanceof pc.Vec2?i={x:t.x,y:t.y}:t instanceof pc.Vec3?i={x:t.x,y:t.y,z:t.z}:t instanceof pc.Vec4||t instanceof pc.Quat?i={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Color?(i={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(i.a=t.a)):i=t,i};Tween.prototype={to:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this},from:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this._from=!0,this},rotate:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this._slerp=!0,this},start:function(){var t,i,e,n;if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this._properties[t],this._ev[t]=this.target[t]);this._slerp&&(this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._fromQuat.setFromEulerAngles(i,e,n))}else{for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this.target[t],this._ev[t]=this._properties[t]);this._slerp&&(this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._toQuat.setFromEulerAngles(i,e,n))}return this._currentDelay=this._delay,this.manager.add(this),this},pause:function(){this.playing=!1},resume:function(){this.playing=!0},stop:function(){this.playing=!1,this.stopped=!0},delay:function(t){return this._delay=t,this.pending=!0,this},repeat:function(t,i){return this._count=0,this._numRepeats=t,this._repeatDelay=i||0,this},loop:function(t){return t?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this},yoyo:function(t){return this._yoyo=t,this},reverse:function(){return this._reverse=!this._reverse,this},chain:function(){for(var t=arguments.length;t--;)t>0?arguments[t-1]._chained=arguments[t]:this._chained=arguments[t];return this},update:function(t){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=t*this.timeScale:this.time-=t*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time=this.time-this._currentDelay,this.pending=!1}var i=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(i=this.duration-this.time,this.time=0):(i=this.time-this.duration,this.time=this.duration));var e,n,s=this.time/this.duration,r=this.easing(s);for(var h in this._properties)this._properties.hasOwnProperty(h)&&(e=this._sv[h],n=this._ev[h],this.target[h]=e+(n-e)*r);if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,r),this.entity&&(this.entity._dirtifyLocal(),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",t),this.complete){var a=this._repeat(i);return a?this.fire("loop"):(this.fire("complete",i),this.entity&&this.entity.off("destroy",this.stop,this),this._chained&&this._chained.start()),a}return!0},_repeat:function(t){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-t:this.time=t,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(var i in this._properties)tmp=this._sv[i],this._sv[i]=this._ev[i],this._ev[i]=tmp;this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}};var BounceIn=function(t){return 1-BounceOut(1-t)},BounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375};return{TweenManager:TweenManager,Tween:Tween,Linear:function(t){return t},QuadraticIn:function(t){return t*t},QuadraticOut:function(t){return t*(2-t)},QuadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},CubicIn:function(t){return t*t*t},CubicOut:function(t){return--t*t*t+1},CubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},QuarticIn:function(t){return t*t*t*t},QuarticOut:function(t){return 1- --t*t*t*t},QuarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},QuinticIn:function(t){return t*t*t*t*t},QuinticOut:function(t){return--t*t*t*t*t+1},QuinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},SineIn:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},SineOut:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},SineInOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))},ExponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},ExponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},ExponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},CircularIn:function(t){return 1-Math.sqrt(1-t*t)},CircularOut:function(t){return Math.sqrt(1- --t*t)},CircularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},BackIn:function(t){var i=1.70158;return t*t*((i+1)*t-i)},BackOut:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},BackInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},BounceIn:BounceIn,BounceOut:BounceOut,BounceInOut:function(t){return t<.5?.5*BounceIn(2*t):.5*BounceOut(2*t-1)+.5},ElasticIn:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4))},ElasticOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/.4)+1)},ElasticInOut:function(t){var i,e=.1,n=.4;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=n*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*.5+1)}}}()),function(){pc.Application.prototype.addTweenManager=function(){this._tweenManager=new pc.TweenManager(this),this.on("update",(function(t){this._tweenManager.update(t)}))},pc.Application.prototype.tween=function(t){return new pc.Tween(t,this._tweenManager)},pc.Entity.prototype.tween=function(t,i){var e=this._app.tween(t);return e.entity=this,this.once("destroy",e.stop,e),i&&i.element&&(e.element=i.element),e};var t=pc.Application.getApplication();t&&t.addTweenManager()}();!function(){var e=document.createElement("style");document.head.appendChild(e),e.innerHTML="canvas{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;outline:0;-webkit-tap-highlight-color:rgba(255,255,255,0)}body{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;outline:0}"}();var UranusInstancerLite=pc.createScript("uranusInstancerLite");UranusInstancerLite.attributes.add("frustumCulling",{type:"boolean",default:!1,title:"Frustum Culling",description:"Controls the culling of instances against the camera frustum (frustum culling needs to enabled on each camera component). If false all instances will be rendered regardless of their visibility. Changing this setting requires application reload."}),UranusInstancerLite.attributes.add("cloneMaterials",{type:"boolean",default:!0,title:"Clone Materials",description:"If selected all instances will use a clone of the original model material. This is useful when the original material is being used in non instanced models and otherwise it will produce render artifacts. Changing this setting requires application reload."}),UranusInstancerLite.attributes.add("disableShadows",{type:"boolean",default:!1,title:"Disable Shadows",description:"If selected no shadows buffers will be created (optimization). Requires app reload."}),UranusInstancerLite.attributes.add("disableTransparent",{type:"boolean",default:!0,title:"Disable Transparent",description:"If selected transparent mesh instances will not be instanced."}),UranusInstancerLite.attributes.add("excludeTag",{type:"string",default:"INSTANCING:Disable",title:"Exclude Tag",description:"The tag that can be used on entities to exclude them from instancing."}),UranusInstancerLite.attributes.add("excludeLayers",{type:"string",array:!0,default:["Depth","Skybox","Immediate","UI"],title:"Exclude Layers",description:"Mesh instances rendered in these layers won't be instanced."}),UranusInstancerLite.prototype.initialize=function(){UranusInstancerLite.api=this,this.payloads=void 0,this.vec=new pc.Vec3,this.vec2=new pc.Vec3,this.quat=new pc.Quat,this.matrix=new pc.Mat4,this.prepare(),window.setTimeout((()=>this.onState(!0)),0),this.on("state",this.onState,this),this.on("attr:disableShadows",this.onDisableShadows,this)},UranusInstancerLite.prototype.prepare=function(){this.overrideEngine(),this.payloads={},!this.frustumCulling&&this.cloneMaterials&&this.app.on("update",this.onUpdate,this)},UranusInstancerLite.prototype.onState=function(e){if(e){const e=this.app.scene.layers.layerList;for(let t=0;t<e.length;t++){const a=e[t];if(!1===this.isLayerValid(a))continue;const n=[];a.opaqueMeshInstances.forEach((e=>n.push(e)));const s=a.transparentMeshInstances;this.disableTransparent||a.transparentMeshInstances.forEach((e=>s.push(e))),UranusInstancerLite.removeMeshInstancesFunc.apply(a,[n]),a.addMeshInstances(n),this.disableTransparent||(UranusInstancerLite.removeMeshInstancesFunc.apply(a,[s]),a.addMeshInstances(s))}}else{for(let e in this.payloads){const t=this.payloads[e],a=t.refMeshInstances,n=t.layer;this.clearPayload(t),n.addMeshInstances(a)}this.payloads={}}},UranusInstancerLite.prototype.onDisableShadows=function(e){this.enabled&&(this.enabled=!1,this.enabled=!0)},UranusInstancerLite.prototype.setShadows=function(e){this.disableShadows=!e},UranusInstancerLite.prototype.isLayerValid=function(e){return-1===this.excludeLayers.indexOf(e.name)},UranusInstancerLite.prototype.getPayloadId=function(e,t,a,n){const s=n||e.material;return(15&t.id)<<27|(a?1:0)<<26|(511&e.mesh.id)<<13|(511&s.id)<<0},UranusInstancerLite.prototype.getMeshInstanceEntity=function(e){let t=e.node;if(t instanceof pc.Entity==!1){for(;t instanceof pc.Entity==!1&&t.parent;)t=t.parent;if(t instanceof pc.Entity==!1)return}return t},UranusInstancerLite.prototype.addMeshInstance=function(e,t,a,n){if(!e.material||e.mesh.skin)return!1;if("uranus-instancer-payload"===e.node.name)return!1;if(this.disableTransparent&&e.material.blendType!==pc.BLEND_NONE)return!1;const s=this.getMeshInstanceEntity(e);if(!s)return!1;const i=e.node!==s?e.node:s;if(s.tags.has(this.excludeTag))return!1;const r=s.render?s.render:s.model;return!(!r||r&&r.batchGroupId>-1)&&(n||this.addToPayload(s,i,e,t,!1),this.disableShadows||a||!e.castShadow||this.addToPayload(s,i,e,t,!0),this.overrideMeshInstance(e,(()=>{this.removeFromPayload(e,t,!1,null),this.removeFromPayload(e,t,!0,null),n||this.addToPayload(s,i,e,t,!1),this.disableShadows||a||!e.castShadow||this.addToPayload(s,i,e,t,!0)})),!0)},UranusInstancerLite.prototype.addToPayload=function(e,t,a,n,s){const i=this.getPayloadId(a,n,s);let r=this.payloads[i];if(r){if(r.refMeshInstances.indexOf(a)>-1)return r}else r=this.createPayload(i,a,n,s);const o={};return o.entity=e,r.refMeshInstances.push(a),a.uranusPayloadMaterial=a.material,o.meshInstance=a,o.node=t,r.instances.push(o),this.updateVertexBuffer(r,!0),this.frustumCulling||this.isMeshInstanceVisible(null,r),r},UranusInstancerLite.prototype.removeMeshInstance=function(e,t,a,n){if(e.mesh.skin)return!1;if("uranus-instancer-payload"===e.node.name)return!1;let s=!1;return n||(s=this.removeFromPayload(e,t,!1)),this.skipShadowCasters||a||(s=this.removeFromPayload(e,t,!0)),this.overrideMeshInstance(e),s},UranusInstancerLite.prototype.removeFromPayload=function(e,t,a){const n=e.uranusPayloadMaterial?e.uranusPayloadMaterial:e.material;if(!n)return!1;const s=this.getPayloadId(e,t,a,n),i=this.payloads[s];if(!i)return!1;if(i.refMeshInstances.length>0){const t=i.refMeshInstances.indexOf(e);if(-1===t)return!1;i.instances.splice(t,1),i.refMeshInstances.splice(t,1)}0===i.instances.length?(this.clearPayload(i),delete this.payloads[s]):(this.updateVertexBuffer(i,!0),this.frustumCulling||this.isMeshInstanceVisible(null,i))},UranusInstancerLite.prototype.clearPayload=function(e){e.vertexBuffer.destroy(),e.shadowCaster?e.layer.removeShadowCasters([e.meshInstance]):e.layer.removeMeshInstances([e.meshInstance],!0);const t=e.refMaterial;t&&(t.onUpdateShader=function(e){return e.useInstancing=!1,e},t.update(),this.cloneMaterials&&e.meshInstance.material.destroy())},UranusInstancerLite.prototype.updateVertexBuffer=function(e,t,a){let n;n=void 0!==a?a:e.instances.length;const s=e.vertexBuffer,i=s.format;if(s.numBytes=i.verticesByteSize?i.verticesByteSize:i.size*n,t||!s.originalStorage)s.originalStorage=new Float32Array(16*n),s.setData(s.originalStorage);else{const e=s.originalStorage.subarray(0,16*n);s.setData(e)}e.meshInstance.instancingData.count=n,s.numVertices=n},UranusInstancerLite.prototype.createPayload=function(e,t,a,n){const s=this.getPayloadMaterial(t.material),i=new pc.MeshInstance(t.mesh,s,new pc.GraphNode("uranus-instancer-payload"));i.pick=!1,i.castShadow=n,i.aabb.center.copy(t.aabb.center),i.aabb.halfExtents.copy(t.aabb.halfExtents),n?a.addShadowCasters([i]):a.addMeshInstances([i],!0);const r=new pc.VertexBuffer(this.app.graphicsDevice,pc.VertexFormat.defaultInstancingFormat,0,pc.BUFFER_DYNAMIC,new Float32Array);i.setInstancing(r);const o={id:e,instances:[],layer:a,meshInstance:i,refMaterial:t.material,refMeshInstances:[],shadowCaster:n,vertexBuffer:r};return o.shadowCaster&&(o.shouldUpdateShadows=!0),this.setPayloadCulling(this.frustumCulling,o),this.payloads[e]=o,o},UranusInstancerLite.prototype.setPayloadCulling=function(e,t){e?(t.meshInstance.cull=!0,t.meshInstance.isVisibleFunc=e=>this.isMeshInstanceVisible(e,t)):(t.meshInstance.cull=!1,delete t.meshInstance.isVisibleFunc)},UranusInstancerLite.prototype.isMeshInstanceVisible=function(e,t){if(this.updatePayload(t,e),t.shadowCaster&&t.shouldUpdateShadows){let e=!0;const a=t.meshInstance.aabb,n=t.instances;for(let t=0;t<n.length;t++){const s=n[t];if(s.cell)continue;const i=s.meshInstance;0!==i.visibleThisFrame&&(e?(e=!1,a.copy(i.aabb)):a.add(i.aabb))}}return!0},UranusInstancerLite.prototype.getPayloadMaterial=function(e){const t=this.cloneMaterials,a=t?e.clone():e;return a.onUpdateShader=function(e){return e.useInstancing=!0,e},a.update(),t&&this.app.fire("UranusInstancer:materialCloned",a),a},UranusInstancerLite.prototype.onUpdate=function(){const e=this.payloads;if(e&&this.cloneMaterials)for(let t in e)this.updatePayload(e[t])},UranusInstancerLite.prototype.updatePayload=function(e,t){let a=0;const n=e.instances;for(let s=0;s<n.length;s++){const i=n[s];a=this.updateInstance(i,e,a,t)}const s=a/16;this.updateVertexBuffer(e,!1,s),this.cloneMaterials&&this.checkPayloadMaterial(e)},UranusInstancerLite.prototype.checkPayloadMaterial=function(e){const t=e.refMeshInstances[0];if(!t)return;const a=t.material!==e.refMaterial;a&&(e.refMaterial=t.material);const n=e.refMaterial;if(n&&(n.dirty||a)){const t=this.getPayloadMaterial(n);e.meshInstance.material=t,this.app.once("postrender",(function(){e.refMaterial.dirty=!1}),this)}},UranusInstancerLite.prototype.updateInstance=function(e,t,a,n){if(n){if(!this.cullInstance(e,t,n))return a}const s=t.vertexBuffer.originalStorage,i=e.data?e.data:e.node.getWorldTransform().data;for(let e=0;e<16;e++)s[a++]=i[e];return a},UranusInstancerLite.prototype.cullInstance=function(e,t,a){const n=e.meshInstance;e.data&&n.aabb.center.copy(e.cullPosition);let s=n._isVisible(a);return n.visibleThisFrame=s,s>0},UranusInstancerLite.prototype.overrideEngine=function(){const e=pc.Layer.prototype.addMeshInstances;pc.Layer.prototype.addMeshInstances=function(t,a){if(UranusInstancerLite.api&&UranusInstancerLite.api.enabled&&UranusInstancerLite.api.isLayerValid(this)){let n=[];t.forEach((e=>{UranusInstancerLite.api.addMeshInstance(e,layer=this,a,!1)||n.push(e)})),arguments[0]=n,e.apply(this,arguments)}else e.apply(this,arguments)};const t=pc.Layer.prototype.removeMeshInstances;UranusInstancerLite.removeMeshInstancesFunc=t,pc.Layer.prototype.removeMeshInstances=function(e,a){if(UranusInstancerLite.api&&UranusInstancerLite.api.enabled&&UranusInstancerLite.api.isLayerValid(this)){let n=[];e.forEach((e=>{UranusInstancerLite.api.removeMeshInstance(e,layer=this,a,!1)||n.push(e)})),arguments[0]=n,t.apply(this,arguments)}else t.apply(this,arguments)};const a=pc.Layer.prototype.addShadowCasters;pc.Layer.prototype.addShadowCasters=function(e){if(UranusInstancerLite.api&&UranusInstancerLite.api.enabled&&UranusInstancerLite.api.isLayerValid(this)){let t=[];e.forEach((e=>{UranusInstancerLite.api.addMeshInstance(e,layer=this,!1,!0)||t.push(e)})),arguments[0]=t,a.apply(this,arguments)}else a.apply(this,arguments)};const n=pc.Layer.prototype.removeShadowCasters;pc.Layer.prototype.removeShadowCasters=function(e){if(UranusInstancerLite.api&&UranusInstancerLite.api.enabled&&UranusInstancerLite.api.isLayerValid(this)){let t=[];e.forEach((e=>{UranusInstancerLite.api.removeMeshInstance(e,layer=this,!1,!0)||t.push(e)})),arguments[0]=t,n.apply(this,arguments)}else n.apply(this,arguments)}},UranusInstancerLite.prototype.overrideMeshInstance=function(e,t){t?Object.defineProperty(e,"material",{set:function(e){for(let e=0;e<this._shader.length;e++)this._shader[e]=null;const a=this._material;if(a&&a.removeMeshInstanceRef(this),this._material=e,this._material){this._material.addMeshInstanceRef(this),this.updateKey();if((a&&a.blendType!==pc.BLEND_NONE)!==(this._material.blendType!==pc.BLEND_NONE)){let e=this._material._scene;!e&&a&&a._scene&&(e=a._scene),e?e.layers._dirtyBlend=!0:this._material._dirtyBlend=!0}t&&this._mesh&&t()}},get:function(){return this._material},configurable:!0}):Object.defineProperty(e,"material",{set:function(e){for(let e=0;e<this._shader.length;e++)this._shader[e]=null;const t=this._material;if(t&&t.removeMeshInstanceRef(this),this._material=e,this._material){this._material.addMeshInstanceRef(this),this.updateKey();if((t&&t.blendType!==pc.BLEND_NONE)!==(this._material.blendType!==pc.BLEND_NONE)){let e=this._material._scene;!e&&t&&t._scene&&(e=t._scene),e?e.layers._dirtyBlend=!0:this._material._dirtyBlend=!0}}},get:function(){return this._material},configurable:!0})};pc.script.createLoadingScreen((function(e){var t,a;t=["body {","    background-color: #FFFFFF;","}","","#application-splash-wrapper {","    position: absolute;","    top: 0;","    left: 0;","    height: 100%;","    width: 100%;","    background-color: #FFFFFF;","}","","#application-splash {","    position: absolute;","    top: calc(50% - 28px);","    width: 264px;","    left: calc(50% - 132px);","}","","#application-splash img {","    width: 100%;","}","","#progress-bar-container {","    margin: 20px auto 0 auto;","    height: 2px;","    width: 100%;","    background-color: #1d292c;","}","","#progress-bar {","    width: 0%;","    height: 100%;","    background-color: #35B2FF;","}","","@media (max-width: 480px) {","    #application-splash {","        width: 170px;","        left: calc(50% - 85px);","    }","}"].join("\n"),(a=document.createElement("style")).type="text/css",a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t)),document.head.appendChild(a),function(){var e=document.createElement("div");e.id="application-splash-wrapper",document.body.appendChild(e);var t=document.createElement("div");t.id="application-splash",e.appendChild(t),t.style.display="none";var a=document.createElement("img");a.src="https://www.tap-nation.io/wp-content/uploads/2022/03/cropped-Logo-TapNation-Site.png",t.appendChild(a),a.onload=function(){t.style.display="block"};var o=document.createElement("div");o.id="progress-bar-container",t.appendChild(o);var n=document.createElement("div");n.id="progress-bar",o.appendChild(n)}(),e.on("preload:end",(function(){e.off("preload:progress")})),e.once("postrender",(function(){try{Debug.log("SC Loading Complete"),sc.loadingComplete()}catch(e){console.error("[Snapchat] Sc-sdk is not loaded.")}}),this),e.on("preload:progress",(function(e){var t=document.getElementById("progress-bar");t&&(e=Math.min(1,Math.max(0,e)),t.style.width=100*e+"%"),e=Math.min(1,Math.max(0,e));try{sc.setLoadingProgress(e)}catch(e){console.error("[Snapchat] Sc-sdk is not loaded.")}})),e.on("start",(function(){var e=document.getElementById("application-splash-wrapper");e.parentElement.removeChild(e)}))}));var DeviceChecker=pc.createScript("deviceChecker");DeviceChecker.prototype.initialize=function(){this.app.deviceType={Low:"Low",Mid:"Mid",High:"High",None:"None"};let e=this.getDeviceType(),i=window.devicePixelRatio;pc.platform.mobile&&(e===this.app.deviceType.Low||e===this.app.deviceType.Mid?this.app.graphicsDevice.maxPixelRatio=Math.min(i,1.5):this.app.graphicsDevice.maxPixelRatio=Math.min(i,2))},DeviceChecker.prototype.update=function(e){},DeviceChecker.prototype.getDeviceType=function(){var e=pc.Application.getApplication().graphicsDevice.unmaskedRenderer;if(e&&pc.platform.mobile){if(-1!==e.search(/Adreno\D*3/)||-1!==e.search(/Adreno\D*4/)||-1!==e.search(/Adreno\D*505/)||-1!==e.search(/Adreno\D*506/)||-1!==e.search(/Mali\D*2/)||-1!==e.search(/Mali\D*3/)||-1!==e.search(/Mali\D*4/)||-1!==e.search(/Mali\D*5/)||-1!==e.search(/Mali\D*6/)||-1!==e.search(/Mali\D*T6/)||-1!==e.search(/Mali\D*T7/)||-1!==e.search(/Mali\D*T82/)||-1!==e.search(/Mali\D*T83/)||-1!==e.search(/Mali\D*T86/)||-1!==e.search(/Adreno\D*508/)||-1!==e.search(/Adreno\D*512/)||-1!==e.search(/Adreno\D*510/)||-1!==e.search(/Adreno\D*509/))return this.app.deviceType.Low;if(-1!==e.search(/Adreno\D*540/)||-1!==e.search(/Adreno\D*530/)||-1!==e.search(/Adreno\D*530/)||-1!==e.search(/Mali\D*T88/)||-1!==e.search(/Mali\D*G71/)||-1!==e.search(/Mali\D*G52/)||-1!==e.search(/Mali\D*G72/))return this.app.deviceType.Mid}return this.app.deviceType.High};var EffectSimpleWater=pc.createScript("effectSimpleWater");EffectSimpleWater.attributes.add("materialAsset",{type:"asset",assetType:"material"}),EffectSimpleWater.attributes.add("noiseTexture",{type:"asset",assetType:"texture"}),EffectSimpleWater.attributes.add("subdivisions",{type:"number",title:"Subdivisions",default:100}),EffectSimpleWater.attributes.add("waveVertexLength",{type:"number",default:1,min:0}),EffectSimpleWater.attributes.add("waveVertexAmplitude",{type:"number",default:1,min:0}),EffectSimpleWater.attributes.add("waterTextureIntensity",{type:"number",title:"Water Texture Intensity",default:.75}),EffectSimpleWater.attributes.add("waterTextureSpeed",{type:"vec2"}),EffectSimpleWater.tmpVec2=new pc.Vec2,EffectSimpleWater.tmpOffset=new pc.Vec2,EffectSimpleWater.prototype.initialize=function(){var e=this.entity.getPosition().clone();this.timer=0,this.prepareMaterial(),this.generateWaterMesh(),this.on("attr",this.updateAttributes),this.entity.setPosition(e)},EffectSimpleWater.prototype.prepareMaterial=function(){if(this.material=this.materialAsset?this.materialAsset.resource:null,this.material){var e=this.material.clone();this.material=e,this.entity.render.meshInstances[0].material=this.material,this.material.chunks.transformVS=EffectSimpleWater.transformVS,this.material.chunks.diffusePS=this.getDiffusePS(),this.material.update(),this.updateAttributes()}},EffectSimpleWater.prototype.updateAttributes=function(e){"materialAsset"===e&&this.prepareMaterial(),this.material&&(this.noiseTexture&&this.material.setParameter("waveNoiseTexture",this.noiseTexture.resource),this.material.setParameter("waveVertexLength",this.waveVertexLength),this.material.setParameter("waveVertexAmplitude",this.waveVertexAmplitude),this.material.setParameter("waterTextureIntensity",this.waterTextureIntensity))},EffectSimpleWater.prototype.generateWaterMesh=function(){if(!this.material)return;const e=this.entity.model?this.entity.model:this.entity.render;if(!e)return;const t=e.meshInstances[0].aabb,i=2*t.halfExtents.x*.01,r=2*t.halfExtents.z*.01,a=this.subdivisions,n=i,s=r;var f,o,l,m=[],u=[],p=[];for(f=0;f<=a;f++)for(o=0;o<=a;o++){var c=new pc.Vec3(o*n/a-n/2,0,(a-f)*s/a-s/2);m.push(c.x,c.y,c.z),u.push(o/a,1-f/a)}for(f=0;f<a;f++)for(o=0;o<a;o++)p.push(o+f*(a+1)),p.push(o+1+f*(a+1)),p.push(o+1+(f+1)*(a+1)),p.push(o+f*(a+1)),p.push(o+1+(f+1)*(a+1)),p.push(o+(f+1)*(a+1));l=pc.calculateNormals(m,p);var d=pc.createMesh(this.app.graphicsDevice,m,{normals:l,uvs:u,indices:p}),h=new pc.MeshInstance(d,this.material);e.meshInstances=[h]},EffectSimpleWater.prototype.update=function(e){this.material&&(this.timer+=e,this.material.setParameter("waterWavesTime",this.timer),this.scrollWaterTexture(e))},EffectSimpleWater.prototype.scrollWaterTexture=function(e){var t=EffectSimpleWater.tmpVec2,i=EffectSimpleWater.tmpOffset;t.set(this.waterTextureSpeed.x,this.waterTextureSpeed.y),t.scale(e),i.copy(this.material.diffuseMapOffset),i.add(t),this.material.diffuseMapOffset=i,this.material.normalMapOffset=i,this.material.update()},EffectSimpleWater.prototype.swap=function(){this.initialize()},EffectSimpleWater.transformVS="\nuniform float waterWavesTime;\nuniform float waveVertexLength;\nuniform float waveVertexAmplitude;\n\nmat4 getModelMatrix() {\n    #ifdef DYNAMICBATCH\n    return getBoneMatrix(vertex_boneIndices);\n    #elif defined(SKIN)\n    return matrix_model * getSkinMatrix(vertex_boneIndices, vertex_boneWeights);\n    #elif defined(INSTANCING)\n    return mat4(instance_line1, instance_line2, instance_line3, instance_line4);\n    #else\n    return matrix_model;\n    #endif\n}\n\nvec4 getPosition() {\n    dModelMatrix = getModelMatrix();\n    vec3 localPos = vertex_position;\n\n    vec4 posW = dModelMatrix * vec4(localPos, 1.0);\n    posW.y += cos(posW.z * waveVertexLength + waterWavesTime) * waveVertexAmplitude * sin(posW.x * waveVertexLength + waterWavesTime);\n\n    dPositionW = posW.xyz;\n\n    vec4 screenPos = matrix_viewProjection * posW;\n    return screenPos;\n}\n\nvec3 getWorldPosition() {\n    return dPositionW;\n}\n",EffectSimpleWater.prototype.getDiffusePS=function(){return`\n${this.noiseTexture?"uniform sampler2D waveNoiseTexture;":""}\nuniform float waterWavesTime;\nuniform float waterTextureIntensity;\n\n#ifdef MAPCOLOR\nuniform vec3 material_diffuse;\n#endif\n\n#ifdef MAPTEXTURE\nuniform sampler2D texture_diffuseMap;\n#endif\n\nvoid getAlbedo() {\n    dAlbedo = vec3(1.0);\n\n    #ifdef MAPCOLOR\n    dAlbedo *= material_diffuse.rgb;\n    #endif\n\n    #ifdef MAPTEXTURE\n    ${this.noiseTexture?"\n    vec2 noiseCoords = $UV * 0.5 + sin(waterWavesTime) * 0.03;\n    vec3 waterNoise = gammaCorrectInput(texture2D(waveNoiseTexture, noiseCoords).$CH);\n    ":""}\n\n    vec3 waterMask = gammaCorrectInput(texture2D(texture_diffuseMap, $UV).$CH);\n\n    ${this.noiseTexture?"\n    dAlbedo.rgb += waterMask.r * waterTextureIntensity * waterNoise.r;\n    ":"\n    dAlbedo.rgb += waterMask.r * waterTextureIntensity;\n    "}    \n    #endif\n\n    #ifdef MAPVERTEX\n    dAlbedo *= gammaCorrectInput(saturate(vVertexColor.$VC));\n    #endif\n}\n`};var RotateEntity=pc.createScript("rotateEntity");RotateEntity.attributes.add("vec3Speed",{type:"vec3"}),RotateEntity.attributes.add("vec3",{type:"vec3"}),RotateEntity.prototype.initialize=function(){},RotateEntity.prototype.update=function(t){this.entity.rotate(this.vec3.x*this.vec3Speed.x*t,this.vec3.y*this.vec3Speed.y*t,this.vec3.z*this.vec3Speed.z*t)};var LevelData=pc.createScript("levelData");LevelData.attributes.add("Segments",{type:"json",schema:[{name:"Layer",type:"number",enum:[{Top:0},{Bottom:1}]},{name:"Patches",type:"number",enum:[{RoadFlat:0},{RoadSlide:1},{RoadDoubleSlide:2},{RoadLeftHalf:3},{RoadLeftThird:4},{RoadRightHalf:5},{RoadRightThird:6},{RoadStart_Arena:7},{RoadEnd_Arena:8},{RoadEnd_ArenaBig:9},{RoadMiddle_Arena:10},{RoadFinishSegment:11},{RoadRotatingCircle:12},{RoadPainterCircle:13},{RoadPainterHalf:14},{RoadFlatWall:15},{RoadFlatObstacle:16},{RoadFlatQuarter:17}],array:!0},{name:"ColorType",type:"number",enum:[{Green:0},{Blue:1},{Orange:2},{Yellow:3},{Red:4}]}]}),LevelData.attributes.add("CollectableData",{type:"json",schema:[{name:"Layer",type:"number",enum:[{Top:0},{Bottom:1}]},{name:"PatchIndex",type:"number"},{name:"CollectableType",type:"number",enum:[{MobGreen:0},{MobOrange:1},{Gem:2},{Key:3},{PainterGreen:4},{PainterOrange:5},{MobYellow:6},{PainterYellow:7},{PainterBlue:8},{MobBlue:9},{BreakableWall:10},{Pole:11},{Rail:12},{RailSmall:13},{RailDouble:14},{FlapperLeft:15},{FlapperRight:16},{FlapperDouble:17},{FlapperTwoSided:18},{Totem:19},{Gate:20},{Arrow1:21},{Arrow2:22},{Arrow3:23},{Arrow4:24},{Arrow5:25},{Arrow6:26},{Arrow7:27},{Arrow8:28},{Arrow9:29},{PainterGreenHalf:30},{PainterOrangeHalf:31},{PainterYellowHalf:32},{PainterBlueHalf:33},{Lava:34},{Gem_Group_1:35},{Gem_Group_2:36},{Gem_Group_3:37},{Gem_Group_4:38},{Gem_Group_5:39},{Totem_Double:40},{ShoesShoes:41},{SharkShoes:42},{BigfootShoes:43},{SocksShoes:44},{BunnyShoes:45},{WingsShoes:46},{BootsShoes:47},{KedsShoes:48},{PointesShoes:49}]},{name:"Placements",type:"vec3",array:!0}],array:!0}),LevelData.prototype.initialize=function(){},LevelData.prototype.update=function(e){};var CollectableContainer=pc.createScript("collectableContainer");CollectableContainer.attributes.add("Collectables",{type:"json",schema:[{name:"CollectableObject",type:"entity"},{name:"CollectableType",type:"number",enum:[{MobGreen:0},{MobOrange:1},{Gem:2},{Key:3},{PainterGreen:4},{PainterOrange:5},{MobYellow:6},{PainterYellow:7},{PainterBlue:8},{MobBlue:9},{BreakableWall:10},{Pole:11},{Rail:12},{RailSmall:13},{RailDouble:14},{FlapperLeft:15},{FlapperRight:16},{FlapperDouble:17},{FlapperTwoSided:18},{Totem:19},{Gate:20},{Arrow1:21},{Arrow2:22},{Arrow3:23},{Arrow4:24},{Arrow5:25},{Arrow6:26},{Arrow7:27},{Arrow8:28},{Arrow9:29},{PainterGreenHalf:30},{PainterOrangeHalf:31},{PainterYellowHalf:32},{PainterBlueHalf:33},{Lava:34},{Gem_Group_1:35},{Gem_Group_2:36},{Gem_Group_3:37},{Gem_Group_4:38},{Gem_Group_5:39},{Totem_Double:40},{ShoesShoes:41},{SharkShoes:42},{BigfootShoes:43},{SocksShoes:44},{BunnyShoes:45},{WingsShoes:46},{BootsShoes:47},{KedsShoes:48},{PointesShoes:49}]}],array:!0}),CollectableContainer.prototype.initialize=function(){CollectableContainer=this},CollectableContainer.prototype.GetCollectable=function(e){return _.findWhere(this.Collectables,{CollectableType:e}).CollectableObject},CollectableContainer.prototype.update=function(e){};var CollectableObject=pc.createScript("collectableObject");CollectableObject.attributes.add("key",{type:"string",default:""}),CollectableObject.attributes.add("CollectableType",{type:"number",enum:[{MobGreen:0},{MobOrange:1},{Gem:2},{Key:3},{PainterGreen:4},{PainterOrange:5},{MobYellow:6},{PainterYellow:7},{PainterBlue:8},{MobBlue:9},{BreakableWall:10},{Pole:11},{Rail:12},{RailSmall:13},{RailDouble:14},{FlapperLeft:15},{FlapperRight:16},{FlapperDouble:17},{FlapperTwoSided:18},{Totem:19},{Gate:20},{Arrow1:21},{Arrow2:22},{Arrow3:23},{Arrow4:24},{Arrow5:25},{Arrow6:26},{Arrow7:27},{Arrow8:28},{Arrow9:29},{PainterGreenHalf:30},{PainterOrangeHalf:31},{PainterYellowHalf:32},{PainterBlueHalf:33},{Lava:34},{Gem_Group_1:35},{Gem_Group_2:36},{Gem_Group_3:37},{Gem_Group_4:38},{Gem_Group_5:39},{Totem_Double:40},{ShoesShoes:41},{SharkShoes:42},{BigfootShoes:43},{SocksShoes:44},{BunnyShoes:45},{WingsShoes:46},{BootsShoes:47},{KedsShoes:48},{PointesShoes:49}]}),CollectableObject.prototype.initialize=function(){},CollectableObject.prototype.update=function(e){};var PlayerController=pc.createScript("playerController");PlayerController.dodge={left:"Left",right:"Right"},PlayerController.attributes.add("shake",{type:"vec3",default:[.3,.08,.05]}),PlayerController.attributes.add("Speed",{type:"number"}),PlayerController.attributes.add("maxHealth",{type:"number",title:"Health",default:100}),PlayerController.attributes.add("Steer",{type:"number"}),PlayerController.attributes.add("MaxBounds",{type:"vec2"}),PlayerController.attributes.add("PlayerRB",{type:"entity"}),PlayerController.attributes.add("PlayerRender",{type:"entity"}),PlayerController.attributes.add("PlayerAnimator",{type:"entity"}),PlayerController.attributes.add("RaycastDebug",{type:"entity"}),PlayerController.attributes.add("RaycastPoint",{type:"entity"}),PlayerController.attributes.add("RageModeEntity",{type:"entity"}),PlayerController.attributes.add("RageMode",{type:"entity"}),PlayerController.attributes.add("finishLineProgressVal",{type:"number",title:"Finish Line Progress Value"}),PlayerController.attributes.add("punchVFX",{type:"entity"}),PlayerController.attributes.add("purpleKickVFX",{type:"entity"}),PlayerController.attributes.add("vfxPositions",{type:"entity",array:!0}),PlayerController.attributes.add("dodgePositions",{title:"Dodge Positions",type:"json",schema:[{name:"position",type:"vec3"}],array:!0}),PlayerController.attributes.add("testing",{title:"Testing",type:"json",schema:[{name:"customHeroDamage",type:"number"},{name:"customHeroScale",type:"number"}]}),PlayerController.prototype.initialize=function(){PlayerController.instance=this,this.initVars(),this.initEvents()},PlayerController.prototype.initVars=function(){this.v=0,this.h=0,this.lavaDamageDelay=0,this.maxLavaDamageDelay=0;var e=this.entity.getPosition().clone(),t=this.entity.getLocalEulerAngles().clone();this.x=e.x,this.y=this.PlayerRB.getPosition().clone().y,this.z=e.z,this.initialPosition=e,this.initialRotation=t,this.h=0,this.canControl=!1,this.steerInput=0,this.thrustInput=0,this.colorType=ColorType.Green,this.color=null,this.scale=1,this.material=this.PlayerRender.render.meshInstances[0].material.clone(),this.PlayerRender.render.meshInstances[0].material=this.material,this.playerCrown=this.entity.findByName("Crown"),this.damageDelay=.25,this.prepareDamageTrigger=!1,this.maxDamageDelay=this.damageDelay,this.isFighting=!1,this.isFinishlineReached=!1,this.objects=[],this.attacking=!1,this.min=-this.MaxBounds.x,this.max=this.MaxBounds.x,this.bigBossFightingController=new PlayerBigBossFighting(this),this.newScale=new pc.Vec3(0,0,0),this.newAlignment=new pc.Vec3(0,0,0),this.newDir=new pc.Vec3(0,0,0)},PlayerController.prototype.initEvents=function(){this.PlayerRB.rigidbody.on("triggerenter",this.OnTriggerEnter,this),this.PlayerRB.rigidbody.on("triggerleave",this.OnTriggerExit,this),this.app.on(Events.OnTouchMove,this.OnTouchMove,this),this.app.on(Events.OnTouchBegin,this.OnTouchBegin,this),this.app.on(Events.OnTouchEnd,this.OnTouchEnd,this),this.app.on(Events.OnLevelLoaded,this.OnLevelLoaded,this),this.app.on(Events.OnStartGame,this.OnStartGame,this),this.app.on(Events.OnSetCrownState,this.OnSetCrownState,this),this.app.on(Events.OnAttack,this.OnAttack,this),this.app.on(Events.OnFightSequenceBegins,this.OnFightSequenceBegins,this),this.app.on(Events.OnFightSequenceCompleted,this.OnFightSequenceCompleted,this),this.app.on(Events.OnBonusSequenceBegins,this.OnBonusSequenceBegins,this),this.app.on(Events.OnBonusSequenceCompleted,this.OnBonusSequenceCompleted,this),this.app.on(Events.OnDamage,this.OnDamage,this),this.app.on(Events.OnHealthChanged,this.OnHealthChanged,this),this.app.on(Events.OnRevivePlayer,this.OnRevivePlayer,this),this.app.on(Events.OnRageModeActivated,this.OnRageModeActivated,this),this.app.on(Events.OnRageModeDeactivated,this.OnRageModeDeactivated,this),this.app.on(Events.OnTapBonus,this.OnTapBonus,this),this.app.on("Player:Kick",this.ProcessKick,this),this.app.on("PlayerDodge:Left",(()=>{this.onSwipe(PlayerController.dodge.left)})),this.app.on("PlayerDodge:Right",(()=>{this.onSwipe(PlayerController.dodge.right)})),this.app.on("DodgePositionsBroadCaster:Positions",this.onDodgePositionsRecieved,this),this.app.on("Player:PlayPunchVfx",this.playPunchVfx,this),this.app.on("Player:PlayKickVfx",this.playKickVfx,this),this.app.on("Player:PlayKickPurpleVfx",this.playKickPurpleVfx,this),this.app.on("Player:PlayDeadAnimSeq",this.playDeadAnimSeq,this),this.app.on("BigBossFighting:Begin",this.onBigBossFightStarted,this),this.app.on("BigBossFighting:BossTired",this.onBigBossTired,this),this.app.on("BigBossFighting:BossRage",this.onBigBossRage,this),this.app.on(Events.OnTap,this.onTap,this),this.app.on("BigBoss:HitPlayer",this.onBigBossHit,this),this.app.on("BigBossFighting:BossBeaten",(()=>{this.bigBossFightingController.setBossBeaten()})),this.app.on("BigBossFighting:BonusTimeOver",this.onBonusTimeOver,this),this.app.on("BigBossFighting:OnComplete",this.onBigBossFightComplete,this)},PlayerController.prototype.OnTapBonus=function(){BonusViewController.Instance.isTappingAllowed&&this.ProcessPunch(1)},PlayerController.prototype.onTap=function(){this.bigBossFightingController.attackBigBoss(this.getDamage())},PlayerController.prototype.OnRageModeActivated=function(){this.RageMode.enabled=!0,this.app.fire(Events.OnColorChangedRageMode,{rage:!0,color:ColorsContainer.GetColor(this.colorType)})},PlayerController.prototype.OnRageModeDeactivated=function(){this.RageMode.enabled=!1;for(let e=0;e<this.objects.length;e++){this.objects[e].enabled=!1}this.objects=[],this.app.fire(Events.OnColorChangedRageMode,{rage:!1,color:ColorsContainer.GetColor(this.colorType)})},PlayerController.prototype.OnFightSequenceCompleted=function(){this.damageDelay=.25,this.isFighting=!1,this.app.fire("onStartMovementSound",!1)},PlayerController.prototype.OnBonusSequenceCompleted=function(){this.isFighting=!1,this.punchCoroutine&&clearTimeout(this.punchCoroutine),this.app.fire("onStartMovementSound",!1),this.ProcessVictory(!0)},PlayerController.prototype.OnRevivePlayer=function(){if(this.bigBossFightingController.isFighting)this.app.fire(Events.OnChangeMenuState,MenuManager.States.Gameplay),this.ProcessRevive(),this.app.fire("sound:playSound","Revive"),CustomCoroutine.Instance.set((()=>{this.onBonusTimeOver()}),this.getAnimDuration("Revive"));else if(this.isFighting){this.app.fire(Events.OnChangeMenuState,MenuManager.States.Gameplay),this.ProcessRevive(),this.isRevived=!0;let e=this.PlayerAnimator.getLocalScale().x;this.heroLevel=this.maxHeroLevel;let t=Settings.scale.getHeroScale(this.heroLevel);this.app.fire("sound:playSound","Revive"),TweenWrapper.TweenNumber(e,t,.25,(e=>{this.PlayerAnimator.setLocalScale(e.number,e.number,e.number)})),CustomCoroutine.Instance.set((()=>{this.app.fire(Events.OnHealthChanged,{target:AttackTarget.Boss,health:0,reason:"Player"})}),this.getAnimDuration("Revive"))}else this.health=this.maxHealth,this.canControl=!0,this.app.fire("onStartMovementSound",!0),this.PlayAnim("Running"),this.app.fire(Events.OnChangeMenuState,MenuManager.States.Gameplay)},PlayerController.prototype.OnHealthChanged=function(e){e.health<=0&&(e.target==AttackTarget.Player?(this.canControl=!1,"Obstacle"===e.reason&&this.ProcessDeath(),this.app.fire("FightView:EnableTapTap",!1),this.app.fire(Events.OnPlayerDead,e.reason),this.app.fire("onStartMovementSound",!1)):(this.app.fire(Events.OnChangeCameraState,CameraState.Flight,2),this.isVictorious=!0,this.ProcessKick()))},PlayerController.prototype.playDeadAnimSeq=function(){CustomCoroutine.Instance.set((()=>{GameManager.Instance.setGameSpeed(1),this.app.fire(Events.OnChangeCameraState,CameraState.Dead,2)}),.3),this.ProcessDeath(!0)},PlayerController.prototype.OnDamage=function(e){e.target==AttackTarget.Player&&(this.prepareDamageTrigger=!1,this.damageDelay=this.maxDamageDelay,this.ProcessHurt())},PlayerController.prototype.OnFightSequenceBegins=function(){this.isFighting=!0,this.ProcessAttack()},PlayerController.prototype.OnBonusSequenceBegins=function(){this.isFighting=!0,this.ProcessAttack()},PlayerController.prototype.OnAttack=function(e){if(e.target==AttackTarget.Boss)return this.prepareDamageTrigger=!0,void this.ProcessPunch();e.target==AttackTarget.Chest&&this.ProcessPunch()},PlayerController.prototype.OnSetCrownState=function(e){this.playerCrown.enabled=e},PlayerController.prototype.OnStartGame=function(e){this.PlayerAnimator.setLocalScale(1,1,1),this.isDead=!1,this.isVictorious=!1,this.isRevived=!1,this.health=this.maxHealth,this.bigBossFightingController.reset();let t=Settings.biggBossFighting.multiplierSettings;this.bigBossFightingController.setMultiplier(t.startMultiplier,t.maxMultiplier),this.isFighting=!1,this.canControl=e,this.isFinishlineReached=!1,this.OnSetCrownState(!1),this.app.fire("onStartMovementSound",e),e?this.PlayAnim("Running"):this.PlayAnim("Idle"),this.x=0,this.y=.85,this.z=-4;var i=new pc.Vec3(this.x,this.y,this.z);this.PlayerRB.setPosition(i);var o=e?CameraState.Gameplay:CameraState.Mainmenu,a=o===CameraState.Mainmenu;this.app.fire(Events.OnChangeCameraState,o,5,a)},PlayerController.prototype.OnLevelLoaded=function(e){this.isBigBossLevel=e.isBigBossLevel,this.bigBossFightingController.isBossBeaten=!1,this.MaxBounds.z=e.maxForward,this.UpdateColor(e.initialColorType),this.x=0,this.y=.85,this.z=-4,this.scale=1,this.h=0,this.PlayerRB.setLocalEulerAngles(0,0,0);var t=new pc.Vec3(this.x,this.y,this.z);this.maxHeroLevel=e.maxHeroLevel,this.heroLevel=0,this.scale=e.isBonusLevel?e.maxHeroLevel:1,this.PlayerRB.setPosition(t),this.PlayerAnimator.setLocalScale(1,1,1),this.PlayAnim("Idle")},PlayerController.prototype.OnTouchMove=function(e){this.isFinishlineReached||(this.h=pc.math.clamp(e,-1,1),this.x=pc.math.clamp(this.x-e,this.min,this.max))},PlayerController.prototype.ClampPosition=function(){this.x=pc.math.clamp(this.x,this.min,this.max),this.z=pc.math.clamp(this.z,-4,this.MaxBounds.z)},PlayerController.prototype.OnTriggerEnter=function(e){e.tags.has("Collectable")&&this.HandleCollectableInteraction(e),e.tags.has("Obstacle")&&this.HandleObstacleInteraction(e),e.tags.has("Bounds")&&this.HandleBoundsInteraction(e)},PlayerController.prototype.OnTriggerExit=function(e){e.tags.has("Bounds")&&this.ResetBounds(),e.tags.has("Lava")&&(this.floorIsLava=!1,this.lavaDamageDelay=0,e.script.damageTrigger.activateDamage(!1))},PlayerController.prototype.ResetBounds=function(){this.min=-this.MaxBounds.x,this.max=this.MaxBounds.x},PlayerController.prototype.HandleBoundsInteraction=function(e){var t=e.script.boundsInfo;if(t){var i=t.minX,o=t.maxX;this.min=i,this.max=o}},PlayerController.prototype.HandleObstacleInteraction=function(e){if(this.canControl){var t=e.script?.trigger;t&&t.Fire();var i=e.script.deathTrapInfo,o=e.script.collectableObject;if(i){if(e.collision.enabled=!1,e.tags.has("wall")){this.app.timeScale=.5;let e=this;TweenWrapper.TweenNumber(.5,1,1,(function(t){e.app.timeScale=t.number})),this.app.fire("sound:playSound","WallBreak")}if(e.tags.has("Lava")&&(this.floorIsLava=!0,this.lavaDamageDelay=0,this.maxLavaDamageDelay=e.script.damageTrigger.damageEvery,Debug.log("CHUPALA SORETE"),e.script.damageTrigger.activateDamage(!0)),o){var a={color:null,type:o.CollectableType,pos:e.getPosition(),isValidColor:!1};this.app.fire(Events.OnCollectablePicked,a)}else LevelInfo.isBonusLevel||this.app.fire(Events.OnHealthChanged,{target:AttackTarget.Player,health:0,reason:"Obstacle"})}}},PlayerController.prototype.HandleCollectableInteraction=function(e){var t=e.script.collectableObject,i=null,o=null,a="";switch(t.CollectableType){case CollectableType.MobGreen:e.enabled=!1,o=ColorType.Green,this.UpdateScale(ColorType.Green),i=ColorsContainer.GetColor(ColorType.Green),this.app.fire("onMobHit",ColorType.Green,e);break;case CollectableType.MobOrange:e.enabled=!1,o=ColorType.Orange,this.UpdateScale(ColorType.Orange),i=ColorsContainer.GetColor(ColorType.Orange),this.app.fire("onMobHit",ColorType.Orange,e);break;case CollectableType.MobBlue:e.enabled=!1,o=ColorType.Blue,this.UpdateScale(ColorType.Blue),i=ColorsContainer.GetColor(ColorType.Blue),this.app.fire("onMobHit",ColorType.Blue,e);break;case CollectableType.MobYellow:e.enabled=!1,o=ColorType.Yellow,this.UpdateScale(ColorType.Yellow),i=ColorsContainer.GetColor(ColorType.Yellow),this.app.fire("onMobHit",ColorType.Yellow,e);break;case CollectableType.PainterGreen:o=ColorType.Green,this.UpdateColor(ColorType.Green),i=ColorsContainer.GetColor(ColorType.Green),this.app.fire("onPainterHit",ColorType.Green,e);break;case CollectableType.PainterOrange:o=ColorType.Orange,this.UpdateColor(ColorType.Orange),i=ColorsContainer.GetColor(ColorType.Orange),this.app.fire("onPainterHit",ColorType.Orange,e);break;case CollectableType.PainterYellow:o=ColorType.Yellow,this.UpdateColor(ColorType.Yellow),i=ColorsContainer.GetColor(ColorType.Yellow),this.app.fire("onPainterHit",ColorType.Yellow,e);break;case CollectableType.PainterBlue:o=ColorType.Blue,this.UpdateColor(ColorType.Blue),i=ColorsContainer.GetColor(ColorType.Blue),this.app.fire("onPainterHit",ColorType.Blue,e);break;case CollectableType.PainterGreenHalf:o=ColorType.Green,this.UpdateColor(ColorType.Green),i=ColorsContainer.GetColor(ColorType.Green),this.app.fire("onPainterHit",ColorType.Green,e);break;case CollectableType.PainterOrangeHalf:o=ColorType.Orange,this.UpdateColor(ColorType.Orange),i=ColorsContainer.GetColor(ColorType.Orange),this.app.fire("onPainterHit",ColorType.Orange,e);break;case CollectableType.PainterYellowHalf:o=ColorType.Yellow,this.UpdateColor(ColorType.Yellow),i=ColorsContainer.GetColor(ColorType.Yellow),this.app.fire("onPainterHit",ColorType.Yellow,e);break;case CollectableType.PainterBlueHalf:o=ColorType.Blue,this.UpdateColor(ColorType.Blue),i=ColorsContainer.GetColor(ColorType.Blue),this.app.fire("onPainterHit",ColorType.Blue,e);break;case CollectableType.Gem:e.enabled=!1;break;case CollectableType.Key:e.enabled=!1,this.app.fire("onKeyHit"),this.app.fire("sound:playSound","KeyCollision");break;case CollectableType.ShoesShoes:case CollectableType.SharkShoes:case CollectableType.BigfootShoes:case CollectableType.SocksShoes:case CollectableType.BunnyShoes:case CollectableType.WingsShoes:case CollectableType.BootsShoes:case CollectableType.KedsShoes:case CollectableType.PointesShoes:e.enabled=!1,a=SkinType.Shoes}var s={color:i,type:t.CollectableType,pos:e.getPosition(),skinType:a,key:t.key,isValidColor:!!this.RageMode.enabled||o==this.colorType};this.app.fire(Events.OnCollectablePicked,s)},PlayerController.prototype.UpdateColor=function(e){var t=ColorsContainer.GetColor(e);this.colorType=e,this.color=t,this.material.diffuse.set(t.r,t.g,t.b),this.material.emissive.set(t.r,t.g,t.b),this.material.update(),this.RageMode.enabled&&this.app.fire(Events.OnColorChangedRageMode,{rage:!0,color:ColorsContainer.GetColor(this.colorType)})},PlayerController.prototype.UpdateScale=function(e){this.colorType==e||this.RageMode.enabled?this.heroLevel++:this.heroLevel--,this.heroLevel=pc.math.clamp(this.heroLevel,0,this.maxHeroLevel),this.setPlayerScale(.05*(this.heroLevel+1)+1)},PlayerController.prototype.setPlayerScale=function(e){this.testing.customHeroScale>0?this.scale=this.testing.customHeroScale:this.scale=e,this.scale=pc.math.clamp(this.scale,Settings.scale.minScale,Settings.scale.maxScale)},PlayerController.prototype.update=function(e){this.prepareDamageTrigger&&(this.damageDelay-=e,this.damageDelay<=0&&(this.damageDelay=this.maxDamageDelay,this.prepareDamageTrigger=!1,this.app.fire(Events.OnDamage,{target:AttackTarget.Boss,damage:this.getDamage(),reason:"Player"}))),this.ProcessRageTargets(e),this.bigBossFightingController.manageBigBossFighting(e),this.canControl&&(this.ProcessPlayerProgress(),this.ProcessLavaDamage(e),this.ProcessMovement(e),this.ProcessInputs(e),this.ProcessScale(e),this.ProcessAlignment(),this.ClampPosition())},PlayerController.prototype.ProcessLavaDamage=function(e){this.floorIsLava&&(this.lavaDamageDelay-=e,this.lavaDamageDelay<=0&&(this.UpdateScale(null),this.lavaDamageDelay=this.maxLavaDamageDelay))},PlayerController.prototype.getDamage=function(){let e;if(this.testing.customHeroDamage>0)e=this.testing.customHeroDamage;else if(this.isBigBossLevel){let t=BiggBossFightingManager.Instance.isTutorialRequired,i=Settings.biggBossFighting.damageSettings.heroDamage;e=t?i.x:i.y}else{let t=ReferenceManager.Instance.boss.script.bossController;e=this.heroLevel>=t.bossLevel?Settings.fightingDamage.hero.highDamage:this.heroLevel*Settings.fightingDamage.hero.heroWinFactor>=t.bossLevel?Settings.fightingDamage.hero.mediumDamage:Settings.fightingDamage.hero.lowDamage}return e},PlayerController.prototype.ProcessRageTargets=function(e){for(let a=0;a<this.objects.length;a++){let s=this.objects[a];if(s.enabled){var t=s.getPosition(),i=this.PlayerRB.getPosition(),o=t.distance(i);s.parent!=this.PlayerRB&&s.reparent(this.PlayerRB),o<=.5?(s.enabled=!1,this.HandleCollectableInteraction(s)):s.setPosition(t.lerp(t,i,20*e))}}},PlayerController.prototype.ProcessInputs=function(e){this.h=pc.math.lerp(this.h,0,e)},PlayerController.prototype.ProcessScale=function(e){var t=this.PlayerAnimator.getLocalScale();this.newScale.set(this.scale,this.scale,this.scale),this.PlayerAnimator.setLocalScale(t.lerp(t,this.newScale,e))},PlayerController.prototype.ProcessAlignment=function(){var e=this.RaycastPoint.getPosition();this.newAlignment.set(e.x,e.y-10,e.z);new pc.Vec3(e.x,e.y-10,e.z);var t=this.app.systems.rigidbody.raycastAll(e,this.newAlignment);for(let e=0;e<t.length;e++)if(t[e].entity.tags.has("road")){var i=t[e].point;this.RaycastDebug.setPosition(i),this.y=i.y+.85}},PlayerController.prototype.ProcessPlayerProgress=function(){if(this.canControl){var e={progress:pc.math.clamp(this.PlayerRB.getPosition().z/this.MaxBounds.z,0,1)};if(this.app.fire(Events.OnPlayerProgress,e),e.progress>=1){if(0!==this.x)return void(this.x=0);this.canControl=!1,this.app.fire(Events.OnFinishLineReached),this.app.fire("onStartMovementSound",!1),this.app.fire(Events.OnRageModeDeactivated)}else e.progress>=this.finishLineProgressVal&&(this.isFinishlineReached||(this.xWhenFinishLineReached=this.x,this.app.fire(Events.OnChangeCameraState,CameraState.Fight,5),this.app.fire(Events.OnFinishLineStarted),this.isFinishlineReached=!0),this.h=pc.math.lerp(this.finishLineProgressVal,0,(e.progress-this.finishLineProgressVal)*(1/(1-this.finishLineProgressVal))),this.x=pc.math.lerp(this.xWhenFinishLineReached,0,(e.progress-this.finishLineProgressVal)*(1/(1-this.finishLineProgressVal))*1.5))}},PlayerController.prototype.ProcessMovement=function(e){var t=this.PlayerRB.getPosition().clone();t.y=this.y;var i=this.Speed;this.canControl&&(this.z+=i),this.app.keyboard.isPressed(pc.KEY_LEFT)?this.x+=i:this.app.keyboard.isPressed(pc.KEY_RIGHT)&&(this.x-=i);var o=this.PlayerRB.getLocalEulerAngles();o.y=-60*this.h,this.PlayerRB.setLocalEulerAngles(0,o.y,0),this.thrustInput=pc.math.lerp(this.thrustInput,i,e),this.newDir.set(this.x,t.y,this.z);var a=t.lerp(t,this.newDir,7.5*e);this.PlayerRB.setPosition(a)},PlayerController.prototype.setPos=function(e){this.PlayerRB.setPosition(e.x,e.y,e.z)},PlayerController.prototype.getPunchId=function(){return this.punchID||(this.punchID=0),this.punchID++,this.punchID%=2,this.punchID},PlayerController.prototype.ProcessPunch=function(e,t){var i="";switch(e||(e=this.getPunchId()),e){case 0:i="Punch Left";break;case 1:i="Punch Right"}this.app.fire("sound:playSound","Punch_"+(Math.floor(4*Math.random())+1)),t||(t=2),this.PlayAnim(i,4);let o=this.getAnimDuration(i)/2;this.punchCoroutine&&clearTimeout(this.punchCoroutine),this.punchCoroutine=setTimeout((()=>{this.punchCoroutine=void 0,this.isDead||this.isVictorious||this.ProcessAttack()}),1e3*o)},PlayerController.prototype.ProcessAttack=function(e){this.PlayAnim("Fight Idle")},PlayerController.prototype.ProcessDeath=function(e){this.isDead=!0,this.PlayAnim("Death");this.getAnimDuration("Death");this.app.fire("sound:playSound","Fatality"),CustomCoroutine.Instance.set((()=>{this.app.fire(Events.ShakeCamera,.4,.04,.1)}),.2)},PlayerController.prototype.ProcessRevive=function(){this.isDead=!1,this.PlayAnim("Revive")},PlayerController.prototype.ProcessVictory=function(e){this.PlayAnim("Victory")},PlayerController.prototype.ProcessHurt=function(){this.app.fire(Events.ShakeCamera,this.shake.x,this.shake.y,this.shake.z),this.app.fire("MiniBoss:PlayPunchVfx"),this.PlayAnim("Hurt");let e=this.getAnimDuration("Hurt");this.punchCoroutine&&clearTimeout(this.punchCoroutine),this.punchCoroutine=setTimeout((()=>{this.punchCoroutine=void 0,this.isDead||this.ProcessAttack()}),1e3*e)},PlayerController.prototype.ProcessKick=function(){this.PlayAnim(AttachmentsHandler.kickName),this.app.fire("sound:playSound","Whoosh"),CustomCoroutine.Instance.set((()=>{this.app.fire("sound:playSound","Fatality"),this.playKickVfx()}),this.getAnimDuration(AttachmentsHandler.kickName)/2)},PlayerController.prototype.ProcessDodge=function(e){this.PlayAnim("Dodge "+e)},PlayerController.prototype.PlayAnim=function(e,t){t||(t=1),this.setAnimSpeed(t),this.PlayerAnimator.anim.baseLayer.transition(e,.1)},PlayerController.prototype.playPunchVfx=function(){this.punchVFX.fire("Play",this.vfxPositions[0].getLocalPosition())},PlayerController.prototype.playKickVfx=function(){this.punchVFX.fire("Play",this.vfxPositions[1].getLocalPosition())},PlayerController.prototype.playKickPurpleVfx=function(){this.purpleKickVFX.fire("Play",this.vfxPositions[1].getLocalPosition())},PlayerController.prototype.getAnimDuration=function(e){return this.PlayerAnimator.anim.baseLayer._controller._states[e].timelineDuration},PlayerController.prototype.setAnimSpeed=function(e){this.PlayerAnimator.anim.baseLayer.speed=e},PlayerController.prototype.DebugRevive=function(){this.app.fire(Events.OnRevivePlayer)},PlayerController.prototype.DebugAnimations=function(){this.app.keyboard.wasReleased(pc.KEY_R)&&(this.app.fire(Events.OnRageModeActivated),this.app.fire(Events.OnColorChangedRageMode,{rage:!0,color:ColorsContainer.GetColor(this.colorType)})),this.app.keyboard.wasReleased(pc.KEY_Q)&&(this.app.fire(Events.OnRageModeDeactivated),this.app.fire(Events.OnColorChangedRageMode,{rage:!1,color:ColorsContainer.GetColor(this.colorType)}))},PlayerController.prototype.onBigBossFightStarted=function(){this.bigBossFightingController.onBigBossFightStarted()},PlayerController.prototype.onBigBossTired=function(){this.bigBossFightingController.playerTurnToAttack(!0)},PlayerController.prototype.onBigBossRage=function(){this.bigBossFightingController.onBigBossRage()},PlayerController.prototype.onBigBossHit=function(e,t){this.bigBossFightingController.swipeIndex===t?(this.health-=e,this.app.fire("BigBoss:IncreasePunches"),this.app.fire("BigBoss:PlayPunchVfx"),this.health=pc.math.clamp(this.health,0,this.maxHealth),this.app.fire("FightView:SetHealth",AttackTarget.Player,this.health/this.maxHealth),GameManager.Instance.setGameSpeed(.2),this.health<=0?this.onPlayerBeaten():(this.ProcessHurt(),CustomCoroutine.Instance.set((()=>{this.isDead||this.isVictorious||this.PlayAnim("Fight Idle")}),this.getAnimDuration("Hurt")))):this.app.fire(Events.ShakeCamera,.4,.04,.1)},PlayerController.prototype.onPlayerBeaten=function(){this.ProcessDeath(!0),this.app.fire("onStartMovementSound",!1),this.PlayerAnimator.anim.setBoolean("run",!1),this.app.fire(Events.OnPlayerDead,"Boss")},PlayerController.prototype.onBonusTimeOver=function(){let e=this.bigBossFightingController.getSwipeIndex(PlayerController.dodge.right);this.bigBossFightingController.setDodgeCamera(e),GameManager.Instance.setGameSpeed(.4),this.PlayAnim(AttachmentsHandler.kickName),this.isVictorious=!0,CustomCoroutine.Instance.set((()=>{e--,e<0&&(e=3),this.bigBossFightingController.setDodgeCamera(e),this.playKickPurpleVfx(),this.app.fire(Events.ShakeCamera,.4,.04,.1),GameManager.Instance.setGameSpeed(1),this.app.fire("BigBossFighting:BossKilled")}),this.getAnimDuration(AttachmentsHandler.kickName)-.55)},PlayerController.prototype.onBigBossFightComplete=function(){this.ProcessVictory()},PlayerController.prototype.onSwipe=function(e){BiggBossFightingManager.Instance.isTutorialRequired?this.manageSwipeTutorial(e):this.bigBossFightingController.onSwipe(e)},PlayerController.prototype.manageSwipeTutorial=function(e){let t=BiggBossFightingManager.Instance.tutorial.dodgedRight,i=BiggBossFightingManager.Instance.tutorial.dodgedLeft;t?i?(this.app.fire("BigBossFighting:UpdateDodgeTutorial"),this.bigBossFightingController.onSwipe(e)):e===PlayerController.dodge.left&&(this.bigBossFightingController.onSwipe(e),this.app.fire("BigBossFighting:UpdateDodgeTutorial")):e===PlayerController.dodge.right&&(this.bigBossFightingController.onSwipe(e),this.app.fire("BigBossFighting:UpdateDodgeTutorial"))},PlayerController.prototype.onDodgePositionsRecieved=function(e){this.bigBossFightingController.setDodgePositions(e)};var ColorsContainer=pc.createScript("colorsContainer");ColorsContainer.attributes.add("Colors",{type:"json",schema:[{name:"ColorType",type:"number",enum:[{Green:0},{Blue:1},{Orange:2},{Yellow:3},{Red:4}]},{name:"Color",type:"rgb"}],array:!0}),ColorsContainer.prototype.GetColor=function(o){var r=_.findWhere(this.Colors,{ColorType:o});return r&&(r=r.Color),r},ColorsContainer.prototype.initialize=function(){ColorsContainer=this},ColorsContainer.prototype.update=function(o){};var Touch=pc.createScript("touch");Touch.prototype.initialize=function(){this.pos=new pc.Vec3,this.touchEnd=0,this.touchStart=0;var o=this.app.touch;o?(o.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),o.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),o.on(pc.EVENT_TOUCHEND,this.onTouchEnd,this),o.on(pc.EVENT_TOUCHCANCEL,this.onTouchCancel,this)):(this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this)),this.on("destroy",(function(){o.off(pc.EVENT_TOUCHSTART,this.onTouchStart,this),o.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),o.off(pc.EVENT_TOUCHEND,this.onTouchEnd,this),o.off(pc.EVENT_TOUCHCANCEL,this.onTouchCancel,this)}),this),this.lastTouchPosition=new pc.Vec2},Touch.prototype.onMouseMove=function(o){var t=o,s=this.app.mouse.isPressed(pc.MOUSEBUTTON_LEFT);const n=.03*(t.x-this.lastTouchPosition.x);s&&(this.app.fire(Events.OnTouchMove,n),this.lastTouchPosition.set(t.x,t.y))},Touch.prototype.onMouseDown=function(o){var t=o;this.lastTouchPosition.set(t.x,t.y),this.app.fire(Events.OnTouchEnd)},Touch.prototype.onMouseUp=function(o){},Touch.prototype.updateFromScreen=function(o){this.cameraEntity.camera.screenToWorld(o.x,o.y,5,this.pos)},Touch.prototype.onTouchStart=function(o){if(1===o.touches.length){var t=o.touches[0];this.lastTouchPosition.set(t.x,t.y),this.app.fire(Events.OnTouchBegin)}o.event.preventDefault(),o.event.stopPropagation()},Touch.prototype.onTouchMove=function(o){if(1==o.touches.length){var t=o.touches[0];const s=.04*(t.x-this.lastTouchPosition.x);this.app.fire(Events.OnTouchMove,s),this.lastTouchPosition.set(t.x,t.y)}o.event.preventDefault()},Touch.prototype.onTouchEnd=function(o){if(1===o.touches.length){var t=o.touches[0];this.lastTouchPosition.set(t.x,t.y)}this.app.fire(Events.OnTouchEnd),o.event.preventDefault()},Touch.prototype.onTouchCancel=function(o){o.touches.length,o.event.preventDefault()};var MenuManager=pc.createScript("menuManager");MenuManager.attributes.add("progressionButton",{type:"entity"}),MenuManager.attributes.add("allPanels",{type:"json",schema:[{name:"overlay",type:"boolean"},{name:"panel",type:"entity"}],array:!0}),MenuManager.States={Home:0,Gameplay:1,Settings:2,GameplayMessage:3,BossFight:4,Win:5,Lose:6,LoseObstacle:7,BlankScreen:8,BonusView:9,ShopView:10,ChestRoom:11,CloseOverlay:-1,SkinUnlockedView:12,LooksGoodView:13,RageRvView:14},MenuManager.prototype.initialize=function(){MenuManager.Instance=this,this.prevState=null,this.currentState=MenuManager.States.Home,this.currentOverlays=[],this.changeState(MenuManager.States.Home),this.progressionButton.button.on("click",this.OnProgressionBtbClicked,this),this.on("destroy",this.onDestroy,this),this.app.on("changeMenuState",this.changeState,this)},MenuManager.prototype.OnProgressionBtbClicked=function(e){this.app.fire(Events.OnDebugProgression)},MenuManager.prototype.onDestroy=function(){this.app.off("changeMenuState",this.changeState,this)},MenuManager.prototype.update=function(e){},MenuManager.prototype.changeState=function(e){if(Debug.log("changeState",e),this.currentState!==e&&!this.manageOverlayState(e)){this.prevState=this.currentState,this.currentState=e;var t=this.allPanels[this.prevState].panel,a=this.allPanels[this.currentState].panel;t.fire("disable",(()=>{a.enabled=!0}))}},MenuManager.prototype.manageOverlayState=function(e){return this.currentOverlays.length>0&&e===MenuManager.States.CloseOverlay?(this.allPanels[this.currentOverlays.pop()].panel.fire("disable"),!0):(this.allPanels[e].overlay&&(this.allPanels[e].panel.enabled=!0,this.currentOverlays.push(e)),this.allPanels[e].overlay)};var HomeMenuEventListner=pc.createScript("homeMenuEventListner");HomeMenuEventListner.attributes.add("homeBtns",{type:"json",title:"Home Menu Buttons",schema:[{name:"settingsBtn",title:"Settings Button",type:"entity"},{name:"startBtn",title:"Start Button",type:"entity"},{name:"rageBtn",type:"entity"},{name:"shopBtn",type:"entity"},{name:"upgradeKickBtn",type:"entity"},{name:"upgradeMultiBtn",type:"entity"},{name:"currentGemsTxt",type:"entity"},{name:"fbTournyBtn",type:"entity"}]}),HomeMenuEventListner.attributes.add("upgradeItems",{title:"Upgrade Item Views",type:"json",schema:[{name:"kickLevelView",title:"Kick Level View",type:"entity"},{name:"multiplierLevelView",title:"Multiplier Level View",type:"entity"}]}),HomeMenuEventListner.attributes.add("inviteBar",{title:"Snap Invite Bar",type:"json",schema:[{name:"inviteBtn",title:"Invite Btn",type:"entity"},{name:"addFriendsBtns",title:"Add Friends Btns",type:"entity",array:!0},{name:"addFriendsBtnsTexts",title:"Add Friends Btns Texts",type:"entity",array:!0},{name:"addFriendsBtnsImg",title:"Add Friends Btns Img",type:"entity",array:!0},{name:"selfAvatarImg",title:"avatarImg",type:"entity"}]}),HomeMenuEventListner.instance=null,HomeMenuEventListner.prototype.initialize=function(){HomeMenuEventListner.instance=this,this.loadingAdScreen=this.app.root.findByName("Loading Ad Screen"),this.initEvents()},HomeMenuEventListner.prototype.postInitialize=function(){this.onEnable()},HomeMenuEventListner.prototype.initEvents=function(){this.homeBtns.settingsBtn.button.on("click",this.onSettingsBtnClicked,this),this.homeBtns.startBtn.button.on("click",this.onStartBtnClicked,this),this.homeBtns.upgradeKickBtn.button.on("click",this.onKickUpgradeBtnClicked,this),this.homeBtns.upgradeMultiBtn.button.on("click",this.onMultiplierUpgradeBtnClicked,this),this.homeBtns.shopBtn.button.on("click",this.onShopBtnClicked,this),this.homeBtns.rageBtn.button.on("click",this.onRageBtnClicked,this),this.homeBtns.fbTournyBtn.button.on("click",this.onfbTournyBtnClicked,this),this.app.on("SC:setAvatarTexture",this.onSetAvatarTexture,this),this.on("destroy",this.onDestroy,this),this.on("enable",this.onEnable,this),this.app.on(Events.OnLevelLoaded,this.OnLevelLoaded,this),this.app.on(Events.OnRageRvCompleted,this.OnRageRvCompleted,this)},HomeMenuEventListner.prototype.onfbTournyBtnClicked=function(){this.app.fire("onTournamentBtnClick")},HomeMenuEventListner.prototype.OnRageRvCompleted=function(){this.onStartBtnClicked();let e=this,t=MenuManager.Instance.allPanels[MenuManager.States.Gameplay].panel.script.gameMenuEventListner;Debug.log(MenuManager.Instance.allPanels[MenuManager.States.Gameplay]),Debug.log("GameMenu: ",t),setTimeout((function(){e.app.fire(Events.OnRageModeActivated),t.ActivateRageMode()}),100)},HomeMenuEventListner.prototype.onRageBtnClicked=function(){this.app.fire("changeMenuState",MenuManager.States.RageRvView)},HomeMenuEventListner.prototype.OnLevelLoaded=function(){this.app.fire("GemsMenu:UpdateGems",DataManager.Instance.gems)},HomeMenuEventListner.prototype.onEnable=function(){this.app.fire("GemsMenu:EnableCounterView",!0),this.app.fire("GemsMenu:UpdateGems",DataManager.Instance.gems),this.updateKickLevelView(),this.updateMultiplierLevelView()},HomeMenuEventListner.prototype.onDestroy=function(){this.homeBtns.settingsBtn.button.off("click",this.onSettingsBtnClicked,this),this.homeBtns.startBtn.button.off("click",this.onStartBtnClicked,this)},HomeMenuEventListner.prototype.onSetAvatarTexture=function(){this.inviteBar.selfAvatarImg.element.texture=ScManager.instance.avatarTexture},HomeMenuEventListner.prototype.onStartBtnClicked=function(){if(ConfigManager.instance.environmentType===ConfigManager.EnvTypes.None)this.startGame();else if(ConfigManager.instance.environmentType===ConfigManager.EnvTypes.Gamedistribution){this.loadingAdScreen.enabled=!0;const e=HomeMenuEventListner.instance.onResume.bind(this),t=HomeMenuEventListner.instance.onPause.bind(this);this.app.fire("showSimpleAD",e,t)}else this.startGame()},HomeMenuEventListner.prototype.startGame=function(){this.app.fire("changeMenuState",MenuManager.States.Gameplay),this.app.fire(Events.OnStartGame,!0),this.app.fire("fadeOutGameMessage"),this.app.fire("GemsMenu:EnableCounterView",!1)},HomeMenuEventListner.prototype.onResume=function(){this.loadingAdScreen.enabled=!1,this.startGame()},HomeMenuEventListner.prototype.onPause=function(){this.loadingAdScreen.enabled=!0},HomeMenuEventListner.prototype.onKickUpgradeBtnClicked=function(){DataManager.Instance.upgradeKickLevel()||this.manageAd(!0),this.app.fire("GemsMenu:UpdateGems",DataManager.Instance.gems,!0),this.updateKickLevelView(),this.app.fire(Events.OnUpgradeKick,DataManager.Instance.kickLevel)},HomeMenuEventListner.prototype.onMultiplierUpgradeBtnClicked=function(){this.app.fire("onUpgradeMultiplier"),DataManager.Instance.upgradeMultiplierLevel()||this.manageAd(),this.app.fire("GemsMenu:UpdateGems",DataManager.Instance.gems,!0),this.updateMultiplierLevelView()},HomeMenuEventListner.prototype.onSettingsBtnClicked=function(){this.app.fire("changeMenuState",MenuManager.States.Settings)},HomeMenuEventListner.prototype.playSound=function(e){this.app.fire("sound:playSound",e)},HomeMenuEventListner.prototype.updateKickLevelView=function(){let e=DataManager.Instance.kickLevel,t=Settings.upgrade.getKickPrice(e+1);this.upgradeItems.kickLevelView.script.upgradeItemView.updateView("Lvl "+e.toFixed(0),t)},HomeMenuEventListner.prototype.updateMultiplierLevelView=function(){let e=DataManager.Instance.multiplierLevel,t=Settings.upgrade.getMultiplier(e),n=Settings.upgrade.getMultiplierPrice(e+1);this.upgradeItems.multiplierLevelView.script.upgradeItemView.updateView("X "+t.toFixed(1),n)},HomeMenuEventListner.prototype.onShopBtnClicked=function(){this.app.fire("changeMenuState",MenuManager.States.ShopView)},HomeMenuEventListner.prototype.update=function(e){},HomeMenuEventListner.prototype.manageAd=function(e){if(ConfigManager.instance.environmentType!==ConfigManager.EnvTypes.None){const t=e?HomeMenuEventListner.instance.resumeGiveKickLevelReward.bind(this):HomeMenuEventListner.instance.resumeGiveMultiplierLevelReward.bind(this),n=HomeMenuEventListner.instance.pauseGame.bind(this),i=HomeMenuEventListner.instance.resumeNoReward.bind(this),a=HomeMenuEventListner.instance.adNotAvailable.bind(this);this.app.fire("showRewardedAD",t,n,i,a)}else e?this.resumeGiveKickLevelReward():this.resumeGiveMultiplierLevelReward()},HomeMenuEventListner.prototype.onRewardSuccess=function(){Debug.log("HomeMenuEventListner.onRewardSuccess()"),this.app.fire("Enable:Loading",!1)},HomeMenuEventListner.prototype.onRewardFailed=function(){this.app.fire("Enable:Loading",!1),Debug.error("HomeMenuEventListner.onRewardFailed()")},HomeMenuEventListner.prototype.resumeGiveKickLevelReward=function(){this.app.fire("Enable:Loading",!1),DataManager.Instance.upgradeKickLevel(!0)},HomeMenuEventListner.prototype.resumeGiveMultiplierLevelReward=function(){this.app.fire("Enable:Loading",!1),DataManager.Instance.upgradeMultiplierLevel(!0)},HomeMenuEventListner.prototype.pauseGame=function(){this.app.fire("Enable:Loading",!0)},HomeMenuEventListner.prototype.resumeNoReward=function(){this.app.fire("adSkippedPopup"),this.onRewardFailed()},HomeMenuEventListner.prototype.adNotAvailable=function(){this.app.fire("noAdPopup"),this.onRewardFailed()};var GameMenuEventListner=pc.createScript("gameMenuEventListner");GameMenuEventListner.attributes.add("incrementGems",{type:"number",default:.05}),GameMenuEventListner.attributes.add("incrementMobs",{type:"number",default:.025}),GameMenuEventListner.attributes.add("gameMenuComponents",{type:"json",title:"Menu Components",schema:[{name:"charImg",title:"Character image ref",type:"entity"},{name:"charVal",title:"Character value ref",type:"entity"},{name:"gemVal",title:"Gem value ref",type:"entity"},{name:"keyVal",title:"Key value ref",type:"entity"},{name:"progressBar",title:"Progress bar ref",type:"entity"},{name:"crownTriggerWidth",title:"CrownTrigWidth",type:"number"},{name:"rageFiller",title:"RageFiller",type:"asset"}]}),GameMenuEventListner.attributes.add("plusText",{type:"entity"}),GameMenuEventListner.instance=null,GameMenuEventListner.prototype.initialize=function(){GameMenuEventListner.instance=this,this.app.on(Events.OnCollectablePicked,this.onCollectablePicked,this),this.currentMobsHit=0,this.currentGems=0,this.currentKeys=0,this.rageMode=!1,this.totalMobsInLevel=5,this.reset(),this.on("enable",this.reset,this),this.on("destroy",this.onDestroy,this),this.gameMenuComponents.rageFiller=this.gameMenuComponents.rageFiller.resources[0]},GameMenuEventListner.prototype.reset=function(){this.gameMenuComponents.progressBar.element.width=0,this.gameMenuComponents.gemVal.element.text=0,this.gameMenuComponents.charVal.element.text=0,this.currentMobsHit=0,this.currentGems=0,this.rageMode=!1,this.gameMenuComponents.rageFiller.alphaTest=1,this.currentKeys=ChestRoomManager.keys,this.gameMenuComponents.keyVal.element.text=this.currentKeys},GameMenuEventListner.prototype.onDestroy=function(){this.app.off(Events.OnCollectablePicked,this.onCollectablePicked,this),this.app.off(Events.OnPlayerProgress,this.onPlayerProgress,this),this.on("destroy",this.onDestroy,this)},GameMenuEventListner.prototype.onCollectablePicked=function(e){switch(e.type){case 3:this.currentKeys++,this.gameMenuComponents.keyVal.element.text=this.currentKeys;break;case 4:this.gameMenuComponents.charImg.element.color=ColorsContainer.GetColor(ColorType.Green),this.app.fire("sound:playSound","Color_changing");break;case 5:this.gameMenuComponents.charImg.element.color=ColorsContainer.GetColor(ColorType.Orange),this.app.fire("sound:playSound","Color_changing");break;case 7:this.gameMenuComponents.charImg.element.color=ColorsContainer.GetColor(ColorType.Yellow),this.app.fire("sound:playSound","Color_changing");break;case 8:this.gameMenuComponents.charImg.element.color=ColorsContainer.GetColor(ColorType.Blue),this.app.fire("sound:playSound","Color_changing");break;case 0:case 1:case 6:case 9:e.isValidColor?(this.plusTextTimout&&clearTimeout(this.plusTextTimout),this.plusText.enabled=!0,this.plusTextTimout=setTimeout((()=>{this.plusText.enabled=!1}),300),this.app.fire("sound:playSound","Mob_hit"),this.app.fire("onCorrectMobHit"),this.currentMobsHit++,!this.rageMode&&TutorialManager.instance.isLevelTutorial&&(this.gameMenuComponents.rageFiller.alphaTest=pc.math.clamp(this.gameMenuComponents.rageFiller.alphaTest-1/(LevelInfo.isBonusLevel?LevelInfo.gemsCount/5:LevelInfo.mobsCount),0,1),Debug.log(TutorialManager.instance.isLevelTutorial))):(this.app.fire("onInCorrectMobHit"),this.app.fire("sound:playSound","Mob_wrong_hit"),this.currentMobsHit--),this.gameMenuComponents.charVal.element.text=this.currentMobsHit,this.updateProgressBar();break;case 2:!this.rageMode&&TutorialManager.instance.isLevelTutorial&&(this.gameMenuComponents.rageFiller.alphaTest=pc.math.clamp(this.gameMenuComponents.rageFiller.alphaTest-1/(LevelInfo.isBonusLevel?LevelInfo.gemsCount/5:LevelInfo.mobsCount),0,1)),this.app.fire("sound:playSound","Gem_collected"),this.currentGems++,this.gameMenuComponents.gemVal.element.text=this.currentGems;break;case CollectableType.BreakableWall:LevelInfo.isBonusLevel||(this.currentMobsHit-=3,Debug.log("wall"),this.currentMobsHit<=0&&(this.currentMobsHit=0,this.app.fire(Events.OnHealthChanged,{health:0,target:AttackTarget.Player,reason:"Obstacle"})),this.gameMenuComponents.charVal.element.text=this.currentMobsHit,this.updateProgressBar(),this.gameMenuComponents.progressBar.element.width=changeRange(this.currentMobsHit,0,LevelInfo.mobsCount,0,605));break;case CollectableType.Lava:this.currentMobsHit-=1,this.currentMobsHit<=0&&(this.currentMobsHit=0),this.gameMenuComponents.charVal.element.text=this.currentMobsHit,this.updateProgressBar()}this.gameMenuComponents.rageFiller.alphaTest<=0&&(this.ActivateRageMode(),this.app.fire(Events.OnRageModeActivated))},GameMenuEventListner.prototype.ActivateRageMode=function(){this.rageMode=!0,this.gameMenuComponents.rageFiller.alphaTest=0},GameMenuEventListner.prototype.update=function(e){this.gameMenuComponents.rageFiller.alphaTest>=1&&this.rageMode?(this.rageMode=!1,this.app.fire(Events.OnRageModeDeactivated),this.gameMenuComponents.rageFiller.alphaTest=1):this.rageMode&&(this.gameMenuComponents.rageFiller.alphaTest=pc.math.clamp(this.gameMenuComponents.rageFiller.alphaTest+.1*e,0,1))},GameMenuEventListner.prototype.updateProgressBar=function(){let e=this.gameMenuComponents.progressBar.element.width,t=changeRange(this.currentMobsHit,0,LevelInfo.mobsCount,0,605);this.progressBaarTween&&TweenWrapper.StopTween(this.progressBaarTween),this.progressBaarTween=TweenWrapper.TweenNumber(e,t,.25,(e=>{this.gameMenuComponents.progressBar.element.width=e.number,this.updateCrownState()}),(()=>{this.gameMenuComponents.progressBar.element.width=t}))},GameMenuEventListner.prototype.updateCrownState=function(){this.gameMenuComponents.progressBar.element.width>=this.gameMenuComponents.crownTriggerWidth?this.app.fire(Events.OnSetCrownState,!0):this.app.fire(Events.OnSetCrownState,!1)};var SettingsMenuEventListner=pc.createScript("settingsMenuEventListner");SettingsMenuEventListner.attributes.add("settingBtns",{type:"json",title:"Setting Buttons",schema:[{name:"closeBtn",title:"close Button",type:"entity"}]}),SettingsMenuEventListner.prototype.initialize=function(){this.initEvents()},SettingsMenuEventListner.prototype.initEvents=function(){this.settingBtns.closeBtn.button.on("click",this.onCloseBtnClicked,this),this.on("destroy",this.onDestroy,this)},SettingsMenuEventListner.prototype.onDestroy=function(){this.settingBtns.closeBtn.button.off("click",this.onCloseBtnClicked,this)},SettingsMenuEventListner.prototype.onCloseBtnClicked=function(){this.app.fire("changeMenuState",MenuManager.States.CloseOverlay)},SettingsMenuEventListner.prototype.update=function(t){};var SoundManager=pc.createScript("soundManager");SoundManager.attributes.add("soundButton",{type:"entity"}),SoundManager.attributes.add("soundSprite",{type:"entity"}),SoundManager.attributes.add("soundSpriteCheck",{type:"asset"}),SoundManager.attributes.add("soundSpriteUncheck",{type:"asset"}),SoundManager.prototype.initialize=function(){this.app.on("sound:playSound",this.playSound.bind(this)),this.app.on("sound:pauseSound",this.pauseSound.bind(this)),this.app.on("sound:stopSound",this.stopSound.bind(this)),this.app.on("sound:resumeSound",this.resumeSound.bind(this)),this.app.on("sound:muteGameSound",this.muteGameSound.bind(this)),this.soundButton.button.on("click",this.onSoundBtnClick,this),this.on("destroy",function(){this.app.off("sound:playSound"),this.app.off("sound:pauseSound"),this.app.off("sound:stopSound"),this.app.off("sound:resumeSound"),this.app.off("sound:muteGameSound"),this.soundButton.button.off("click",this.onSoundBtnClick,this)}.bind(this))},SoundManager.prototype.onSoundBtnClick=function(){this.isMuteSound=!this.isMuteSound,this.muteGameSound(this.isMuteSound)},SoundManager.prototype.postInitialize=function(){if(isLSAvailable)if(null===localStorage.getItem("GR_SOUND"))localStorage.setItem("GR_SOUND",JSON.stringify("disable")),this.muteGameSound(!1),this.isMuteSound=!1;else{let t=localStorage.getItem("GR_SOUND");sound=JSON.parse(t),Debug.log(sound),"disable"===sound?(this.isMuteSound=!1,this.muteGameSound(!1)):(this.isMuteSound=!0,this.muteGameSound(!0))}},SoundManager.prototype.playSound=function(t,o){o&&o>0?setTimeout((()=>{this.entity.sound.slot(t).play()}),1e3*o):this.entity.sound.slot(t).play()},SoundManager.prototype.pauseSound=function(t){this.entity.sound.slot(t).pause()},SoundManager.prototype.stopSound=function(t){Debug.log("stopSound: ",t),this.entity.sound.slot(t).stop()},SoundManager.prototype.resumeSound=function(t){this.entity.sound.slot(t).resume()},SoundManager.prototype.setSoundVolume=function(t,o){this.entity.sound.slot(t).volume=o},SoundManager.prototype.muteGameSound=function(t){this.entity.sound.volume=t?0:1},SoundManager.prototype.muteGameSound=function(t){this.isMuteSound=t,t?(this.entity.sound.volume=0,isLSAvailable&&localStorage.setItem("GR_SOUND",JSON.stringify("enable")),this.soundSprite.element.sprite=this.soundSpriteUncheck.resource):(this.entity.sound.volume=1,isLSAvailable&&localStorage.setItem("GR_SOUND",JSON.stringify("disable")),this.soundSprite.element.sprite=this.soundSpriteCheck.resource)};var PlayerStepsSoundHandler=pc.createScript("playerStepsSoundHandler");PlayerStepsSoundHandler.prototype.initialize=function(){this.app.on("onStartMovementSound",this.onStartMovementSound,this),this.soundRunning=!1,this.isSoundFinished=!1,this.currentSoundInstance=null},PlayerStepsSoundHandler.prototype.onStartMovementSound=function(n){this.soundRunning=n,this.handleSound()},PlayerStepsSoundHandler.prototype.handleSound=function(){if(this.soundRunning){if(null===this.currentSoundInstance){let n=this.getRandomSoundName();this.currentSoundInstance=this.entity.sound.slot("Step_"+n).play()}}else this.currentSoundInstance&&this.currentSoundInstance.stop(),this.currentSoundInstance=null},PlayerStepsSoundHandler.prototype.runNextSound=function(){if(this.soundRunning){let n=this.getRandomSoundName();this.currentSoundInstance=this.entity.sound.slot("Step_"+n).play()}},PlayerStepsSoundHandler.prototype.getRandomSoundName=function(){return Math.floor(5*Math.random())+1},PlayerStepsSoundHandler.prototype.update=function(n){this.currentSoundInstance&&(this.currentSoundInstance.isPlaying||this.runNextSound())};var CameraController=pc.createScript("cameraController");CameraController.attributes.add("player",{type:"entity"}),CameraController.attributes.add("target",{type:"entity"}),CameraController.attributes.add("shakeTarget",{type:"entity"}),CameraController.attributes.add("shakeTesting",{type:"json",title:"Shake Testing",schema:[{name:"duration",type:"number",title:"Duration"},{name:"shakeInterval",type:"number",title:"Shake Interval"},{name:"maxShakeDistance",type:"number",title:"Max Shake Distance"}]}),CameraController.attributes.add("states",{type:"json",schema:[{name:"stateType",type:"number",enum:[{Mainmenu:0},{Gameplay:1},{Fight:2},{Flight:3},{End:4},{Wall:5},{WallBreak:6},{Dodge1:7},{Dodge2:8},{Dodge3:9},{Dodge4:10},{Dead:11}]},{name:"refTransform",type:"entity"},{name:"followRotation",type:"boolean"},{name:"lookAtPlayer",type:"boolean"},{name:"lookAtOffset",type:"vec3"}],array:!0}),CameraController.prototype.initialize=function(){this.time=1e3,this.duration=0,this.shakeTarget=this.shakeTarget||this.entity,this.offset=this.entity.getPosition().clone(),this.app.on(Events.OnChangeCameraState,this.OnChangeCameraState,this),this.app.on(Events.ShakeCamera,this.shake,this),this.pos=this.entity.getLocalPosition(),this.rot=this.entity.getLocalEulerAngles(),this.speed=5,this.endPos=new pc.Vec3(0,0,0),this.OnChangeCameraState(CameraState.Mainmenu,5,!0)},CameraController.prototype.OnChangeCameraState=function(t,e,a,s){let i=_.findWhere(this.states,{stateType:t});Debug.log("OnChangeCameraState: ",t,e,a),i&&(this.pos=i.refTransform.getPosition().clone(),i.followRotation&&(this.rot=i.refTransform.getEulerAngles().clone()),this.target=i.refTransform,this.state=i,this.speed=e,this.instant=a)},CameraController.prototype.DebugStates=function(){this.app.keyboard.wasPressed(pc.KEY_1)&&this.OnChangeCameraState(0,5),this.app.keyboard.wasPressed(pc.KEY_2)&&this.OnChangeCameraState(1,5),this.app.keyboard.wasPressed(pc.KEY_3)&&this.OnChangeCameraState(2,5),this.app.keyboard.wasPressed(pc.KEY_4)&&this.OnChangeCameraState(3,5),this.app.keyboard.wasPressed(pc.KEY_5)&&this.OnChangeCameraState(4,5),this.app.keyboard.wasPressed(pc.KEY_6)&&this.OnChangeCameraState(5,5),this.app.keyboard.wasPressed(pc.KEY_7)&&this.OnChangeCameraState(6,5),this.app.keyboard.wasPressed(pc.KEY_W)&&this.OnChangeCameraState(7,5),this.app.keyboard.wasPressed(pc.KEY_A)&&this.OnChangeCameraState(8,5),this.app.keyboard.wasPressed(pc.KEY_X)&&this.OnChangeCameraState(9,5),this.app.keyboard.wasPressed(pc.KEY_D)&&this.OnChangeCameraState(10,5),this.app.keyboard.wasPressed(pc.KEY_9)&&this.shake(this.shakeTesting.maxShakeDistance,this.shakeTesting.shakeInterval,this.shakeTesting.duration)},CameraController.prototype.update=function(t){this.time>=this.duration&&this.updateFollow(t),this.updateShake(t)},CameraController.prototype.updateFollow=function(t){if(this.target){this.pos=this.target.getPosition().clone();let e=this.entity.getPosition();if(this.instant?this.entity.setPosition(this.pos):this.entity.setPosition(e.lerp(e,this.pos,t*this.speed)),this.state.followRotation){let e=this.entity.getEulerAngles();if(this.instant)this.entity.setEulerAngles(this.rot);else{let a=pc.math.lerp(e.x,this.rot.x,t*this.speed),s=pc.math.lerp(e.y,this.rot.y,t*this.speed),i=pc.math.lerp(e.z,this.rot.z,t*this.speed);this.entity.setEulerAngles(a,s,i)}}if(this.state.lookAtPlayer){let t=this.player.script.playerController.PlayerRB.getPosition(),e=t.x+this.state.lookAtOffset.x,a=t.y+this.state.lookAtOffset.y,s=t.z+this.state.lookAtOffset.z;this.entity.lookAt(e,a,s)}}},CameraController.prototype.updateShake=function(t){if(this.time+=t,this.time<this.duration&&(this.timeSinceLastShake+=t,this.timeSinceLastShake>=this.shakeInterval)){let t=1-pc.math.clamp(this.time/this.duration,0,1),e=2*Math.PI*pc.math.random(0,1),a=pc.math.random(0,this.maxShakeDistance)*t+pc.math.random(0,this.maxShakeDistance)*t,s=a>1?2-a:a,i=s*Math.cos(e),n=s*Math.sin(e),h=s*Math.tan(e);this.endPos.set(this.startPosition.x+i,this.startPosition.y+n,this.startPosition.z+h),this.shakeTween&&TweenWrapper.StopTween(this.shakeTween),this.shakeTween=TweenWrapper.Tween(this.shakeTarget,this.shakeTarget.getLocalPosition(),this.endPos,this.shakeInterval),this.timeSinceLastShake-=this.shakeInterval}},CameraController.prototype.shake=function(t,e,a){if(this.time<this.duration)return;this.duration=t,this.shakeInterval=e,this.maxShakeDistance=a;let s=this.shakeTarget.getLocalPosition();this.startPosition||(this.startPosition=new pc.Vec3),this.startPosition.set(s.x,s.y,s.z),this.time=0,this.timeSinceLastShake=0};var Mover=pc.createScript("mover");Mover.attributes.add("Target",{type:"entity"}),Mover.attributes.add("Loop",{type:"boolean"}),Mover.attributes.add("Yoyo",{type:"boolean",default:!0}),Mover.attributes.add("Duration",{type:"number"}),Mover.attributes.add("StartPosition",{type:"vec3"}),Mover.attributes.add("EndPosition",{type:"vec3"}),Mover.attributes.add("Ease",{type:"string",default:"Linear",enum:[{Linear:"Linear"},{QuadraticIn:"QuadraticIn"},{QuadraticOut:"QuadraticOut"},{QuadraticInOut:"QuadraticInOut"},{CubicIn:"CubicIn"},{CubicOut:"CubicOut"},{CubicInOut:"CubicInOut"},{QuarticIn:"QuarticIn"},{QuarticOut:"QuarticOut"},{QuarticInOut:"QuarticInOut"},{QuinticIn:"QuinticIn"},{QuinticOut:"QuinticOut"},{QuinticInOut:"QuinticInOut"},{SineIn:"SineIn"},{SineOut:"SineOut"},{SineInOut:"SineInOut"},{ExponentialIn:"ExponentialIn"},{ExponentialOut:"ExponentialOut"},{ExponentialInOut:"ExponentialInOut"},{CircularIn:"CircularIn"},{CircularOut:"CircularOut"},{CircularInOut:"CircularInOut"},{BackIn:"BackIn"},{BackOut:"BackOut"},{BackInOut:"BackInOut"},{BounceIn:"BounceIn"},{BounceOut:"BounceOut"},{BounceInOut:"BounceInOut"},{ElasticIn:"ElasticIn"},{ElasticOut:"ElasticOut"},{ElasticInOut:"ElasticInOut"}]}),Mover.prototype.initialize=function(){this.Target.setLocalPosition(this.StartPosition);var t=this.EndPosition,i=this.Loop,n=this.Yoyo,u=this.Duration,a=this.Target,e=this.Ease;this.tween=this.app.tween(a.getLocalPosition()).to(t,u,pc[e]).loop(i).yoyo(n).start()},Mover.prototype.Activate=function(){this.tween.start()},Mover.prototype.Deactivate=function(){this.tween.stop()};var Rotar=pc.createScript("rotar");Rotar.attributes.add("Target",{type:"entity"}),Rotar.attributes.add("Loop",{type:"boolean"}),Rotar.attributes.add("YoYo",{type:"boolean",default:!0}),Rotar.attributes.add("Duration",{type:"number"}),Rotar.attributes.add("Delay",{type:"number",default:0}),Rotar.attributes.add("StartEuler",{type:"vec3"}),Rotar.attributes.add("EndEuler",{type:"vec3"}),Rotar.attributes.add("Ease",{type:"string",default:"Linear",enum:[{Linear:"Linear"},{QuadraticIn:"QuadraticIn"},{QuadraticOut:"QuadraticOut"},{QuadraticInOut:"QuadraticInOut"},{CubicIn:"CubicIn"},{CubicOut:"CubicOut"},{CubicInOut:"CubicInOut"},{QuarticIn:"QuarticIn"},{QuarticOut:"QuarticOut"},{QuarticInOut:"QuarticInOut"},{QuinticIn:"QuinticIn"},{QuinticOut:"QuinticOut"},{QuinticInOut:"QuinticInOut"},{SineIn:"SineIn"},{SineOut:"SineOut"},{SineInOut:"SineInOut"},{ExponentialIn:"ExponentialIn"},{ExponentialOut:"ExponentialOut"},{ExponentialInOut:"ExponentialInOut"},{CircularIn:"CircularIn"},{CircularOut:"CircularOut"},{CircularInOut:"CircularInOut"},{BackIn:"BackIn"},{BackOut:"BackOut"},{BackInOut:"BackInOut"},{BounceIn:"BounceIn"},{BounceOut:"BounceOut"},{BounceInOut:"BounceInOut"},{ElasticIn:"ElasticIn"},{ElasticOut:"ElasticOut"},{ElasticInOut:"ElasticInOut"}]}),Rotar.prototype.initialize=function(){this.deltaTime=0,this.Target.setLocalEulerAngles(this.StartEuler),this.defaultStart=this.StartEuler,this.defaultEnd=this.EndEuler,this.Play()},Rotar.prototype.Play=function(){var t=this.StartEuler.clone(),a=this.EndEuler.clone(),u=this.Loop,n=this.YoYo,i=this.Duration,e=this.Target,r=this.Delay,o=this.Ease;this.tween=this.app.tween(t).to(a,i,pc[o]).delay(r).loop(u).yoyo(n).on("update",(function(){e.setLocalEulerAngles(t)})).start()},Rotar.prototype.Stop=function(){this.tween.stop();var t=this.Target.getLocalEulerAngles(),a=this.defaultStart,u=this.Target;this.app.tween(t).to(a,.5,pc.Linear).on("update",(function(){u.setLocalEulerAngles(t)})).start()},Rotar.prototype.update=function(t){};var ColorMixer=pc.createScript("colorMixer");ColorMixer.attributes.add("Target",{type:"entity"}),ColorMixer.attributes.add("Loop",{type:"boolean"}),ColorMixer.attributes.add("YoYo",{type:"boolean",default:!0}),ColorMixer.attributes.add("Duration",{type:"number"}),ColorMixer.attributes.add("StartColor",{type:"rgb"}),ColorMixer.attributes.add("EndColor",{type:"rgb"}),ColorMixer.attributes.add("Ease",{type:"string",default:"Linear",enum:[{Linear:"Linear"},{QuadraticIn:"QuadraticIn"},{QuadraticOut:"QuadraticOut"},{QuadraticInOut:"QuadraticInOut"},{CubicIn:"CubicIn"},{CubicOut:"CubicOut"},{CubicInOut:"CubicInOut"},{QuarticIn:"QuarticIn"},{QuarticOut:"QuarticOut"},{QuarticInOut:"QuarticInOut"},{QuinticIn:"QuinticIn"},{QuinticOut:"QuinticOut"},{QuinticInOut:"QuinticInOut"},{SineIn:"SineIn"},{SineOut:"SineOut"},{SineInOut:"SineInOut"},{ExponentialIn:"ExponentialIn"},{ExponentialOut:"ExponentialOut"},{ExponentialInOut:"ExponentialInOut"},{CircularIn:"CircularIn"},{CircularOut:"CircularOut"},{CircularInOut:"CircularInOut"},{BackIn:"BackIn"},{BackOut:"BackOut"},{BackInOut:"BackInOut"},{BounceIn:"BounceIn"},{BounceOut:"BounceOut"},{BounceInOut:"BounceInOut"},{ElasticIn:"ElasticIn"},{ElasticOut:"ElasticOut"},{ElasticInOut:"ElasticInOut"}]}),ColorMixer.prototype.initialize=function(){var t=this.StartColor,i=this.EndColor,n=this.Loop,u=this.YoYo,a=this.Duration,e=this.Ease,r=this.Target.render.meshInstances[0].material.clone();this.Target.render.meshInstances[0].material=r,this.tween=this.app.tween(t).to(i,a,pc[e]).loop(n).yoyo(u).on("update",(function(){r.diffuse=t,r.update()})).start()},ColorMixer.prototype.Activate=function(){this.tween.start()},ColorMixer.prototype.Deactivate=function(){this.tween.stop()};var Trigger=pc.createScript("trigger");Trigger.attributes.add("EnableEntity",{type:"entity"}),Trigger.attributes.add("DisableEntity",{type:"entity"}),Trigger.attributes.add("Targets",{type:"json",schema:[{name:"Action",type:"number",enum:[{Enable:0},{Disable:1}]},{name:"Target",type:"entity"},{name:"Component",type:"string"}],array:!0}),Trigger.prototype.initialize=function(){},Trigger.prototype.Fire=function(){for(let t=0;t<this.Targets.length;t++){let e=this.Targets[t],i=null;if(e.Target.script){let t=e.Target.script.get(e.Component);switch(e.Action){case Action.Enable:null!=t&&t.Play();break;case Action.Disable:null!=t&&t.Stop()}}switch(e.Action){case Action.Enable:this.EnableEntity&&(this.EnableEntity.enabled=!0),this.DisableEntity&&(this.DisableEntity.enabled=!1),i||(i=e.Target.c[e.Component]),i?i.enabled=!0:e.Target.enabled=!0;break;case Action.Disable:this.EnableEntity&&(this.EnableEntity.enabled=!1),this.DisableEntity&&(this.DisableEntity.enabled=!0),i||(i=e.Target.c[e.Component],i?i.enabled=!1:e.Target.enabled=!1)}}this.entity.fire("setLabel")},Trigger.prototype.update=function(t){};var ObstacleObject=pc.createScript("obstacleObject");ObstacleObject.prototype.initialize=function(){},ObstacleObject.prototype.update=function(t){};var ObstacleInfo=pc.createScript("obstacleInfo");ObstacleInfo.attributes.add("label",{type:"entity",title:"Label"}),ObstacleInfo.prototype.initialize=function(){this.entity.on("setLabel",this.setLabel,this),this.onEnable(),this.on("enable",this.onEnable,this)},ObstacleInfo.prototype.onEnable=function(){this.label&&(this.label.enabled=!1)},ObstacleInfo.prototype.update=function(t){},ObstacleInfo.prototype.setLabel=function(t){this.label&&(this.label.enabled=!!t,this.label.enabled&&(this.label.element.text=t))};var PlaceIncircle=pc.createScript("placeIncircle");PlaceIncircle.attributes.add("radius",{type:"number"}),PlaceIncircle.prototype.initialize=function(){var e=this.entity.children,t=this.entity.getPosition().clone(),c=this.radius,i=this;setTimeout((function(){i.PlaceObjectsInCircle(e,t,c)}),1e3)},PlaceIncircle.prototype.PlaceObjectsInCircle=function(e,t,c){let i=e.length;for(let u=0;u<i;u++){var n=2*Math.PI/i*u,l=Math.sin(n),a=Math.cos(n),r=new pc.Vec3(a,0,l),o=new pc.Vec3(r.x*c,r.y*c,r.z*c),s=o,p=e[u];p.setLocalPosition(s),p.lookAt(o.sub(t))}},PlaceIncircle.prototype.update=function(e){};var BossModifier=pc.createScript("bossModifier");BossModifier.attributes.add("info",{type:"json",schema:[{name:"health",type:"number",default:100},{name:"position",type:"vec3",default:[0,0,6]},{name:"rotation",type:"vec3",default:[0,180,0]},{name:"scale",type:"vec3",default:[1,1,1]},{name:"patchIndex",type:"number"},{name:"color",type:"rgb"}]}),BossModifier.prototype.initialize=function(){},BossModifier.prototype.update=function(e){};var MiniBossFightingManager=pc.createScript("miniBossFightingManager");MiniBossFightingManager.attributes.add("miniBossSettings",{title:"Mini Boss Settings",type:"json",schema:[{name:"onlyEndFlightAnim",type:"boolean",title:"Only End Flight Anim"},{name:"fixedEndFlightAnim",type:"string",title:"Fixed Ending Animation"},{name:"fixedFlightSpeed",type:"number",title:"Fixed Flight Speed"},{name:"distanceMultiplier",type:"number",title:"Distance Multiplier"},{name:"fixedHeroLevel",type:"number",title:"Fixed Hero Level"},{name:"fixedMultiplier",type:"number",title:"Fixed Multiplier"}]}),MiniBossFightingManager.prototype.initialize=function(){MiniBossFightingManager.Instance=this,this.app.on(Events.OnLevelLoaded,this.onLevelLoaded,this),this.app.on(Events.OnFightSequenceCompleted,this.onFightCompleted,this),this.app.on(Events.OnBossSpawned,this.setBoss,this),this.app.on("MiniBoss:Flight",this.miniBossFlight,this),this.app.on("MiniBoss:SetFlightSpeedFactor",this.setFlightSpeedFactor,this),this.flightData=void 0,this.flightSpeedFactor=1},MiniBossFightingManager.prototype.update=function(t){this.updateBossFlight(t)},MiniBossFightingManager.prototype.setBoss=function(t){this.boss=t},MiniBossFightingManager.prototype.onLevelLoaded=function(t){this.startingZ=t.maxForward,this.app.fire("Degenerate:FinishTrack")},MiniBossFightingManager.prototype.onFightCompleted=function(){this.app.fire("Generate:FinishTrack",this.startingZ,this.boss)},MiniBossFightingManager.prototype.miniBossFlight=function(t,i){this.playSound("Wind");let e=this.boss.script.bossController,s=this.miniBossSettings;e.animGraph.enabled=!1,e.bossView.parent.enabled=!0;let n=ReferenceManager.Instance.player.script.playerController,a=ReferenceManager.Instance.menus.bossFight.script.bossFightViewController,o=DataManager.Instance,l=n.maxHeroLevel,h=a.powerbarVal;s.fixedHeroLevel>0&&(n.heroLevel=s.fixedHeroLevel);let r=pc.math.clamp(n.heroLevel/l,0,1)*Math.max(h,Settings.finishTrack.generalSettings.powerBase),g=s.fixedMultiplier>0?s.fixedMultiplier:Settings.upgrade.getTargetMultiplier(o.kickLevel,r)-1,p=Settings.upgrade.getMultiplier(o.multiplierLevel);this.targetMultiplier=g;let d=Math.min(g,p);d=Math.max(d,4.2);let c=g>p||n.isRevived,f=Settings.upgrade.getFlyingDistance(n.isRevived?p:d,Settings.finishTrack.generalSettings.segmentSize),u=c?Settings.finishTrack.getWallRagdollPresetData():Settings.finishTrack.getRagdollPresetData(f,2),F=s.fixedFlightSpeed,m=e.entity.getLocalScale().z,S=1.35,M=this.boss.getLocalPosition().z,y=d<=2.2?M:M+(f-u.distance-e.zOffset);this.app.fire(Events.OnFlightBegins),s.onlyEndFlightAnim?(this.boss.fire("SetBossScale",S,S,S),this.endFlight(u.name,u.duration)):(e.bossView.anim.baseLayer.play("Flying Start"),this.flightData={speed:F>0?F:u.speed,startZ:M,endZ:y,startScale:m,endScale:S,currentZ:M,animationName:u.name,duration:u.duration,soundPoints:u.soundPoints.split(",").map(Number),wallReached:c})},MiniBossFightingManager.prototype.updateBossFlight=function(t){if(!this.flightData)return;this.flightData.currentZ+=this.flightData.speed*t*this.flightSpeedFactor;let i=pc.math.clamp(this.flightData.currentZ,this.flightData.startZ,this.flightData.endZ),e=0;e=this.flightData.endZ!==this.flightData.startZ?(i-this.flightData.startZ)/(this.flightData.endZ-this.flightData.startZ):1;let s=pc.math.lerp(this.flightData.startScale,this.flightData.endScale,e);this.boss.fire("SetBossScale",s,s,s),this.boss.fire("SetTeleport",0,0,i,{z:!0}),i>=this.flightData.endZ&&(this.endFlight(),this.flightData=void 0)},MiniBossFightingManager.prototype.endFlight=function(){let t=this.flightData.duration,i=this.miniBossSettings.fixedEndFlightAnim.length>0?this.miniBossSettings.fixedEndFlightAnim:this.flightData.animationName;this.boss.script.bossController.bossView.anim.baseLayer.play(`Ragdoll ${i}`),this.playFlightEndSounds(t),CustomCoroutine.Instance.set((()=>{this.playSound("Fireworks"),this.app.fire("FireworksVfx:Play",FireworkType.bottomCenter,4);let t=AttachmentsHandler.skinPickup?MenuManager.States.LooksGoodView:MenuManager.States.Win;this.app.fire("changeMenuState",t)}),t)},MiniBossFightingManager.prototype.playFlightEndSounds=function(t){let i=this.flightData.soundPoints;if(this.flightData.wallReached)CustomCoroutine.Instance.set((()=>{this.playSound("WallSmash"),this.app.fire(Events.ShakeCamera,.4,.04,.1)}),t*i[0]),CustomCoroutine.Instance.set((()=>{this.playSound("Falling")}),t*i[1]);else for(let e=0;e<i.length;e++)CustomCoroutine.Instance.set((()=>{this.playSound("Falling")}),t*i[e])},MiniBossFightingManager.prototype.playSound=function(t){this.app.fire("sound:playSound",t)},MiniBossFightingManager.prototype.setFlightSpeedFactor=function(t){this.flightSpeedFactor=t};var LoggerManager=pc.createScript("loggerManager"),isDebug=!1,isDebugOnMobile=!1;if(this.isDebugOnMobile){new VConsole}var Debugger=function(e,n){if(this.debug={},!window.console)return function(){};if(e&&n.isDebug)for(let e in console)"function"==typeof console[e]&&(this.debug[e]=console[e].bind(n.toString()+": "));else for(let e in console)"function"==typeof console[e]&&(this.debug[e]=function(){});return this.debug};Debug=Debugger(this.isDebug,this);var FinishTrackController=pc.createScript("finishTrackController");FinishTrackController.attributes.add("mutiplierSettings",{type:"json",title:"Mutiplier Settings",schema:[{name:"start",type:"number",title:"Start"},{name:"base",type:"number",title:"Base"},{name:"increment",type:"number",title:"Increment"}]}),FinishTrackController.attributes.add("trackColors",{type:"json",title:"Track Colors",schema:[{name:"color",title:"Color",type:"rgb"}],array:!0}),FinishTrackController.attributes.add("testing",{type:"json",title:"Testing",schema:[{name:"fixedWallPos",title:"Fixed Wall Position",type:"number",default:-1},{name:"distanceTile1",title:"Distance Tile1",type:"number"},{name:"distanceTile2",title:"Distance Tile2",type:"number"}]}),FinishTrackController.attributes.add("lockedWall",{type:"entity",title:"Locked Wall"}),FinishTrackController.attributes.add("startingOffset",{type:"number",title:"Starting Offset"}),FinishTrackController.attributes.add("trackSize",{type:"number",title:"Track Size"}),FinishTrackController.attributes.add("tracksPool",{type:"entity",title:"Tracks Pool"}),FinishTrackController.attributes.add("trackMat",{type:"asset",assetType:"material",title:"Track Material"}),FinishTrackController.attributes.add("breakableWall",{type:"entity",title:"Breakable Wall"}),FinishTrackController.attributes.add("inactiveColor",{type:"rgb",title:"Inactive Color"}),FinishTrackController.attributes.add("fixedWallPos",{type:"number",title:"Fixed Wall Position",default:-1}),FinishTrackController.prototype.initialize=function(){this.multiplierUpgradesBought=0,this.app.on("Generate:FinishTrack",this.showTrack,this),this.app.on("Degenerate:FinishTrack",this.hideTrack,this),this.app.on("Track:CurrentMultiplier",this.upgradeLastMaxMultiplier,this),this.app.on(Events.OnBossSpawned,this.setBoss,this),this.tracks=[],this.breakableWallReference=void 0,this.pool=this.tracksPool.script.PoolController},FinishTrackController.prototype.showTrack=function(t,e){this.tracks=[];let i=this.mutiplierSettings.start,a=Settings.upgrade.multiplierIncrementValue,r=DataManager.Instance.multiplierLevel,l=Settings.upgrade.getMultiplier(r),s=DataManager.Instance.lastMaxMultiplier,o=0,n=parseInt((l-1)/a),c=t+this.startingOffset,h=0;Debug.log("mul > lastMaxMultiplier",l,s);let p=this.fixedWallPos;for(l>s&&(p=parseInt((s-1)/a),Debug.log("lastMaxMultiplier i: ",p));h<=n;h++,o+=a){let t=this.pool.get();this.tracks.length<=0?t.setPosition(0,-.1,c):t.setPosition(0,-.1,c+h*this.trackSize),this.tracks.push(t),t.enabled=!0,t.fire("setMul",i+o);let a=this.trackMat.resource.clone();a.diffuse.set(this.inactiveColor.r,this.inactiveColor.g,this.inactiveColor.b),t.fire("setMat",a),t.fire("setColor",this.evaluateColor(h/n)),t.fire("setBoss",e),h===p&&(this.breakableWallReference=this.breakableWall.clone(),this.app.root.addChild(this.breakableWallReference),this.breakableWallReference.setLocalScale(1.4,1.4,1.4),this.breakableWallReference.setPosition(0,-.1,c+h*this.trackSize),this.breakableWallReference.enabled=!0,this.breakableWallReference.fire("setLabel","X"+(i+o).toFixed(1)))}this.lockedWall.enabled=!0,this.lockedWall.fire("setLabel","X"+(i+o).toFixed(1)),this.lockedWall.setPosition(0,0,c+(h-1)*this.trackSize),CustomCoroutine.Instance.set((()=>{GameManager.Instance.setGameSpeed(.4)}),.2),CustomCoroutine.Instance.set((()=>{Debug.log("MiniBoss:Flight"),this.app.fire("MiniBoss:Flight",this.trackSize,n),GameManager.Instance.setGameSpeed(1)}),.8)},FinishTrackController.prototype.hideTrack=function(){for(let t=this.tracks.length-1;t>=0;t--)this.pool.restore(this.tracks[t]);this.lockedWall.enabled=!1,this.breakableWallReference&&(this.breakableWallReference.enabled=!1),this.tracks=[]},FinishTrackController.prototype.upgradeLastMaxMultiplier=function(t){DataManager.Instance.lastMaxMultiplier<t&&DataManager.Instance.upgradeLastMaxMultiplier(t)},FinishTrackController.prototype.setBoss=function(t){this.boss=t},FinishTrackController.prototype.evaluateColor=function(t){let e,i=this.trackColors.length,a=t*i;for(let t=0;t<i;t++)if(a<=t+1){let r=a-t;e=t+1>=i?this.trackColors[t].color:this.hex2rgb(pc.math.lerp(this.trackColors[t].color,this.trackColors[t+1].color,r));break}return e},FinishTrackController.prototype.hexToRgb=function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},FinishTrackController.prototype.hex2rgb=function(t){return{r:("0x"+t[1]+t[2]|0)/255,g:("0x"+t[3]+t[4]|0)/255,b:("0x"+t[5]+t[6]|0)/255}};var BossController=pc.createScript("bossController");BossController.attributes.add("shake",{type:"vec3",default:[.3,.08,.05]}),BossController.attributes.add("modelObject",{type:"entity"}),BossController.attributes.add("modelObject2",{type:"entity"}),BossController.attributes.add("animGraph",{type:"entity"}),BossController.attributes.add("rigidbodyComp",{type:"entity"}),BossController.attributes.add("bossView",{type:"entity"}),BossController.attributes.add("posReference",{type:"entity"}),BossController.attributes.add("punchVFX",{type:"entity"}),BossController.attributes.add("vfxPositions",{type:"entity",array:!0}),BossController.attributes.add("testing",{title:"Testing",type:"json",schema:[{name:"customBossDamage",type:"number"},{name:"customBossScale",type:"number"}]}),BossController.prototype.initialize=function(){var t=this.modelObject.render.meshInstances[0].material.clone();this.modelObject.render.meshInstances[0].material=t;var e=this.modelObject2.render.meshInstances[0].material.clone();this.modelObject2.render.meshInstances[0].material=t,this.health=this.maxHealth=0,this.posReference.rigidbody.on("triggerenter",this.OnTriggerEnter,this),this.damageDelay=.25,this.prepareDamageTrigger=!1,this.maxDamageDelay=this.damageDelay,this.isFighting=!1,this.mat=t,this.mat2=e,this.app.on(Events.OnDamage,this.OnDamage,this),this.app.on(Events.OnAttack,this.OnAttack,this),this.app.on(Events.OnRevivePlayer,this.OnRevivePlayer,this),this.app.on(Events.OnHealthChanged,this.OnHealthChanged,this),this.app.on(Events.OnFightSequenceBegins,this.OnFightSequenceBegins,this),this.app.on(Events.OnFightSequenceCompleted,this.OnFightSequenceCompleted,this),this.app.on(Events.OnLevelLoaded,this.OnLevelLoaded,this),this.app.on(Events.OnFinishLineStarted,this.OnFinishLineStarted,this),this.app.on(Events.UpdateBossPosition,this.OnFinishLineStarted,this),this.entity.on("SetTeleport",this.setTeleport,this),this.entity.on("SetBossScale",this.setBossScale,this),this.app.on(Events.OnPlayerDead,this.OnPlayerDead,this),this.app.on("MiniBoss:PlayPunchVfx",this.playPunchVfx,this),this.app.on("MiniBoss:PlayKickVfx",this.playKickVfx,this),this.on("destroy",(function(){this.app.off(Events.OnDamage,this.OnDamage,this),this.app.off(Events.OnAttack,this.OnAttack,this),this.app.off(Events.OnPlayerDead,this.OnPlayerDead,this),this.app.off(Events.OnRevivePlayer,this.OnRevivePlayer,this),this.app.off(Events.OnHealthChanged,this.OnHealthChanged,this),this.app.off(Events.OnFightSequenceBegins,this.OnFightSequenceBegins,this),this.app.off(Events.OnFightSequenceCompleted,this.OnFightSequenceCompleted,this),this.app.off(Events.OnFinishLineStarted,this.OnFinishLineStarted,this),this.app.off("MiniBoss:PlayPunchVfx",this.playPunchVfx,this),this.app.off("MiniBoss:PlayKickVfx",this.playKickVfx,this)}),this)},BossController.prototype.postInitialize=function(){this.app.fire(Events.OnBossSpawned,this.entity)},BossController.prototype.OnPlayerDead=function(){},BossController.prototype.OnLevelLoaded=function(){this.damageDelay=.25},BossController.prototype.OnTriggerEnter=function(t){GameManager.Instance.setGameSpeed(Settings.finishTrack.flyingSettings.breakWallSlowMoSpeed),this.app.fire(Events.OnChangeCameraState,CameraState.WallBreak,20),this.app.fire("sound:playSound","WallBreak"),CustomCoroutine.Instance.set((()=>{GameManager.Instance.setGameSpeed(1),this.app.fire("MiniBoss:SetFlightSpeedFactor",1),this.app.fire(Events.OnChangeCameraState,CameraState.Flight,5)}),Settings.finishTrack.flyingSettings.breakWallSlowMoDuration);let e=t.script?.trigger;e&&e.Fire()},BossController.prototype.OnRevivePlayer=function(){},BossController.prototype.OnHealthChanged=function(t){if(this.isFighting&&0==t.health)if(t.target==AttackTarget.Boss)this.app.fire(Events.OnFightSequenceCompleted);else{if(!this.isFighting)return;let t=this.getAnimDuration("Kick");this.isKilledPlayer=!0,this.app.fire("sound:playSound","Whoosh"),this.playAnim("Kick"),CustomCoroutine.Instance.set((()=>{this.ProcessVictory(!0)}),t),CustomCoroutine.Instance.set((()=>{GameManager.Instance.setGameSpeed(.2),this.app.fire("Player:PlayDeadAnimSeq"),this.playKickVfx()}),t/2)}},BossController.prototype.OnDamage=function(t){t.target==AttackTarget.Boss&&(this.prepareDamageTrigger=!1,this.damageDelay=this.maxDamageDelay,this.ProcessHurt())},BossController.prototype.OnFightSequenceBegins=function(){this.isFighting=!0,this.ProcessAttack(!0)},BossController.prototype.OnFightSequenceCompleted=function(){this.isFighting=!1,this.damageDelay=.25},BossController.prototype.OnFinishLineStarted=function(){let t=this.entity.getLocalScale().x+ReferenceManager.Instance.player.script.playerController.PlayerAnimator.getLocalScale().x,e=Settings.scale.minScale,s=Settings.scale.maxScale,i=Settings.scale.minBossScale,n=Settings.scale.maxBossScale,o=Settings.finishTrack.generalSettings.bossMinZOffset,a=Settings.finishTrack.generalSettings.bossMaxZOffset;this.zOffset=changeRange(t,e+i,s+n,o,a);let r=this.entity.getLocalPosition();this.entity.setLocalPosition(r.x,r.y,r.z+this.zOffset),Debug.log("playerPos: ",r)},BossController.prototype.OnAttack=function(t){t.target==AttackTarget.Player&&(this.prepareDamageTrigger=!0,this.ProcessPunch(t.attack))},BossController.prototype.update=function(t){this.isFighting&&this.prepareDamageTrigger&&(this.damageDelay-=t,this.damageDelay<=0&&(this.damageDelay=this.maxDamageDelay,this.prepareDamageTrigger=!1,this.app.fire(Events.OnDamage,{target:AttackTarget.Player,damage:this.getDamage(),reason:"Boss"})))},BossController.prototype.getDamage=function(){let t,e=ReferenceManager.Instance.player.script.playerController;return t=this.testing.customBossDamage>0?this.testing.customBossDamage:e.heroLevel>=this.bossLevel?Settings.fightingDamage.boss.lowDamage:e.heroLevel*Settings.fightingDamage.hero.heroWinFactor>=this.bossLevel?Settings.fightingDamage.boss.mediumDamage:Settings.fightingDamage.boss.highDamage,t},BossController.prototype.prepare=function(t,e){let s=0,i=ReferenceManager.Instance.root.script.levelsData.difficultyData;for(let t=0;t<i.length;t++)if(e<=i[t].minLevel){s=i[t].bossLevelDelta;break}let n=Math.max(1,t.maxHeroLevel-s),o=Settings.scale.getBossScale(n);o=this.testing.customBossScale>0?this.testing.customBossScale:o,this.mat.diffuse=this.mat.emissive=t.color,this.mat2.diffuse=this.mat2.emissive=t.color,this.health=this.maxHealth=t.health,this.bossLevel=n;let a=t.position.x+Settings.finishTrack.generalSettings.bossOffset.x,r=t.position.y+Settings.finishTrack.generalSettings.bossOffset.y,h=t.position.z+Settings.finishTrack.generalSettings.bossOffset.z;Debug.log("Boss Z: ",h),this.entity.setLocalPosition(a,r,h),this.entity.setLocalEulerAngles(t.rotation),this.entity.setLocalScale(o,o,o)},BossController.prototype.setPos=function(t,e,s){this.entity.setLocalPosition(t,e,s)},BossController.prototype.getPunchId=function(){return this.punchID||(this.punchID=0),this.punchID++,this.punchID%=2,this.punchID},BossController.prototype.ProcessPunch=function(t){var e="";switch(this.getPunchId()){case 0:e="Punch Left";break;case 1:e="Punch Right"}this.app.fire("sound:playSound","Punch_"+(Math.floor(4*Math.random())+1));let s=this.getAnimDuration(e)/2;this.punchCoroutine&&clearTimeout(this.punchCoroutine),this.punchCoroutine=setTimeout((()=>{this.punchCoroutine=void 0,this.isKilledPlayer||this.ProcessAttack()}),1e3*s),this.playAnim(e,2)},BossController.prototype.playPunchVfx=function(){this.punchVFX.fire("Play",this.vfxPositions[0].getLocalPosition())},BossController.prototype.playKickVfx=function(){this.punchVFX.fire("Play",this.vfxPositions[1].getLocalPosition())},BossController.prototype.ProcessAttack=function(t){this.playAnim("Fight Idle")},BossController.prototype.ProcessDeath=function(t){this.playAnim("Death"),this.app.fire("sound:playSound","Fatality")},BossController.prototype.ProcessRevive=function(){this.playAnim("Revive")},BossController.prototype.ProcessVictory=function(t){this.playAnim("Victory")},BossController.prototype.ProcessHurt=function(){this.app.fire(Events.ShakeCamera,this.shake.x,this.shake.y,this.shake.z),this.app.fire("Player:PlayPunchVfx"),this.playAnim("Hurt");let t=this.getAnimDuration("Hurt");this.punchCoroutine&&clearTimeout(this.punchCoroutine),this.punchCoroutine=setTimeout((()=>{this.punchCoroutine=void 0,this.isKilledPlayer||this.ProcessAttack()}),1e3*t)},BossController.prototype.playAnim=function(t,e){e||(e=1),this.setAnimSpeed(e),this.animGraph.anim.baseLayer.transition(t,.1)},BossController.prototype.setAnimSpeed=function(t){this.animGraph.anim.baseLayer.speed=t},BossController.prototype.getAnimDuration=function(t){return this.animGraph.anim.baseLayer._controller._states[t].timelineDuration},BossController.prototype.ResetAnimationState=function(){},BossController.prototype.setTeleport=function(t,e,s,i){let n=this.entity.getLocalPosition();this.entity.setLocalPosition(i.x?t:n.x+t,i.y?e:n.y+e,i.z?s:n.z+s)},BossController.prototype.setBossScale=function(t,e,s){this.entity.setLocalScale(t,e,s)};var PoolController=pc.createScript("PoolController");PoolController.attributes.add("startingID",{title:"Starting ID",type:"number"}),PoolController.attributes.add("entityName",{title:"Name",type:"string"}),PoolController.attributes.add("capacity",{title:"Capacity",type:"number",description:"Instantiates these much elements on initialize"}),PoolController.attributes.add("container",{title:"Available Container",type:"entity"}),PoolController.attributes.add("usedContainer",{title:"Used Container",type:"entity"}),PoolController.attributes.add("prefab",{title:"Template",type:"asset",assetType:"template"}),PoolController.attributes.add("events",{title:"Events",type:"json",schema:[{title:"Restore",name:"restore",type:"string"},{title:"Get",name:"get",type:"string"},{title:"Created New",name:"createdNew",type:"string"}]}),PoolController.prototype.initialize=function(){this.avalibleID=this.startingID,this.events.restore.length>0&&this.app.on(this.events.restore,this.restore,this),this.events.get.length>0&&this.app.on(this.events.get,this.getEvent,this),this.on("destroy",this.onDestroy,this)},PoolController.prototype.onDestroy=function(){this.events.restore.length>0&&this.app.off(this.events.restore,this.restore,this),this.events.get.length>0&&this.app.off(this.events.get,this.getEvent,this)},PoolController.prototype.postInitialize=function(){this.initCapacity()},PoolController.prototype.initCapacity=function(){for(let t=0;t<this.capacity;t++)this.createNew().reparent(this.container)},PoolController.prototype.getEvent=function(t,e){e&&e(this.get(t))},PoolController.prototype.get=function(t){let e=this.container.children.length,o=e<=0?this.createNew():this.container.children[e-1];return o.reparent(t||this.usedContainer),o},PoolController.prototype.restore=function(t){t.enabled=!1,t.reparent(this.container)},PoolController.prototype.createNew=function(){let t=this.prefab.resource.instantiate();return t.enabled=!1,t.name=`${this.entityName} ${this.avalibleID++}`,this.app.root.addChild(t),this.app.fire(this.events.createdNew,t),t};var BossContainer=pc.createScript("bossContainer");BossContainer.attributes.add("templates",{title:"Templates",type:"json",schema:[{name:"miniBoss",type:"entity",title:"Mini Boss"},{name:"biggBoss",type:"entity",title:"Bigg Boss"}]}),BossContainer.prototype.initialize=function(){BossContainer=this},BossContainer.prototype.update=function(t){};var ReferenceManager=pc.createScript("referenceManager");ReferenceManager.attributes.add("root",{type:"entity",title:"Root"}),ReferenceManager.attributes.add("player",{type:"entity",title:"Player"}),ReferenceManager.attributes.add("boss",{type:"entity",title:"Boss"}),ReferenceManager.attributes.add("camera",{type:"entity",title:"Camera"}),ReferenceManager.attributes.add("menus",{title:"Menus",type:"json",schema:[{name:"bossFight",type:"entity",title:"Boss Fight"}]}),ReferenceManager.prototype.initialize=function(){ReferenceManager.Instance=this,this.app.on("ReferenceManager:SetBigBoss",this.setBigBoss,this)},ReferenceManager.prototype.setBigBoss=function(e){this.bigBoss=e};var FightSequenceHandler=pc.createScript("fightSequenceHandler");FightSequenceHandler.prototype.initialize=function(){this.app.on(Events.OnLevelLoaded,this.onLevelLoaded,this),this.app.on(Events.OnFinishLineReached,this.OnFinishLineReached,this),this.app.on(Events.OnFightSequenceCompleted,this.OnFightSequenceCompleted,this)},FightSequenceHandler.prototype.OnFightSequenceCompleted=function(){this.app.fire(Events.OnChangeMenuState,MenuManager.States.BlankScreen)},FightSequenceHandler.prototype.onLevelLoaded=function(e){this.isBigBossLevel=e.isBigBossLevel},FightSequenceHandler.prototype.OnFinishLineReached=function(){LevelInfo.isBonusLevel||LevelInfo.isBigBossLevel||(this.app.fire(Events.OnChangeMenuState,MenuManager.States.BossFight),this.app.fire(Events.OnFightSequenceBegins))},FightSequenceHandler.prototype.update=function(e){};var MoveEntity=pc.createScript("moveEntity");MoveEntity.attributes.add("delay",{type:"number"}),MoveEntity.attributes.add("speed",{type:"vec3"}),MoveEntity.prototype.initialize=function(){this.timer=this.delay},MoveEntity.prototype.update=function(t){if(this.timer-=t,this.timer>0)return;let e=this.entity.getLocalPosition(),i=this.speed.x*t+e.x,o=this.speed.y*t+e.y,s=this.speed.z*t+e.z;this.entity.setLocalPosition(i,o,s)};var FightController=pc.createScript("fightController");FightController.attributes.add("target",{type:"number",enum:[{Player:0},{Boss:1}]}),FightController.attributes.add("health",{type:"number"}),FightController.attributes.add("delay",{type:"number",default:3}),FightController.prototype.initialize=function(){this.maxHealth=this.health,this.maxDelay=this.delay,this.start=!1,this.canAttack=!1,this.app.on(Events.OnFightSequenceBegins,this.OnFightSequenceBegins,this),this.app.on(Events.OnFightSequenceCompleted,this.OnFightSequenceCompleted,this),this.app.on(Events.OnPlayerDead,this.OnPlayerDead,this),this.app.on(Events.OnDamage,this.OnDamage,this),this.target==AttackTarget.Boss&&this.app.on(Events.OnTap,this.OnTap,this),this.on("destroy",(function(){this.app.off(Events.OnPlayerDead,this.OnPlayerDead,this),this.app.off(Events.OnFightSequenceBegins,this.OnFightSequenceBegins,this),this.app.off(Events.OnFightSequenceCompleted,this.OnFightSequenceCompleted,this),this.app.off(Events.OnDamage,this.OnDamage,this),this.target==AttackTarget.Boss&&this.app.off(Events.OnTap,this.OnTap,this)}),this)},FightController.prototype.OnPlayerDead=function(){this.start=!1},FightController.prototype.OnDamage=function(t){t.target!=this.target&&(this.health-=t.damage,this.health<=0&&(this.health=0),t.health=this.health/this.maxHealth,this.app.fire(Events.OnHealthChanged,t))},FightController.prototype.OnTap=function(){if(this.canAttack){this.canAttack=!1;this.app.fire(Events.OnAttack,{target:this.target,attack:Math.floor(getRandomArbitrary(0,2))})}},FightController.prototype.OnFightSequenceBegins=function(){this.start=!0,this.canAttack=!1,this.delay=this.maxDelay,this.health=this.maxHealth},FightController.prototype.OnFightSequenceCompleted=function(){this.start=!1},FightController.prototype.update=function(t){this.start&&this.initiateAttack(t)},FightController.prototype.initiateAttack=function(t){if(this.delay-=t,this.delay<=0){this.delay=this.maxDelay;this.canAttack=!0,this.target==AttackTarget.Player&&this.app.fire(Events.OnAttack,{target:this.target,attack:Math.floor(getRandomArbitrary(0,2))})}};var BossFightViewController=pc.createScript("bossFightViewController");BossFightViewController.attributes.add("tapButton",{type:"entity"}),BossFightViewController.attributes.add("fingerImg",{type:"entity"}),BossFightViewController.attributes.add("bossMenuComponents",{type:"json",title:"Menu Components",schema:[{name:"playerBar",title:"Player bar ref",type:"entity"},{name:"bossBar",title:"Boss bar ref",type:"entity"},{name:"powerBar",title:"Power bar ref",type:"entity"}]}),BossFightViewController.attributes.add("roots",{title:"Roots",type:"json",schema:[{name:"powerBar",type:"entity",title:"Power Bar"},{name:"tapTap",type:"entity",title:"Tap Tap"},{name:"dodgeGuide",type:"entity",title:"Dodge Guide"},{name:"bonusMultiplierBar",type:"entity",title:"Bonus Multiplier Bar"}]}),BossFightViewController.prototype.initialize=function(){this.maxPlayerBarWidth=this.bossMenuComponents.playerBar.element.width,this.maxBossBarWidth=this.bossMenuComponents.bossBar.element.width,this.maxPowerBarWidth=this.bossMenuComponents.powerBar.element.width,this.bossMenuComponents.powerBar.element.width=this.minFill,this.powerbarVal=0,this.minFill=1,this.incrementFill=70,this.emptySpeed=.99,this.isTappingAllowed=!0,this.tapButton.button.on("click",this.OnTap,this),this.app.on(Events.OnFightSequenceBegins,this.OnFightSequenceBegins,this),this.app.on(Events.OnFightSequenceCompleted,this.OnFightSequenceCompleted,this),this.app.on(Events.OnHealthChanged,this.OnHealthChanged,this),this.app.on("FightView:EnablePowerBar",this.enablePowerbar,this),this.app.on("FightView:EnableTapTap",this.enableTapTap,this),this.app.on("FightView:EnableDodgeGuide",this.enableDodgeGuide,this),this.app.on("FightView:SetDodgeGuide",this.setDodgeGuide,this),this.app.on("FightView:EnableBonusMultiplier",this.enableBonusMultiplier,this),this.app.on("FightView:SetMultiplier",this.setMultiplier,this),this.app.on("FightView:SetTimeOut",this.setTimeOut,this),this.app.on("FightView:SetHealth",this.setHealth,this),TweenWrapper.Tween(this.fingerImg,this.fingerImg.getLocalScale(),new pc.Vec3(.8,.8,.8),.4,void 0,pc.SineIn,!0,!0),this.on("enable",this.reset,this)},BossFightViewController.prototype.postInitialize=function(){this.reset()},BossFightViewController.prototype.update=function(e){if(this.isTappingAllowed){this.bossMenuComponents.powerBar.element.width-this.emptySpeed>this.minFill?this.bossMenuComponents.powerBar.element.width-=this.emptySpeed:this.bossMenuComponents.powerBar.element.width=this.minFill,this.powerbarVal=changeRange(this.bossMenuComponents.powerBar.element.width,0,this.maxPowerBarWidth,0,1)}},BossFightViewController.prototype.OnHealthChanged=function(e){e.health&&this.setHealth(e.target,e.health)},BossFightViewController.prototype.setHealth=function(e,t){switch(e){case AttackTarget.Boss:this.updateBossHealth(t);break;case AttackTarget.Player:this.updatePlayerHealth(t)}},BossFightViewController.prototype.reset=function(){if(this.bossMenuComponents.playerBar.element.width=this.maxPlayerBarWidth,this.bossMenuComponents.bossBar.element.width=this.maxBossBarWidth,this.bossMenuComponents.powerBar.element.width=this.minFill,LevelInfo.isBigBossLevel){let e=Settings.biggBossFighting.levelsBetweenBigBoss,t=LevelInfo.level%e==0;this.isTappingAllowed=!1,this.enableTapTap(!1),this.enablePowerbar(!1),this.enableDodgeGuide(!0),t?this.setDodgeGuide(1):this.setDodgeGuide(0)}else this.isTappingAllowed=!0,this.powerbarVal=0,this.enableTapTap(!0),this.enablePowerbar(!0),this.enableDodgeGuide(!1);this.enableBonusMultiplier(!1)},BossFightViewController.prototype.OnFightSequenceCompleted=function(){this.isTappingAllowed=!1},BossFightViewController.prototype.OnFightSequenceBegins=function(){this.isTappingAllowed=!0},BossFightViewController.prototype.OnTap=function(){if(this.app.fire(Events.OnTap),this.isTappingAllowed){this.bossMenuComponents.powerBar.element.width+this.incrementFill<=this.maxPowerBarWidth?this.bossMenuComponents.powerBar.element.width+=this.incrementFill:this.bossMenuComponents.powerBar.element.width=this.maxPowerBarWidth}},BossFightViewController.prototype.updatePlayerHealth=function(e){let t=this.bossMenuComponents.playerBar.element.width,i=changeRange(e,0,1,0,this.maxPlayerBarWidth);this.playerHealthTween&&TweenWrapper.StopTween(this.playerHealthTween),this.playerHealthTween=TweenWrapper.TweenNumber(t,i,.25,(e=>{this.bossMenuComponents.playerBar.element.width=e.number}),(()=>{this.bossMenuComponents.playerBar.element.width=i}))},BossFightViewController.prototype.updateBossHealth=function(e){let t=this.bossMenuComponents.bossBar.element.width,i=changeRange(e,0,1,0,this.maxBossBarWidth);this.bossHealthTween&&TweenWrapper.StopTween(this.bossHealthTween),this.bossHealthTween=TweenWrapper.TweenNumber(t,i,.25,(e=>{this.bossMenuComponents.bossBar.element.width=e.number}),(()=>{this.bossMenuComponents.bossBar.element.width=i}))},BossFightViewController.prototype.enablePowerbar=function(e){this.roots.powerBar.enabled=!0===e},BossFightViewController.prototype.enableTapTap=function(e){this.roots.tapTap.enabled=!0===e},BossFightViewController.prototype.enableDodgeGuide=function(e){this.roots.dodgeGuide.enabled=!0===e},BossFightViewController.prototype.enableBonusMultiplier=function(e){this.roots.bonusMultiplierBar.enabled=!0===e},BossFightViewController.prototype.setMultiplier=function(e){this.roots.bonusMultiplierBar.fire("SetMultiplier",e)},BossFightViewController.prototype.setTimeOut=function(){this.roots.bonusMultiplierBar.fire("SetTimeOut")},BossFightViewController.prototype.setDodgeGuide=function(e){this.roots.dodgeGuide.fire("EnableOneSwipe",e)};var SimpleFollow=pc.createScript("simpleFollow");SimpleFollow.attributes.add("target",{type:"entity"}),SimpleFollow.prototype.initialize=function(){this.orgTarget=this.target,this.app.on(Events.OnFlightBegins,this.OnFlightBegins,this),this.app.on(Events.OnBossSpawned,this.OnBossSpawned,this),this.app.on(Events.OnLevelLoaded,this.OnLevelLoaded,this)},SimpleFollow.prototype.OnLevelLoaded=function(){this.setTarget(this.orgTarget)},SimpleFollow.prototype.OnFlightBegins=function(){this.setTarget(this.boss)},SimpleFollow.prototype.OnBossSpawned=function(t){this.boss=t.script.bossController.posReference},SimpleFollow.prototype.setTarget=function(t){this.target=t},SimpleFollow.prototype.update=function(t){if(this.target){let t=this.target.getPosition();this.entity.setPosition(t.x,t.y,t.z)}};var WinScreenEventListner=pc.createScript("winScreenEventListner");WinScreenEventListner.attributes.add("winScreenComponents",{type:"json",title:"Win Screen Components",schema:[{name:"mobText",type:"entity"},{name:"gemText",type:"entity"},{name:"multiplierTxt",type:"entity"},{name:"arrowImg",type:"entity"},{name:"claim2xBtn",type:"entity"},{name:"claimBtn",type:"entity"},{name:"claim2xBtnGemTxt",type:"entity"},{name:"claimBtnGemTxt",type:"entity"},{name:"rewardEntity",type:"entity"},{name:"progressEntity",type:"entity"},{name:"progressText",type:"entity"},{name:"progressSkin",type:"entity"},{name:"claimText",type:"entity"}]}),WinScreenEventListner.attributes.add("winScreenComponentsLevel1",{type:"json",title:"Win Screen Components for Level 1",schema:[{name:"mobText",type:"entity"},{name:"gemText",type:"entity"},{name:"multiplierTxt",type:"entity"},{name:"claim2xBtn",type:"entity"},{name:"claim2xBtnGemTxt",type:"entity"}]}),WinScreenEventListner.attributes.add("pendulumReward",{type:"json",schema:[{name:"icon",type:"entity"},{name:"valueText",type:"entity"}]}),WinScreenEventListner.attributes.add("level1WinScreen",{type:"entity"}),WinScreenEventListner.attributes.add("level2WinScreen",{type:"entity"}),WinScreenEventListner.instance=null,WinScreenEventListner.prototype.initialize=function(){WinScreenEventListner.instance=this,this.claim2XClicked=!1,this.claimClicked=!1,this.setUp(),this.multiplier=0,this.currentMobsHit=0,this.gemText=0,this.gemText2X=0,this.currentReward=null,this.loadingScreen=this.app.root.findByName("LoadScreen"),this.loadingAdScreen=this.app.root.findByName("Loading Ad Screen"),this.winScreenComponents.claim2xBtn.button.on("click",this.claim2XBtnEvent,this),this.winScreenComponentsLevel1.claim2xBtn.button.on("click",this.claim2XBtnEventLevel1,this),this.winScreenComponents.claimBtn.button.on("click",this.claimBtnEvent,this),this.on("enable",this.onEnable,this),this.on("destroy",this.onDestroy,this)},WinScreenEventListner.prototype.postInitialize=function(){this.onEnable()},WinScreenEventListner.prototype.onEnable=function(){if(this.pendulumData=null,this.app.fire("GemsMenu:EnableCounterView",!0),this.currentReward="",this.winScreenComponents.claimBtn.button.active=!0,this.winScreenComponents.claim2xBtn.button.active=!0,this.pendulumReward.icon.enabled=!1,this.pendulumReward.valueText.element.text="",this.currentLevel=LevelGenerator.prototype.GetCurrentLevel(),0==LevelGenerator.prototype.GetCurrentLevel())this.level1WinScreen.enabled=!0,this.level2WinScreen.enabled=!1;else{this.level1WinScreen.enabled=!1,this.level2WinScreen.enabled=!0,this.winScreenComponents.rewardEntity.enabled=!0,this.winScreenComponents.progressEntity.enabled=!1,this.setUp(),this.runArrowTween();var e=this;ChestRoomManager.IsProgressRewardAvailable()&&LevelInfo.level>1&&setTimeout((function(){e.winScreenComponents.rewardEntity.enabled=!1,e.winScreenComponents.progressEntity.enabled=!0;var t=ChestRoomManager.GetCurrentProgressSkin();e.winScreenComponents.progressSkin.element.sprite=t,e.winScreenComponents.progressText.element.text=ChestRoomManager.currentRewardProgress+"%"}),3e3)}},WinScreenEventListner.prototype.setUp=function(){if(GameMenuEventListner.instance){this.currentMobsHit=GameMenuEventListner.instance.currentMobsHit,this.gemText=GameMenuEventListner.instance.currentGems,this.winScreenComponents.mobText.element.text="X +"+GameMenuEventListner.instance.currentMobsHit,this.winScreenComponents.gemText.element.text="X +"+GameMenuEventListner.instance.currentGems,this.winScreenComponentsLevel1.mobText.element.text="X +"+GameMenuEventListner.instance.currentMobsHit,this.winScreenComponentsLevel1.gemText.element.text="X +"+GameMenuEventListner.instance.currentGems,0==LevelGenerator.prototype.GetCurrentLevel()&&(GemsManager.collectedGems=139,this.gemText=GemsManager.collectedGems),this.winScreenComponents.claimBtnGemTxt.element.text=this.gemText,this.winScreenComponentsLevel1.claim2xBtnGemTxt.element.text=2*this.gemText;let e=MiniBossFightingManager.Instance.targetMultiplier;e&&(this.winScreenComponents.multiplierTxt.element.text=`X${e.toFixed(1)}`)}},WinScreenEventListner.prototype.onDestroy=function(){},WinScreenEventListner.prototype.runArrowTween=function(){this.winScreenComponents.arrowImg.setLocalEulerAngles(0,0,65),this.arrowTween=this.winScreenComponents.arrowImg.tween(this.winScreenComponents.arrowImg.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,-65),.75,pc.Linear).loop(!0).yoyo(!0).on("update",(()=>{if(this.currentArrowZ=this.winScreenComponents.arrowImg.getLocalEulerAngles().z,this.currentArrowZ<=65&&this.currentArrowZ>=53?this.currentReward=3:this.currentArrowZ<53&&this.currentArrowZ>=13?this.currentReward=2:this.currentArrowZ<13&&this.currentArrowZ>=-13?this.currentReward="Chest":this.currentArrowZ<-13&&this.currentArrowZ>=-53?this.currentReward=2:this.currentArrowZ<-53&&this.currentArrowZ>=-65&&(this.currentReward=3),"Chest"!==this.currentReward){let e=parseInt(GameMenuEventListner.instance.currentGems)*this.currentReward;this.winScreenComponents.claim2xBtnGemTxt.element.text=e,this.winScreenComponents.claimText.element.text="Claim X"+this.currentReward}else this.winScreenComponents.claimText.element.text="??"})),this.arrowTween.start()},WinScreenEventListner.prototype.claim2X=function(){GemsManager.collectedGems*=2,this.applyRewardAfterAd()},WinScreenEventListner.prototype.claim=function(){if(ChestRoomManager.currentRewardProgress>=100)this.app.fire(Events.OnChangeMenuState,MenuManager.States.SkinUnlockedView);else if(ChestRoomManager.keys>=3)this.currentReward="",this.app.fire(Events.OnChangeMenuState,MenuManager.States.ChestRoom);else{this.currentReward="";parseInt(GameMenuEventListner.instance.currentGems);this.app.fire(Events.OnLevelCompleted),this.app.fire(Events.OnChangeMenuState,MenuManager.States.Home),setTimeout((()=>{this.loadingAdScreen.enabled=!1}),1e3)}},WinScreenEventListner.prototype.claim2XBtnEventLevel1=function(){this.claim2X(),this.playSound("Fireworks"),this.app.fire("FireworksVfx:Play",FireworkType.topCenter,2)},WinScreenEventListner.prototype.claim2XBtnEvent=function(){if(this.playSound("Fireworks"),this.app.fire("FireworksVfx:Play",FireworkType.topCenter,2),this.winScreenComponents.claim2xBtn.button.active=!1,this.winScreenComponents.claimBtn.button.active=!1,this.arrowTween.stop(),ConfigManager.instance.environmentType!==ConfigManager.EnvTypes.None){this.loadingAdScreen.enabled=!0;const e=WinScreenEventListner.instance.resumeGiveReward.bind(this),t=WinScreenEventListner.instance.pauseGame.bind(this),n=WinScreenEventListner.instance.resumeNoReward.bind(this),i=WinScreenEventListner.instance.adNotAvailable.bind(this);this.app.fire("showRewardedAD",e,t,n,i)}else this.claim2X()},WinScreenEventListner.prototype.claimBtnEvent=function(){this.playSound("Fireworks"),this.app.fire("FireworksVfx:Play",FireworkType.topCenter,2),this.winScreenComponents.claim2xBtn.button.active=!1,this.winScreenComponents.claimBtn.button.active=!1,this.arrowTween.stop(),CustomCoroutine.Instance.set(function(){this.claim()}.bind(this),1)},WinScreenEventListner.prototype.applyRewardAfterAd=function(){if("Chest"===this.currentReward){var e=ChestRoomManager.GetCommonPendulumUnlockSkin();if(e){if(this.pendulumReward.icon.enabled=!0,this.pendulumReward.icon.element.sprite=e.sprite,e.rewardType===PendulumReward.Skin)return this.pendulumData=e,this.pendulumReward.valueText.element.text="",this.app.fire(Events.OnChangeMenuState,MenuManager.States.SkinUnlockedView),void Debug.log("data.rewardType === PendulumReward.Skin");if(e.rewardType===PendulumReward.GemsSmall){if(GemsManager.collectedGems+=e.value,this.pendulumReward.valueText.element.text=GemsManager.collectedGems,Debug.log("data.rewardType === PendulumReward.GemsSmall"),ChestRoomManager.currentRewardProgress>=100)return void this.app.fire(Events.OnChangeMenuState,MenuManager.States.SkinUnlockedView);if(ChestRoomManager.keys>=3)return this.currentReward="",void this.app.fire(Events.OnChangeMenuState,MenuManager.States.ChestRoom)}else{if(ChestRoomManager.UpdateKeysBalance(1),this.pendulumReward.valueText.element.text="",Debug.log("data.rewardType === else case"),ChestRoomManager.currentRewardProgress>=100)return void this.app.fire(Events.OnChangeMenuState,MenuManager.States.SkinUnlockedView);if(ChestRoomManager.keys>=3)return this.currentReward="",void this.app.fire(Events.OnChangeMenuState,MenuManager.States.ChestRoom)}let t=this;setTimeout((function(){t.loadHome()}),500)}}else ChestRoomManager.currentRewardProgress>=100?this.app.fire(Events.OnChangeMenuState,MenuManager.States.SkinUnlockedView):ChestRoomManager.keys>=3?(this.currentReward="",this.app.fire(Events.OnChangeMenuState,MenuManager.States.ChestRoom)):this.loadHome()},WinScreenEventListner.prototype.playSound=function(e){this.app.fire("sound:playSound",e)},WinScreenEventListner.prototype.resumeGiveReward=function(){this.loadingAdScreen.enabled=!1,this.claim2X()},WinScreenEventListner.prototype.pauseGame=function(){this.loadingAdScreen.enabled=!0},WinScreenEventListner.prototype.resumeNoReward=function(){this.loadingAdScreen.enabled=!1,this.app.fire("adSkippedPopup"),this.claim()},WinScreenEventListner.prototype.adNotAvailable=function(){this.loadingAdScreen.enabled=!1,this.app.fire("noAdPopup"),this.claim()},WinScreenEventListner.prototype.loadHome=function(){this.pendulumData=null,this.currentReward="",this.loadingScreen.enabled=!0,this.app.fire(Events.OnLevelCompleted),this.app.fire(Events.OnChangeMenuState,MenuManager.States.Home),setTimeout((()=>{this.loadingScreen.enabled=!1}),1500)},WinScreenEventListner.prototype.update=function(e){};var BrushTween=pc.createScript("brushTween");BrushTween.attributes.add("rotVal",{type:"vec3",default:[1.5,0,0]}),BrushTween.prototype.initialize=function(){},BrushTween.prototype.update=function(t){this.entity.rotateLocal(this.rotVal.x,this.rotVal.y,this.rotVal.z)};var LevelProgressionViewHandler=pc.createScript("levelProgressionViewHandler");LevelProgressionViewHandler.attributes.add("progressionView",{type:"json",title:"Level Progression Components",schema:[{name:"levelNumber",type:"entity"},{name:"LevelNoView",type:"entity"},{name:"progressionCircles",type:"entity",array:!0}]}),LevelProgressionViewHandler.attributes.add("progressBar",{type:"entity"}),LevelProgressionViewHandler.attributes.add("crownIcon",{type:"entity"}),LevelProgressionViewHandler.attributes.add("rageGauge",{type:"entity"}),LevelProgressionViewHandler.attributes.add("mobIcon",{type:"entity"}),LevelProgressionViewHandler.prototype.initialize=function(){this.currentLevel=2,this.grayColor=new pc.Color(156/255,154/255,158/255),this.blueColor=new pc.Color(33/255,154/255,1),this.purpleColor=new pc.Color(152/255,123/255,199/255),this.app.on(Events.OnLevelLoaded,this.OnLevelLoaded,this),this.on("destroy",this.onDestroy,this)},LevelProgressionViewHandler.prototype.onDestroy=function(){this.app.off("onUpdateProgression",this.updateProgression,this)},LevelProgressionViewHandler.prototype.OnLevelLoaded=function(e){this.crownIcon.enabled=!0,parseInt(e.level)%6==0?(this.progressionView.levelNumber.element.text="Bonus Level",this.progressBar.enabled=!1,this.mobIcon.enabled=!1,this.crownIcon.enabled=!1,this.progressionView.levelNumber.element.color=this.purpleColor):(this.progressionView.levelNumber.element.text="Level "+e.level,this.progressionView.levelNumber.element.color=this.blueColor,parseInt(e.level)>3&&(this.progressBar.enabled=!0,this.rageGauge.enabled=!0),this.mobIcon.enabled=!0,this.crownIcon.enabled=!0),this.updateProgression(e.level)},LevelProgressionViewHandler.prototype.updateProgression=function(e){if(1===e||2===e||3===e)for(let r=0;r<e;r++)this.progressionView.progressionCircles[r].script.circleProgressionInfo.circle.element.color=this.blueColor,this.progressionView.progressionCircles[r].script.circleProgressionInfo.bar.element.color=this.blueColor;else{for(let e=0;e<3;e++)this.progressionView.progressionCircles[e].script.circleProgressionInfo.circle.element.color=this.blueColor,this.progressionView.progressionCircles[e].script.circleProgressionInfo.bar.element.color=this.blueColor;this.progressionView.progressionCircles[0].script.circleProgressionInfo.levelNoTxt.element.text=e-2,this.progressionView.progressionCircles[1].script.circleProgressionInfo.levelNoTxt.element.text=e-1,this.progressionView.progressionCircles[2].script.circleProgressionInfo.levelNoTxt.element.text=e,this.progressionView.progressionCircles[3].script.circleProgressionInfo.levelNoTxt.element.text=e+1,this.progressionView.progressionCircles[4].script.circleProgressionInfo.levelNoTxt.element.text=e+2;for(let e=0;e<this.progressionView.progressionCircles.length;e++){this.progressionView.progressionCircles[e].script.circleProgressionInfo.chest.enabled=!1,this.progressionView.progressionCircles[e].script.circleProgressionInfo.boss.enabled=!1;let r=parseInt(this.progressionView.progressionCircles[e].script.circleProgressionInfo.levelNoTxt.element.text);r%5==0?(this.progressionView.progressionCircles[e].script.circleProgressionInfo.chest.enabled=!1,this.progressionView.progressionCircles[e].script.circleProgressionInfo.boss.enabled=!0):r%6==0&&(this.progressionView.progressionCircles[e].script.circleProgressionInfo.chest.enabled=!0,this.progressionView.progressionCircles[e].script.circleProgressionInfo.boss.enabled=!1)}}},LevelProgressionViewHandler.prototype.update=function(e){};var LoseMenuEventListner=pc.createScript("loseMenuEventListner");LoseMenuEventListner.attributes.add("loseMenu",{type:"json",title:"Lose Menu Components",schema:[{name:"killBossBtn",type:"entity"},{name:"secondTimerTxt",type:"entity"}]}),LoseMenuEventListner.attributes.add("reviveEvent",{type:"string"}),LoseMenuEventListner.instance=null,LoseMenuEventListner.prototype.initialize=function(){LoseMenuEventListner.instance=this,this.reset(),this.loadingAdScreen=this.app.root.findByName("Loading Ad Screen"),this.loseMenu.killBossBtn.button.on("click",this.onKillBossBtnClick,this),this.on("enable",this.reset,this)},LoseMenuEventListner.prototype.reset=function(){this.downloadTimer&&clearInterval(this.downloadTimer);var e=10;this.downloadTimer=setInterval((()=>{e<=0?this.onRewardFail():this.loseMenu.secondTimerTxt.element.text=e,e-=1}),1e3)},LoseMenuEventListner.prototype.onKillBossBtnClick=function(){if(this.downloadTimer&&clearInterval(this.downloadTimer),ConfigManager.instance.environmentType!==ConfigManager.EnvTypes.None){const e=LoseMenuEventListner.instance.resumeGiveReward.bind(this),n=LoseMenuEventListner.instance.pauseGame.bind(this),t=LoseMenuEventListner.instance.resumeNoReward.bind(this),i=LoseMenuEventListner.instance.adNotAvailable.bind(this);this.app.fire("showRewardedAD",e,n,t,i)}else this.app.fire(this.reviveEvent)},LoseMenuEventListner.prototype.resumeGiveReward=function(){this.loadingAdScreen.enabled=!1,this.app.fire(this.reviveEvent)},LoseMenuEventListner.prototype.pauseGame=function(){this.loadingAdScreen.enabled=!0},LoseMenuEventListner.prototype.resumeNoReward=function(){this.loadingAdScreen.enabled=!1,this.app.fire("adSkippedPopup"),this.onRewardFail()},LoseMenuEventListner.prototype.adNotAvailable=function(){this.loadingAdScreen.enabled=!1,this.app.fire("noAdPopup"),this.onRewardFail()},LoseMenuEventListner.prototype.onRewardFail=function(){clearInterval(this.downloadTimer),this.loseMenu.secondTimerTxt.element.text=0,this.app.fire(Events.OnResetLevel)},LoseMenuEventListner.prototype.update=function(e){};var DeathManager=pc.createScript("deathManager");DeathManager.prototype.initialize=function(){this.app.on(Events.OnPlayerDead,this.onPlayerDead,this)},DeathManager.prototype.onPlayerDead=function(e){"Obstacle"===e?setTimeout((()=>{this.app.fire(Events.OnChangeMenuState,MenuManager.States.LoseObstacle),this.app.fire("sound:playSound","LevelFailed")}),1e3):"Boss"===e&&setTimeout((()=>{this.app.fire(Events.OnChangeMenuState,MenuManager.States.Lose),this.app.fire("sound:playSound","LevelFailed")}),5e3)},DeathManager.prototype.update=function(e){};var DeathTrapInfo=pc.createScript("deathTrapInfo");DeathTrapInfo.attributes.add("damage",{type:"number",default:1}),DeathTrapInfo.prototype.initialize=function(){},DeathTrapInfo.prototype.update=function(t){};var RageMode=pc.createScript("rageMode");RageMode.attributes.add("PlayerController",{type:"entity"}),RageMode.attributes.add("Target",{type:"entity"}),RageMode.attributes.add("Duration",{type:"number"}),RageMode.attributes.add("Ease",{type:"string",default:"Linear",enum:[{Linear:"Linear"},{QuadraticIn:"QuadraticIn"},{QuadraticOut:"QuadraticOut"},{QuadraticInOut:"QuadraticInOut"},{CubicIn:"CubicIn"},{CubicOut:"CubicOut"},{CubicInOut:"CubicInOut"},{QuarticIn:"QuarticIn"},{QuarticOut:"QuarticOut"},{QuarticInOut:"QuarticInOut"},{QuinticIn:"QuinticIn"},{QuinticOut:"QuinticOut"},{QuinticInOut:"QuinticInOut"},{SineIn:"SineIn"},{SineOut:"SineOut"},{SineInOut:"SineInOut"},{ExponentialIn:"ExponentialIn"},{ExponentialOut:"ExponentialOut"},{ExponentialInOut:"ExponentialInOut"},{CircularIn:"CircularIn"},{CircularOut:"CircularOut"},{CircularInOut:"CircularInOut"},{BackIn:"BackIn"},{BackOut:"BackOut"},{BackInOut:"BackInOut"},{BounceIn:"BounceIn"},{BounceOut:"BounceOut"},{BounceInOut:"BounceInOut"},{ElasticIn:"ElasticIn"},{ElasticOut:"ElasticOut"},{ElasticInOut:"ElasticInOut"}]}),RageMode.prototype.initialize=function(){this.velocity=new pc.Vec3(1,1,1),this.entity.rigidbody.on("triggerenter",this.OnTriggerEnter,this)},RageMode.prototype.OnTriggerEnter=function(t){t.tags.has("Collectable")&&!t.tags.has("Static")&&(t.collision.enabled=!1,this.PlayerController.script.playerController.objects.push(t))},RageMode.prototype.update=function(t){var n=this.Target.getPosition();this.entity.setPosition(n.x,n.y,n.z)};var FightingDamageSettings=pc.createScript("fightingDamageSettings");FightingDamageSettings.attributes.add("hero",{title:"Hero Settings",type:"json",schema:[{name:"lowDamage",title:"Low Damage",type:"number",default:16},{name:"mediumDamage",title:"Medium Damage",type:"number",default:16},{name:"highDamage",title:"High Damage",type:"number",default:17},{name:"heroWinFactor",title:"Hero Win Factor",type:"number",default:1.5}]}),FightingDamageSettings.attributes.add("boss",{title:"Boss Settings",type:"json",schema:[{name:"lowDamage",title:"Low Damage",type:"number",default:17},{name:"mediumDamage",title:"Medium Damage",type:"number",default:20},{name:"highDamage",title:"High Damage",type:"number",default:23}]});var ScaleSettings=pc.createScript("scaleSettings");ScaleSettings.attributes.add("minScale",{type:"number",title:"Min Scale"}),ScaleSettings.attributes.add("maxScale",{type:"number",title:"Max Scale"}),ScaleSettings.attributes.add("minBossScale",{type:"number",title:"Min Boss Scale"}),ScaleSettings.attributes.add("maxBossScale",{type:"number",title:"Max Boss Scale"}),ScaleSettings.attributes.add("maxLevels",{type:"number",title:"Max Levels"}),ScaleSettings.prototype.initialize=function(){},ScaleSettings.prototype.update=function(t){},ScaleSettings.prototype.getBossScale=function(t){return pc.math.lerp(this.minBossScale,this.maxBossScale,pc.math.clamp(t/this.maxLevels,0,1))},ScaleSettings.prototype.getHeroScale=function(t){return pc.math.lerp(this.minScale,this.maxScale,pc.math.clamp(t/this.maxLevels,0,1))};var ProgressionCircleInfo=pc.createScript("progressionCircleInfo");ProgressionCircleInfo.prototype.initialize=function(){},ProgressionCircleInfo.prototype.update=function(o){};var Settings=pc.createScript("settings");Settings.attributes.add("configs",{title:"Config Files",type:"json",schema:[{name:"obj",type:"entity",title:"Entity"},{name:"scriptName",type:"string",title:"Script Name"},{name:"variableName",type:"string",title:"Variable Name"}],array:!0}),Settings.prototype.initialize=function(){for(let t=0;t<this.configs.length;t++)Settings[this.configs[t].variableName]=this.configs[t].obj.script[this.configs[t].scriptName]},Settings.prototype.update=function(t){};var StorageManager=pc.createScript("storageManager");StorageManager.prototype.initialize=function(){StorageManager.Instance=this},StorageManager.prototype.update=function(a){},StorageManager.prototype.setVariable=function(a,e){this.isLocalStorageAvailable()?window.localStorage.setItem(a,e):Debug.log("Storage not available")},StorageManager.prototype.getVariable=function(a,e){return this.isLocalStorageAvailable()&&window.localStorage.getItem(a)||e},StorageManager.prototype.isLocalStorageAvailable=function(){var a="test";try{return window.localStorage.setItem(a,a),window.localStorage.removeItem(a),!0}catch(a){return!1}};var CircleProgressionInfo=pc.createScript("circleProgressionInfo");CircleProgressionInfo.attributes.add("circle",{type:"entity"}),CircleProgressionInfo.attributes.add("bar",{type:"entity"}),CircleProgressionInfo.attributes.add("levelNoTxt",{type:"entity"}),CircleProgressionInfo.attributes.add("chest",{type:"entity"}),CircleProgressionInfo.attributes.add("boss",{type:"entity"}),CircleProgressionInfo.prototype.initialize=function(){},CircleProgressionInfo.prototype.update=function(e){};sc.pc.get2dAvatarTexture=async function get2dAvatarTexture(r,e,t,a,c){if(sc.app){var s=await sc.fetchAvatar2D(e,t,a).catch((r=>console.error(r.message))),n=new Image;n.crossOrigin="anonymous",n.src=s.url,n.onload=function(){var e=new pc.Texture(r.graphicsDevice,{width:a,height:a});e.setSource(n),e.addressU=pc.ADDRESS_CLAMP_TO_EDGE,e.addressV=pc.ADDRESS_CLAMP_TO_EDGE,c(null,e)},n.onerror=function(r){c(r)}}else!function get2dAvatarFromUrl(r,e,t,a,c){var s=pc.string.format("https://render.bitstrips.com/v2/cpanel/{0}-{1}-v1.png?transparent=1&width={2}",t,e,a);r.loader.load(s,"texture",(function(r,e){e&&(e.addressU=pc.ADDRESS_CLAMP_TO_EDGE,e.addressV=pc.ADDRESS_CLAMP_TO_EDGE),c(r,e)}))}(r,e,t,a,c)};var DataManager=pc.createScript("dataManager");DataManager.attributes.add("defaultKick",{type:"string"}),DataManager.attributes.add("isAllFree",{type:"boolean",title:"Is All Free"}),DataManager.attributes.add("fixedKickLevel",{type:"number",title:"Fixed Kick Level"}),DataManager.attributes.add("fixedMultiplier",{type:"number",title:"Fixed Multiplier"}),DataManager.prototype.initialize=function(){DataManager.Instance=this,this.gems=StorageManager.Instance.getVariable("Gems",0),"string"==typeof this.gems&&(this.gems=parseInt(this.gems));let e=this.fixedKickLevel>0?this.fixedKickLevel:1;this.kickLevel=StorageManager.Instance.getVariable("KickLevel",e),"string"==typeof this.kickLevel&&(this.kickLevel=parseInt(this.kickLevel)),this.kickLevelUpgradesBought=StorageManager.Instance.getVariable("KickLevelUpgradesBought",0),"string"==typeof this.kickLevelUpgradesBought&&(this.kickLevelUpgradesBought=parseInt(this.kickLevelUpgradesBought)),e=this.fixedMultiplier>0?this.fixedMultiplier:Settings.upgrade.multiplierStartLevel,this.multiplierLevel=StorageManager.Instance.getVariable("MultiplierLevel",e),"string"==typeof this.multiplierLevel&&(this.multiplierLevel=parseInt(this.multiplierLevel)),this.multiplierUpgradesBought=StorageManager.Instance.getVariable("MultiplierUpgradesBought",0),"string"==typeof this.multiplierUpgradesBought&&(this.multiplierUpgradesBought=parseInt(this.multiplierUpgradesBought));let t=Settings.upgrade.getMultiplier(e);this.lastMaxMultiplier=StorageManager.Instance.getVariable("LastMaxMultiplier",t),"string"==typeof this.lastMaxMultiplier&&(this.lastMaxMultiplier=parseInt(this.lastMaxMultiplier)),Debug.log("lastMaxMultiplier: ",this.lastMaxMultiplier)},DataManager.prototype.setGems=function(e,t){this.gems=t?e:this.gems+e,StorageManager.Instance.setVariable("Gems",this.gems)},DataManager.prototype.upgradeKickLevel=function(e){let t=Settings.upgrade.getKickPrice(this.kickLevel+1);return this.gems-t>=0||this.isAllFree||e?(this.gems-t>=0&&this.setGems(-t),this.kickLevel+=1,this.kickLevelUpgradesBought++,StorageManager.Instance.setVariable("KickLevel",this.kickLevel),StorageManager.Instance.setVariable("KickLevelUpgradesBought",this.kickLevelUpgradesBought),this.app.fire("onKickUp"),!0):(Debug.log("Not enough Gems"),!1)},DataManager.prototype.upgradeMultiplierLevel=function(e){let t=Settings.upgrade.getMultiplierPrice(this.multiplierLevel+1);return this.gems-t>=0||this.isAllFree||e?(this.gems-t>=0&&this.setGems(-t),this.multiplierLevel+=1,this.multiplierUpgradesBought++,StorageManager.Instance.setVariable("MultiplierLevel",this.multiplierLevel),StorageManager.Instance.setVariable("MultiplierUpgradesBought",this.multiplierUpgradesBought),this.app.fire("onMultiUpgraded"),!0):(Debug.log("Not enough Gems"),!1)},DataManager.prototype.upgradeLastMaxMultiplier=function(e){Debug.log("upgradeLastMaxMultiplier",e),this.lastMaxMultiplier=e,StorageManager.Instance.setVariable("LastMaxMultiplier",this.lastMaxMultiplier)},DataManager.prototype.update=function(e){};var MaterialChanger=pc.createScript("materialChanger");MaterialChanger.attributes.add("renderEntiry",{type:"entity"}),MaterialChanger.attributes.add("InitialColorType",{type:"json",schema:[{name:"ColorType",type:"number",enum:[{Green:0},{Blue:1},{Orange:2},{Yellow:3}]}]}),MaterialChanger.prototype.initialize=function(){this.material=this.renderEntiry.render.meshInstances[0].material,this.initialColor=this.renderEntiry.render.meshInstances[0].material.diffuse.clone(),this.emissiveColor=this.renderEntiry.render.meshInstances[0].material.emissive.clone(),this.on("destroy",(function(){this.material.diffuse=this.initialColor,this.material.emissive=this.emissiveColor,this.material.update()}),this)},MaterialChanger.prototype.OnColorChangedRageMode=function(e){e.rage?(this.material.diffuse=e.color,this.material.emissive=e.color):(this.material.diffuse=this.initialColor,this.material.emissive=this.emissiveColor),this.material.update()},MaterialChanger.prototype.update=function(e){};var UpgradeSettings=pc.createScript("upgradeSettings");UpgradeSettings.attributes.add("kickPriceBase",{type:"number",title:"Kick Price Base"}),UpgradeSettings.attributes.add("multiplierPriceBase",{type:"number",title:"Multiplier Price Base"}),UpgradeSettings.attributes.add("priceIncrementStartFactor",{type:"number",title:"Price Increment Start Factor"}),UpgradeSettings.attributes.add("priceIncrementEndFactor",{type:"number",title:"Price Increment End Factor"}),UpgradeSettings.attributes.add("priceIncrementSetps",{type:"number",title:"Price Increment Steps"}),UpgradeSettings.attributes.add("multiplierStartLevel",{type:"number",title:"Multiplier Start Level"}),UpgradeSettings.attributes.add("multiplierBase",{type:"number",title:"Multiplier Base"}),UpgradeSettings.attributes.add("minMultiplier",{type:"number",title:"Min Multiplier"}),UpgradeSettings.attributes.add("multiplierIncrementValue",{type:"number",title:"Multiplier Increment Value"}),UpgradeSettings.attributes.add("multiplierIncrementSteps",{type:"number",title:"Multiplier Increment Steps"}),UpgradeSettings.attributes.add("priceIncrement",{type:"number",title:"Price Increment Random Unlock",default:.5}),UpgradeSettings.prototype.initialize=function(){},UpgradeSettings.prototype.update=function(t){},UpgradeSettings.prototype.getTargetMultiplier=function(t,e){e||(e=1);let i=this.minMultiplier,r=this.multiplierIncrementValue,n=(this.getMultiplier(t)-i)*e+r+i;return parseInt(n/r)*r},UpgradeSettings.prototype.getFlyingDistance=function(t,e){return parseInt((t-1)/this.multiplierIncrementValue)*e},UpgradeSettings.prototype.getStartMutltiplier=function(){return this.getMultiplier(this.multiplierStartLevel)},UpgradeSettings.prototype.getMultiplier=function(t){let e=this.multiplierIncrementValue,i=this.multiplierBase,r=this.multiplierIncrementSteps;for(let n=1;n<t+1;n++){let t=n/r,p=parseInt(t);t=t==p?t:p+1,i+=e*t}return parseInt(i/e)*e},UpgradeSettings.prototype.getKickPrice=function(t){let e=t,r=this.kickPriceBase,n=this.priceIncrementStartFactor,p=this.priceIncrementEndFactor,a=this.priceIncrementSteps;for(i=1;i<e+1;i++){let t=i<a?i/a:1;r*=n+t*t*(p-n)}let l=5;return r>1e4?l=500:r>5e3?l=100:r>1e3?l=50:r>500&&(l=10),parseInt(r/l)*l},UpgradeSettings.prototype.getMultiplierPrice=function(t){let e=t,r=this.multiplierPriceBase,n=this.priceIncrementStartFactor,p=this.priceIncrementEndFactor,a=this.priceIncrementSteps;for(i=1;i<e+1;i++){let t=i<a?i/a:1;r*=n+t*t*(p-n)}let l=5;return r>1e4?l=500:r>5e3?l=100:r>1e3?l=50:r>500&&(l=10),parseInt(r/l)*l},UpgradeSettings.prototype.getMaxPrice=function(t,e){let i=this.getKickPrice(t),r=this.getMultiplierPrice(e);return parseInt(i>r?i:r)};!function(){var t="INDIVIDUAL",a="CONVERSATION",e="STRANGERS",i="FRIENDS",s="Ghostface C",c=["1ead45b2-7e38-48a8-b121-6c998bf1becf","4ab75fc9-fdae-4431-8976-c6571c06fbaf","35e5af98-7e43-4057-a01c-2a80ac85e614","8673bd37-3d91-4f46-a560-6a0931c74f7a","6e21e203-f10d-4d69-ba04-1129671a298a","05a2f2cc-7768-439c-914f-13e0c0527669","c3e2ca7e-6023-42eb-9928-1de03e4874ac","d8145ed9-70aa-4466-814a-04598494ded2","0f2e4758-5d90-4623-9f3c-ee6c3d93aa5c","920770b0-880f-4845-8db5-7160f3c84e9a","e6661449-09a7-4009-81e7-4462f5388228","36f8f3e6-6744-463e-985b-c9e1ccbd1fb1","ef40e498-5324-4eb2-af39-c09587451a85","5c88c5d1-2359-4ea7-83af-fc2743c3fa24","6aa12757-bab8-456f-a125-b6b98742d4a3","4835715c-dbf1-4570-9890-ee6ccc097727","ecce82bd-cd96-498b-a1b5-c0df8a7a527f","7fe0988a-6a73-4416-8e2e-fdbddbae5242","251286c3-4bab-47b7-9641-0ae36c740e70","dca38ce6-6b9c-4859-ac51-c8d8e7f486ee","c44a71d1-7585-4d32-90c6-00076e092afe","a2fd5b4f-9e60-41db-acf9-8e36c45a23ec","9af0dad8-2c45-4972-a1ad-55a7cadbee3b","983c116b-2d63-42d5-b472-3ec7bacdef70","91248c5f-7a25-47e3-b969-36bc8768e8ca"],ScAppData=function(){this.displayName=s,this.avatarId=null,this.conversationSize=-1,this.context=a,this.contextType=null,this.sessionId=null,this.authToken=null,this.state=null},Authorize=function(t){this.appData=new ScAppData,t=t||{},this.fetchTestToken=t.fetchTestToken?t.fetchTestToken:this.fetchTestToken,this.maxNumberOfPlayers=t.maxNumberOfPlayers?t.maxNumberOfPlayers:this.app.maxnumplayers,pc.events.attach(this)};Authorize.prototype.state=function(t){this.appData.state=t},Authorize.prototype.authorize=async function(t){var a=this;this.state("authorize");var e=setTimeout((function(){a.scInitializeFailed(t)}),1e3),i=await sc.initialize().catch((t=>console.error(t.message)));clearTimeout(e),e=null,a.scInitializeSuccess(i)},Authorize.prototype.scInitializeSuccess=function(){this.state("scInitializeSuccess"),sc.app&&(this.appData.displayName=sc.app.user.name,this.appData.conversationSize=sc.app.conversationSize,this.appData.context=sc.app.context,this.appData.sessionId=sc.app.sessionId,this.appData.avatarId=sc.app.user.avatarId,void 0!==this.appData.avatarId&&null!==this.appData.avatarId&&""!==this.appData.avatarId||(this.appData.avatarId=c[Math.floor(pc.math.random(0,c.length))]),this.appData.id=sc.app.user.id,this.appData.authToken=null),this.postScInitialize()},Authorize.prototype.scInitializeFailed=function(t){this.state("scInitializeFailed"),this.appData.displayName=s,this.appData.conversationSize=null,this.appData.context="CONVERSATION",this.appData.sessionId=pc.guid.create(),this.appData.avatarId=c[Math.floor(pc.math.random(0,c.length))],this.appData.authToken=null,this.appData.id=void 0===t?Utils.randomName(10):t,this.postScInitialize()},Authorize.prototype.postScInitialize=async function(){this.state("postScInitialize"),this.appData.context===t?await this.handleIndividualContext():this.appData.context===a&&this.handleConversationContext(),this.fire("authorize:initialized",this.appData)},Authorize.prototype.handleIndividualContext=async function(){await this.setIndividualContextType(sc.pc.SC_CONTEXT_TYPE_PLAYWITHSTRANGERS)},Authorize.prototype.setIndividualContextType=async function(t){this.state("setIndividualContextType"),t===e?(this.appData.contextType=t,await this.playWithStrangers()):t===i&&(this.appData.contextType=t,await this.playWithFriends())},Authorize.prototype.playWithStrangers=async function(){if(this.state("playWithStrangers"),sc.app){await sc.playWithStrangers();this.fetchAuthToken()}else this.fetchAuthToken()},Authorize.prototype.playWithFriends=async function(){if(this.state("playWithFriends"),sc.app){var t=await sc.playWithFriends(this.maxNumberOfPlayers,this);t.error?console.error(t.error):this.playWithFriendsSuccess()}else this.playWithFriendsFail()},Authorize.prototype.playWithFriendsSuccess=function(){this.state("playWithFriendsSuccess"),sc.app&&(this.appData.sessionId=sc.app.sessionId,this.appData.conversationSize=sc.app.conversationSize),this.playWithFriendsComplete()},Authorize.prototype.playWithFriendsFail=function(){this.state("playWithFriendsFail"),this.appData.sessionId="DEFAULT_SESSION_ID",this.appData.conversationSize=-1,this.playWithFriendsComplete()},Authorize.prototype.playWithFriendsComplete=function(){this.state("playWithFriendsComplete"),this.fetchAuthToken()},Authorize.prototype.handleConversationContext=function(){this.state("handleConversationContext"),this.fetchAuthToken()},Authorize.prototype.fetchAuthToken=async function(){if(this.state("fetchAuthToken"),sc.app){let t=await sc.fetchAuthToken().catch((t=>console.error(t.message)));void 0!==t.token?(this.appData.authToken=t.token,this.fetchAuthTokenSuccess()):this.fetchAuthTokenFail()}else this.fetchAuthTokenFail()},Authorize.prototype.fetchTestToken=function(t){this.state("fetchTestToken"),t("DUMMY_AUTH_TOKEN")},Authorize.prototype.fetchAuthTokenSuccess=function(){this.state("fetchAuthTokenSuccess"),this.appData.authToken=sc.app.authToken,this.fetchAuthTokenComplete()},Authorize.prototype.fetchAuthTokenFail=function(){this.state("fetchAuthTokenFail");var t=this;this.fetchTestToken((function(a){t.appData.authToken=a,t.fetchAuthTokenComplete()}))},Authorize.prototype.fetchAuthTokenComplete=function(){this.state("fetchAuthTokenComplete"),this.authorizeComplete()},Authorize.prototype.authorizeComplete=function(){this.state("authorizeComplete"),this.fire("authorize:complete",this.appData)},sc&&(sc.pc||(sc.pc={}),sc.pc.SC_INITIALIZE_TIMEOUT_MS=1e3,sc.pc.SC_CONTEXT_INDIVIDUAL=t,sc.pc.SC_CONTEXT_CONVERSATION=a,sc.pc.SC_CONTEXT_TYPE_PLAYWITHSTRANGERS=e,sc.pc.SC_CONTEXT_TYPE_PLAYWITHFRIENDS=i,sc.pc.Authorize=Authorize)}();var CustomCoroutine=pc.createScript("customCoroutine");CustomCoroutine.prototype.initialize=function(){CustomCoroutine.Instance=this,this.coroutines=[],this.id=0,this.abandonedCoroutines=[],this.abandonAll=!1},CustomCoroutine.prototype.postInitialize=function(){},CustomCoroutine.prototype.update=function(t){this.coroutineTick(t)},CustomCoroutine.prototype.set=function(t,o){let i=this.getId();return this.coroutines.push({func:t,timer:o,id:i}),i},CustomCoroutine.prototype.coroutineTick=function(t){if(0!==this.coroutines.length){for(let o=this.coroutines.length-1;o>-1;o--)this.coroutines[o].timer-=t,this.coroutines[o].timer<=0&&(this.coroutines[o].func(),this.coroutines.splice(o,1));this.implementClear()}},CustomCoroutine.prototype.clear=function(t){this.abandonedCoroutines.push(t)},CustomCoroutine.prototype.clearAll=function(){this.abandonAll=!0},CustomCoroutine.prototype.implementClear=function(){if(this.abandonAll)this.abandonAll=!1,this.coroutines=[];else for(let t=this.abandonedCoroutines.length-1;t>-1;t--){let o=this.coroutines.findIndex((o=>o.id===this.abandonedCoroutines[t]));-1!==o&&this.coroutines.splice(o,1),this.abandonedCoroutines.splice(t,1)}},CustomCoroutine.prototype.getId=function(){return this.id++,this.id>1e3&&(this.id=0),this.id};var ChestModifier=pc.createScript("chestModifier");ChestModifier.attributes.add("info",{type:"json",schema:[{name:"health",type:"number",default:100},{name:"position",type:"vec3",default:[0,0,6]},{name:"patchIndex",type:"number"}]}),ChestModifier.prototype.initialize=function(){},ChestModifier.prototype.update=function(e){};var GameManager=pc.createScript("gameManager");GameManager.attributes.add("gameSpeedChangeSteps",{type:"number",title:"Game Speed Change Steps"}),GameManager.prototype.initialize=function(){GameManager.Instance=this,this.gameSpeed=1,this.targetGameSpeed=1,this.lerpVal=0,this.speedFactor=1},GameManager.prototype.update=function(e){this.manageGameSpeed(e)},GameManager.prototype.setGameSpeed=function(e){let a=Math.abs(this.gameSpeed-this.targetGameSpeed);0===a?this.speedFactor=1:this.speedFactor*=1/a,this.startingGameSpeed=this.gameSpeed,this.targetGameSpeed=e,this.lerpVal=0},GameManager.prototype.manageGameSpeed=function(e){this.gameSpeed===this.targetGameSpeed||this.lerpVal>=1||(this.lerpVal+=e*this.gameSpeedChangeSteps*this.speedFactor,this.gameSpeed=pc.math.lerp(this.startingGameSpeed,this.targetGameSpeed,this.lerpVal),this.lerpVal>=1&&(this.gameSpeed=this.targetGameSpeed),this.app.timeScale=this.gameSpeed)};// sc-is-dev.js
// (function () {
//     if (('sc' in window)) {
//         var application = pc.Application.getApplication();

//         console.log('bridge', sc._b);
//         setInterval(() => console.log('bridge', sc._b), 1000);
//     }
// }());


var FinishTrackSettings=pc.createScript("finishTrackSettings");FinishTrackSettings.attributes.add("generalSettings",{title:"General Settings",type:"json",schema:[{name:"bossOffset",type:"vec3",title:"Boss Offset"},{name:"bossMinZOffset",type:"number",title:"Boss Min Z Offset"},{name:"bossMaxZOffset",type:"number",title:"Boss Max Z Offset"},{name:"cullingDistance",type:"number",title:"Culling Distance"},{name:"segmentSize",type:"number",title:"Segment Size"},{name:"maxSegments",type:"number",title:"Max Segments"},{name:"powerBase",type:"number",title:"Power Base"},{name:"smokeEffectDuration",type:"number",title:"Smoke Effect Duration"},{name:"bossLevelForMaxScale",type:"number",title:"Boss Level For Max Scale"},{name:"miniBossForwardOffset",type:"number",title:"Mini Boss Forward Offset"},{name:"biggBossForwardOffset",type:"number",title:"Bigg Boss Forward Offset"}]}),FinishTrackSettings.attributes.add("flyingSettings",{title:"Flying Settings",type:"json",schema:[{name:"flyingDelay",type:"number",title:"Flying Delay"},{name:"flyingCameraDelay",type:"number",title:"Flying Camera Delay"},{name:"flyingDurationByMeter",type:"number",title:"Flying Duration By Meter"},{name:"flyingWindFromDuration",type:"number",title:"Flying Wind From Duration"},{name:"flyingDurationRange",type:"vec2",title:"Flying Duration Range"},{name:"breakWallSlowMoSpeed",type:"number",title:"Break Wall SlowMo Speed"},{name:"breakWallSlowMoDuration",type:"number",title:"Break Wall SlowMo Duration"}]}),FinishTrackSettings.attributes.add("ragdollPresets",{title:"Ragdoll Presets",type:"json",schema:[{name:"maxDistance",type:"number",title:"Max Distance"},{name:"speed",type:"number",title:"Speed"},{name:"soundPoints",type:"string",title:"Sound Points",description:"Comman Seperated values to play sound at points when playing animation",array:!0},{name:"animationNames",type:"string",title:"Animation Names",array:!0},{name:"data",type:"vec2",title:"Distance/Duration",array:!0}],array:!0}),FinishTrackSettings.attributes.add("wallRagdollPresets",{title:"Wall Ragdoll Presets",type:"json",schema:[{name:"maxDistance",type:"number",title:"Max Distance"},{name:"speed",type:"number",title:"Speed"},{name:"soundPoints",type:"string",title:"Sound Points",description:"Comman Seperated values to play sound at points when playing animation",array:!0},{name:"animationNames",type:"string",title:"Animation Names",array:!0},{name:"data",type:"vec2",title:"Distance/Duration",array:!0}]}),FinishTrackSettings.prototype.initialize=function(){this.wallPresetNameIndex=1,this.presetNameIndex=0},FinishTrackSettings.prototype.update=function(e){},FinishTrackSettings.prototype.getWallRagdollPresetData=function(){return this.wallPresetNameIndex%=this.wallRagdollPresets.animationNames.length,{name:`W${this.wallPresetNameIndex+1}`,speed:this.wallRagdollPresets.speed,soundPoints:this.wallRagdollPresets.soundPoints[this.wallPresetNameIndex],distance:this.wallRagdollPresets.data[this.wallPresetNameIndex].x,duration:this.wallRagdollPresets.data[this.wallPresetNameIndex++].y}},FinishTrackSettings.prototype.getRagdollPresetData=function(e,t){return this.presetNameIndex%=this.ragdollPresets[t-1].animationNames.length,{name:`${t}${this.presetNameIndex+1}`,speed:this.ragdollPresets[t-1].speed,soundPoints:this.ragdollPresets[t-1].soundPoints[this.presetNameIndex],distance:this.ragdollPresets[t-1].data[this.presetNameIndex].x,duration:this.ragdollPresets[t-1].data[this.presetNameIndex++].y}};var ChestContainer=pc.createScript("chestContainer");ChestContainer.attributes.add("template",{type:"entity"}),ChestContainer.prototype.initialize=function(){ChestContainer=this},ChestContainer.prototype.update=function(t){};!function(){sc.pc.INITIALIZE_TIMEOUT_MS=1e3,sc.pc.CONTEXT_INDIVIDUAL="INDIVIDUAL",sc.pc.CONTEXT_CONVERSATION="CONVERSATION",sc.pc.CONTEXT_TYPE_PLAYWITHSTRANGERS="STRANGERS",sc.pc.CONTEXT_TYPE_PLAYWITHFRIENDS="FRIENDS";var t="Ghostface Chillah",e="#fffc00",i=sc.pc.CONTEXT_INDIVIDUAL,ScAppData=function(){this.displayName=t,this.color=(new pc.Color).fromString(e),this.avatarId=null,this.conversationSize=-1,this.context=sc.pc.CONTEXT_CONVERSATION,this.contextType=null,this.sessionId=null,this.authToken=null,this.state=null},Setup=function(t){this.appData=new ScAppData,t=t||{},this.fetchTestToken=t.fetchTestToken?t.fetchTestToken:this.fetchTestToken,this.maxNumberOfPlayers=t.maxNumberOfPlayers?t.maxNumberOfPlayers:2,this.log=new sc.pc.Log("AUTHORIZE",!!t.log&&t.log),pc.events.attach(this)};Setup.prototype.state=function(t){this.log.info(t),this.appData.state=t},Setup.prototype.initialize=async function(){var t=this;this.state("initialize");var e=setTimeout((function(){t.scInitializeFailed("sc.initialize timeout")}),sc.pc.INITIALIZE_TIMEOUT_MS),i=await sc.initialize().catch((t=>console.error(t.message)));i.error?this.sc.InitializeFailed("sc.initialize error: "+i.error):(clearTimeout(e),e=null,t.scInitializeSuccess(i))},Setup.prototype.scInitializeSuccess=function(){this.state("scInitializeSuccess"),sc.app&&(this.appData.displayName=sc.app.user.name,this.appData.color=(new pc.Color).fromString(sc.app.user.color),this.appData.conversationSize=sc.app.conversationSize,this.appData.context=sc.app.context,this.appData.sessionId=sc.app.sessionId,this.appData.avatarId=sc.app.user.avatarId,this.appData.authToken=null),this.postScInitialize()},Setup.prototype.scInitializeFailed=function(s){this.state("scInitializeFailed"),this.log.error(s),this.appData.displayName=t,this.appData.color=(new pc.Color).fromString(e),this.appData.conversationSize=null,this.appData.context=i,this.appData.sessionId=null,this.appData.avatarId=null,this.appData.authToken=null,this.postScInitialize()},Setup.prototype.postScInitialize=function(){this.state("postScInitialize"),this.fire("initialize",this.appData),this.appData.context===sc.pc.CONTEXT_INDIVIDUAL?this.handleIndividualContext():this.appData.context===sc.pc.CONTEXT_CONVERSATION&&this.handleConversationContext()},Setup.prototype.handleIndividualContext=function(){this.state("handleIndividualContext"),this.fire("waitforinput")},Setup.prototype.setIndividualContextType=function(t){this.state("setIndividualContextType"),t===sc.pc.CONTEXT_TYPE_PLAYWITHSTRANGERS?(this.appData.contextType=t,this.playWithStrangers()):t===sc.pc.CONTEXT_TYPE_PLAYWITHFRIENDS&&(this.appData.contextType=t,this.playWithFriends())},Setup.prototype.playWithStrangers=async function(){if(this.state("playWithStrangers"),sc.app){await sc.playWithStrangers().catch((t=>console.error(t.message)));this.fetchAuthToken()}else this.fetchAuthToken()},Setup.prototype.playWithFriends=async function(){if(this.state("playWithFriends"),sc.app){var t=await sc.playWithFriends(this.maxNumberOfPlayers).catch((t=>console.error(t.message)));t.error?console.error(t.error):this.playWithFriendsSuccess()}else this.playWithFriendsFail()},Setup.prototype.playWithFriendsSuccess=function(){this.state("playWithFriendsSuccess"),this.appData.color=(new pc.Color).fromString(sc.app.color),this.appData.sessionId=sc.app.sessionId,this.appData.conversationSize=sc.app.conversationSize,this.playWithFriendsComplete()},Setup.prototype.playWithFriendsFail=function(){this.state("playWithFriendsFail"),this.appData.color=(new pc.Color).fromString(e),this.appData.sessionId="DEFAULT_SESSION_ID",this.appData.conversationSize=-1,this.playWithFriendsComplete()},Setup.prototype.playWithFriendsComplete=function(){this.state("playWithFriendsComplete"),this.fetchAuthToken()},Setup.prototype.handleConversationContext=function(){this.state("handleConversationContext"),this.fetchAuthToken()},Setup.prototype.fetchAuthToken=function(){this.state("fetchAuthToken"),sc.app?sc.fetchAuthToken(this.fetchAuthTokenSuccess,this):this.fetchAuthTokenFail()},Setup.prototype.fetchTestToken=function(t){this.state("fetchTestToken"),t("DUMMY_AUTH_TOKEN")},Setup.prototype.fetchAuthTokenSuccess=function(){this.state("fetchAuthTokenSuccess"),this.appData.authToken=sc.app.authToken,this.fetchAuthTokenComplete()},Setup.prototype.fetchAuthTokenFail=function(){this.state("fetchAuthTokenFail");var t=this;this.fetchTestToken((function(e){t.appData.authToken=e,t.fetchAuthTokenComplete()}))},Setup.prototype.fetchAuthTokenComplete=function(){this.state("fetchAuthTokenComplete"),this.authorizeComplete()},Setup.prototype.authorizeComplete=function(){this.state("authorizeComplete"),this.fire("complete",this.appData)},sc.pc.Setup=Setup}();var ChestController=pc.createScript("chestController");ChestController.attributes.add("animObject",{type:"entity"}),ChestController.prototype.initialize=function(){this.begins=!1,this.delay=this.maxDelay=.5,this.app.on(Events.OnAttack,this.OnAttack,this),this.app.on(Events.OnBonusSequenceBegins,this.OnBonusSequenceBegins,this),this.app.on(Events.OnBonusSequenceCompleted,this.OnBonusSequenceCompleted,this),this.on("destroy",(function(){this.app.off(Events.OnAttack,this.OnAttack,this),this.app.off(Events.OnBonusSequenceBegins,this.OnBonusSequenceBegins,this),this.app.off(Events.OnBonusSequenceCompleted,this.OnBonusSequenceCompleted,this)}),this)},ChestController.prototype.OnAttack=function(){this.begins&&(Debug.log("ChestController ---\x3e OnAttack"),this.animObject.anim.baseLayer.play("Damage"))},ChestController.prototype.OnBonusSequenceBegins=function(){this.begins=!0},ChestController.prototype.OnBonusSequenceCompleted=function(){this.begins&&(this.begins=!1,this.animObject.anim.baseLayer.play("Open"))},ChestController.prototype.update=function(t){},ChestController.prototype.prepare=function(t){this.entity.setLocalPosition(t.position)};!function(){function textureToCanvas(e){var r=e.device;if(!r)throw Error("Texture has no GraphicsDevice");var t=new pc.RenderTarget({colorBuffer:e,depth:!1}),a=e.width,n=e.height,o=r.renderTarget;r.setRenderTarget(t),r.updateBegin();var c=new Uint8Array(4*a*n);r.readPixels(0,0,a,n,c),r.updateEnd(),r.setRenderTarget(o);var u=document.createElement("canvas");u.width=a,u.height=n;for(var d=u.getContext("2d"),i=new Uint8ClampedArray(c.length),s=0;s<n;s++)for(var T=0;T<a;T++){var p=4*(T+s*a),v=4*(T+(n-1-s)*a);i[v+0]=c[p+0],i[v+1]=c[p+1],i[v+2]=c[p+2],i[v+3]=c[p+3]}var h=new ImageData(i,a,n);return d.putImageData(h,0,0),u}sc.pc.textureToCanvas=textureToCanvas,sc.pc.textureToDataUrl=function textureToDataUrl(e){return textureToCanvas(e).toDataURL()},sc.pc.renderLayersToTexture=function renderLayersToTexture(e,r,t){var a=new pc.RenderTarget({colorBuffer:t,depth:!0}),n=new pc.LayerComposition,o=[];r.forEach((function(e){o.push(e.renderTarget),e.renderTarget=a,n.push(e),e.cameras[0].calculateAspectRatio(a)})),e.renderer.renderComposition(n),r.forEach((function(e,r){n.remove(e),e.renderTarget=o[r]}))}}();var BonusSequenceHandler=pc.createScript("bonusSequenceHandler");BonusSequenceHandler.prototype.initialize=function(){this.app.on(Events.OnFinishLineReached,this.OnFinishLineReached,this),this.app.on(Events.OnBonusSequenceCompleted,this.OnBonusSequenceCompleted,this)},BonusSequenceHandler.prototype.OnBonusSequenceCompleted=function(){Debug.log("BonusSequenceHandler ---\x3e OnBonusSequenceCompleted"),this.app.fire(Events.OnChangeMenuState,MenuManager.States.BlankScreen),this.app.fire(Events.OnChangeCameraState,CameraState.Mainmenu,2.5,!1);let e=this;setTimeout((function(){e.app.fire(Events.OnChangeMenuState,MenuManager.States.Win)}),3e3)},BonusSequenceHandler.prototype.OnFinishLineReached=function(){LevelInfo.isBonusLevel&&(Debug.log("BonusSequenceHandler ---\x3e OnFinishLineReached"),this.app.fire(Events.OnChangeMenuState,MenuManager.States.BonusView),this.app.fire(Events.OnChangeCameraState,CameraState.Fight,5),this.app.fire(Events.OnBonusSequenceBegins))},BonusSequenceHandler.prototype.update=function(e){};// sc-pc-loading.js
//(function () {
//    if (('sc' in window)) {
//        var application = pc.Application.getApplication();
//        
//        application.on('preload:progress', function (value) {
//            value = Math.min(1, Math.max(0, value));
//            try {
//                sc.setLoadingProgress(value);
//            } catch (e) {
//                // no SDK loaded
//            }
//        }, this);
//        
//        application.once('postrender', function () {
//            try {
//                console.log("[Snapchat] Loading Complete");
//                sc.loadingComplete();
//            } catch (e) {
//                // no SDK loaded
//            }
//        }, this);
//    }
//}());


var BonusViewController=pc.createScript("bonusViewController");BonusViewController.attributes.add("tapButton",{type:"entity"}),BonusViewController.attributes.add("fingerImg",{type:"entity"}),BonusViewController.attributes.add("bossMenuComponents",{type:"json",title:"Menu Components",schema:[{name:"timerBar",title:"Power bar ref",type:"entity"},{name:"bonusMultiplierBar",type:"entity",title:"Bonus Multiplier Bar"}]}),BonusViewController.Instance=null,BonusViewController.prototype.initialize=function(){BonusViewController.Instance=this,this.maxtimerBarWidth=this.bossMenuComponents.timerBar.element.width,this.timerBarVal=0,this.minFill=1,this.incrementFill=35,this.emptySpeed=1,this.multiplier=0,this.isTappingAllowed=!0,this.tapButton.button.on("click",this.OnTap,this),this.app.on(Events.OnBonusSequenceBegins,this.OnBonusSequenceBegins,this),this.app.on(Events.OnBonusSequenceCompleted,this.OnBonusSequenceCompleted,this),TweenWrapper.Tween(this.fingerImg,this.fingerImg.getLocalScale(),new pc.Vec3(.8,.8,.8),.4,void 0,pc.SineIn,!0,!0),this.on("enable",this.reset,this),this.canAttack=!0,this.attackDelay=.5,this.maxAttackDelay=.5},BonusViewController.prototype.reset=function(){this.timerBarVal=0,this.canAttack=!0,this.isTappingAllowed=!0,this.multiplier=0,this.bossMenuComponents.timerBar.element.width=this.maxtimerBarWidth,this.setTimeOut()},BonusViewController.prototype.setMultiplier=function(t){this.bossMenuComponents.bonusMultiplierBar.fire("SetMultiplier",t)},BonusViewController.prototype.setTimeOut=function(){this.bossMenuComponents.bonusMultiplierBar.fire("SetTimeOut")},BonusViewController.prototype.OnBonusSequenceCompleted=function(){this.canAttack=!1,this.isTappingAllowed=!1},BonusViewController.prototype.OnBonusSequenceBegins=function(){this.isTappingAllowed=!0},BonusViewController.prototype.OnTap=function(){if(this.isTappingAllowed){if(this.canAttack){this.canAttack=!1;this.bossMenuComponents.timerBar.element.width,this.emptySpeed;this.minFill,this.app.fire(Events.OnAttack,{target:AttackTarget.Chest,attack:Math.floor(getRandomArbitrary(0,2))}),this.multiplier++,this.setMultiplier(this.multiplier),this.attackDelay=this.maxAttackDelay}Debug.log("BonuseViewController ---\x3e OnTap")}},BonusViewController.prototype.update=function(t){if(this.isTappingAllowed){let i=this.bossMenuComponents.timerBar.element.width-this.emptySpeed;if(i-this.emptySpeed<=this.minFill){this.canAttack=!1,this.isTappingAllowed=!1,this.bossMenuComponents.timerBar.element.width=this.minFill,this.app.fire("FightView:MultiplierTimerOver");var e=this;setTimeout((function(){e.app.fire(Events.OnBonusSequenceCompleted)}),2e3)}else i>this.minFill&&(this.bossMenuComponents.timerBar.element.width=i,this.timerBarVal=changeRange(i,0,this.maxtimerBarWidth,0,1),this.attackDelay-=t,this.attackDelay<0&&!this.canAttack&&(this.canAttack=!0,this.attackDelay=this.maxAttackDelay))}};var CLIENT_STATUS_DISCONNECTED=0,CLIENT_STATUS_CONNECTING=1,CLIENT_STATUS_CONNECTED=2,CLIENT_STATUS_ERROR=4,Client=function(t){this.authToken=null,this.status=CLIENT_STATUS_DISCONNECTED,this.log=new Log("CLIENT",!!t.log&&t.log),pc.events.attach(this)};Client.prototype.setToken=function(t){if(this.log.info("setToken"),this.status!==CLIENT_STATUS_DISCONNECTED)throw Error("Token must be set while disconnected")},Client.prototype.connect=function(t){this.log.info("connect"),this.status=CLIENT_STATUS_CONNECTING,setTimeout(function(){this.log.info("connected"),this.status=CLIENT_STATUS_CONNECTED,t(null),this.fire("client:status",this.status,this),this.fire("client:status:connected",this)}.bind(this),3e3)};var BitmojiManager=pc.createScript("bitmojiManager");BitmojiManager.attributes.add("loadBitmoji",{type:"boolean",default:!0,title:"Load Bitmoji",description:"Disable this to test no bitmoji case."}),BitmojiManager.prototype.initialize=function(){BitmojiManager.instance=this,this.bitmojiData={asset:null,faceTextures:null,dataUtilized:!1},this.callsCount=0,this.app.on(this.app.event.sc.initialiced,this.onAppDataRecieved,this)},BitmojiManager.prototype.onAppDataRecieved=function(t){var i=t.avatarId,a=this.app.isDevLaunch();this.loadBitmoji&&sc.pc.get3dAvatar(i,a,this.on3DAvartarRecieved.bind(this))},BitmojiManager.prototype.on3DAvartarRecieved=function(t,i){var a=function(t,i){t?this._log.error(t):this._bitmojiAsset=i,this._destroyed?this._unloadBitmojiAsset():(BitmojiManager.instance.bitmojiData.asset=i,this.asyncCallsHandler())}.bind(this),e=function(t,i){t&&this._log.error(t),this._faceTextureAssets=i,this._destroyed?this._unloadFaceTextures():(BitmojiManager.instance.bitmojiData.faceTextures=i,this.asyncCallsHandler())}.bind(this);t||loadBitmoji3d(i,a,e)},BitmojiManager.prototype._unloadFaceTextures=function(){if(this._faceTextureAssets)for(var t=0;t<this._faceTextureAssets.length;++t)this._faceTextureAssets[t].unload(),this.app.assets.remove(this._faceTextureAssets[t]);this._faceTextureAssets=null},BitmojiManager.prototype.asyncCallsHandler=function(){this.callsCount++,2===this.callsCount&&this.bitmojiData.dataUtilized&&(this.bitmojiData.dataUtilized=!0,this.app.fire(this.app.event.managers.onBitmojiReady))};var ScManager=pc.createScript("scManager");const urlIdField="conversationId";ScManager.attributes.add("inviteImage",{type:"asset",assetType:"texture"}),ScManager.attributes.add("fixedID",{type:"string",title:"Fixed ID",description:"Leave this field empty to use random ID"}),ScManager.prototype.initialize=function(){ScManager.instance=this,this.score=0,this._authorize=null,this.appData=null,this.avatarTexture=null,this.avatar3dModelAsset=null,this.avatar3dDefaultAnimAssets=[],this.conversationID=null,this.playWithFriendsState=!1,this.setMaxNumOfPlayers(),this.initialized=!1},ScManager.prototype.setMaxNumOfPlayers=function(){ScManager.instance._authorize=new sc.pc.Authorize({maxNumberOfPlayers:this.app.maxnumplayers,log:!0})},ScManager.prototype.OnManagersLoadingComplete=async function(){ScManager.instance._authorize.on("authorize:initialized",ScManager.instance.onInitialized,this),await ScManager.instance._authorize.authorize(this.fixedID.length>0?this.fixedID:void 0)},ScManager.prototype.loadAvatarTexture=function(){ScManager.instance.appData.avatarId||(ScManager.instance.appData.avatarId=this.app.DefaultBitmoji),ScManager.instance.appData.avatarId&&sc.pc.get2dAvatarTexture(this.app,ScManager.instance.appData.avatarId,sc.AvatarVariants.DEFAULT,ScManager.instance.app.avatarsize,function(a,e){a?console.error(a):(ScManager.instance.avatarTexture=e,this.app.fire("SC:setAvatarTexture"))}.bind(this))},ScManager.prototype.onInitialized=function(a){Debug.log("ScManager Initiliced user id:"+a.id),ScManager.instance.appData=a,ScManager.instance.setConversationID(),"authorizeComplete"==ScManager.instance.appData.state?ScManager.instance.app.fire(ScManager.instance.app.event.sc.initialiced,ScManager.instance.appData):ScManager.instance._authorize.once("authorize:complete",(function(){ScManager.instance.app.fire(ScManager.instance.app.event.sc.initialiced,ScManager.instance.appData)}),self),ScManager.instance.loadAvatarTexture(),ScManager.instance.initialized=!0},ScManager.prototype.playWithStrangers=async function(){await ScManager.instance._authorize.setIndividualContextType(sc.pc.SC_CONTEXT_TYPE_PLAYWITHSTRANGERS)},ScManager.prototype.playWithFriends=async function(){await ScManager.instance._authorize.setIndividualContextType(sc.pc.SC_CONTEXT_TYPE_PLAYWITHFRIENDS)},ScManager.prototype.setConversationID=async function(){if(this.app.isDevLaunch()){let a=ScManager.instance.getUrlId();ScManager.instance.conversationID=a||DevelopmentStreamId.id,ScManager.instance.playWithFriendsState=!0,this.app.fire(this.app.event.sc.sessionIdReady,ScManager.instance.conversationID),this.app.fire(this.app.event.sc.conversationIdReady,ScManager.instance.conversationID)}else{var a=this;sc.getShareInfo().then((function(e){let n=ScManager.instance.getUrlId();if(""!==n)ScManager.instance.conversationID=n,ScManager.instance.playWithFriendsState=!0,a.app.fire(a.app.event.sc.sessionIdReady,ScManager.instance.conversationID);else if(null!=e&&void 0!==e.shareInfo){let n=e.shareInfo.payload;ScManager.instance.conversationID=n.conversationID,ScManager.instance.playWithFriendsState=!0,a.app.fire(a.app.event.sc.sessionIdReady,ScManager.instance.conversationID)}else a.evaluateChatOrDiscovery(a);a.app.fire(a.app.event.sc.conversationIdReady,ScManager.instance.conversationID)})).catch((function(e){let n=ScManager.instance.getUrlId();""!==n?(ScManager.instance.conversationID=n,ScManager.instance.playWithFriendsState=!0,a.app.fire(a.app.event.sc.sessionIdReady,ScManager.instance.conversationID)):a.evaluateChatOrDiscovery(a),a.app.fire(a.app.event.sc.conversationIdReady,ScManager.instance.conversationID)}))}},ScManager.prototype.evaluateChatOrDiscovery=function(a){""!==ScManager.instance.appData.sessionId&&void 0!==ScManager.instance.appData.sessionId&&null!==ScManager.instance.appData.sessionId?(ScManager.instance.conversationID=ScManager.instance.appData.sessionId,ScManager.instance.playWithFriendsState=!0,a.app.fire(a.app.event.sc.sessionIdReady,ScManager.instance.conversationID)):(ScManager.instance.conversationID=ScManager.instance.appData.id,ScManager.instance.playWithFriendsState=!1,a.app.fire(a.app.event.sc.sessionIdNotReady,""))},ScManager.prototype.getUrlId=function(){let a=window.location.href;return a.indexOf(urlIdField)>-1?a.slice(a.indexOf(urlIdField)+urlIdField.length+1):""},ScManager.prototype.ShareConversationId=async function(){if(ScManager.instance.playWithFriendsState){var a="/"+this.inviteImage.getFileUrl(),e=a.indexOf("?");e>-1&&(a=a.substring(0,e));var n={conversationID:ScManager.instance.conversationID},t={primaryImageUrl:a,headline:"Crazy Sales Rush!!",description:ScManager.instance.appData.displayName+" invited you to the Crazy Sales Rush!\n",actionCta:"Join Party"},i={path:"/",payload:n};await sc.shareAppToChat(t,null,i).catch((a=>console.error(a.message)))}else{await ScManager.instance.playWithFriends();ScManager.instance._authorize.once("authorize:complete",(function(a){""!==ScManager.instance.appData.sessionId?(ScManager.instance.playWithFriendsState=!0,ScManager.instance.conversationID=ScManager.instance.appData.sessionId,ServerManager.instance.joinToTheStream(),ScManager.instance.app.fire(ScManager.instance.app.event.sc.sessionIdReady,ScManager.instance.conversationID)):Debug.log("sessionID null!! %o",a)}),self)}};var Globals=pc.createScript("globals");Globals.prototype.initialize=function(){var e=this;this.app.VERSION_NUMBER="0.2.62",this.app.PROD_BUILD=!0,this.app.releaseNames={Dev:"dev",Prod:"prod"},this.app.adsToUnlockSkills=5,this.app.adWaitTime=60,this.app.glowWaitTime=3,this.app.initialCoins=200,this.app.botCastSkillMinTime=20,this.app.botCastSkillMaxTime=40,this.app.resetNewPlayerFlag=259200,this.app.SkillsEnum={Ghost:0,Thief:1,Banana:2,Invincible:3,Freeze:4,Zombie:5,Grappler:6,FakeBox:7,Umbrella:8,Random:9},this.app.tags={all:"All",level1:"Maze1",level2:"Maze2",level3:"Maze3",soundsMenu:"SoundsMenu",colliderEnter:"BorderIn"},this.app.screens={Loading:"LoadingScene",Menu:"MenuScene",Match:"MatchScene"},this.app.deviceType={Low:"Low",Mid:"Mid",High:"High",None:"None"},this.app.skills={Ghost:"Ghost",Thief:"Thief",Banana:"Banana",Invincible:"Invincible",Freeze:"Freeze",Zombie:"Zombie",Grappler:"Grappler",FakeBox:"FakeBox",Umbrella:"Umbrella",Stun:"Stun",FallingBox:"FallingBox",CollectBox:"CollectBox"},this.app.skills.attributes={maxEquipeCount:3,watchad:.85,upgradeCost:200,texts:{free:"FREE",watchAd:"WATCH AD"}},this.app.fx={Box:"Box",Ghost:"Ghost",Thief:"Thief",Banana:"Banana",Invincible:"Invincible",Freeze:"Freeze",Zombie:"Zombie",Grappler:"Grappler",FakeBox:"FakeBox",Umbrella:"Umbrella",Stun:"Stun",Confetti:"Confetti"},this.app.skills.destination={Self:"self",ClosestOpponent:"closestOpponent",AllOpponents:"allOpponents",ClosestBox:"closestBox"},this.app.endOfRoundsAnimations={ShowedEndOfRound:"RoundsAnimations:ShowedEndOfRound",ShowLeaderBoard:"RoundsAnimations:ShowLeaderBoard",ShowedNextRound:"RoundsAnimations:ShowedNextRound"},this.app.alteredStates={None:"None",Invincible:this.app.skills.Invincible,Ghost:this.app.skills.Ghost,Zombie:this.app.skills.Zombie,Freeze:this.app.skills.Freeze,Stun:this.app.skills.Stun,Thief:this.app.skills.Thief,FakeBox:this.app.skills.FakeBox,Banana:this.app.skills.Banana,Umbrella:this.app.skills.Umbrella,Grappler:this.app.skills.Grappler,FallingBox:this.app.skills.FallingBox,CollectBox:this.app.skills.CollectBox,Skating:"skating",Lose:"lose",Win:"win"},this.app.animations={IDLE:"idle",RUN:"run",CARRY:"carry",SKATING:"skating",FREEZE:"freeze",STUN:"stun",BANANA:"banana",FAKEBOX:"fakebox",INVINCIBLE:"invincible",WIN:"win",LOSE:"lose",ZOMBIE:"zombie",UMBRELLA:"umbrella",GRAPPLE_PULLED:"grapplerpulled",GRAPPLE_SHOOT:"grapplershoot"},this.app.multiplayer={operations:{join:1,updatePlayer:2,spawnObject:3,updateObject:4,pickpackage:5,deliverpackage:6,stolepackage:7,affectedskill:8,leave:9,end:10,countdown:11,presencemeta:12,requestEntitySync:13,sendEntitySync:14,changeGameState:15,roundCountdown:16,hostChange:17,leaderboard:18,spawnStartPackages:19,sendSyncro:20,removeBot:21},streamoperation:{join:1,startcountdown:2,playerlist:3,playpress:4,endgame:5,quit:6,countdown:11}},this.app.vars={stars:{chestOpeningCount:100,reward:{packageDelivered:1,default:10,levelPromotion:5,picked:1}}},this.app.event={player:{ready:"player:ready",move:"player:move",updateTransform:"player:updateTransform",updateAnimation:"player:updateAnimation",deliver:"player:deliver"},sound:{playMusic:"sound:playmusic",stopMusic:"sound:stopmusic",playSound:"sound:playsound",stopSound:"sound:stopsound",load:"sound:load"},game:{start:"game:start",gameover:"game:gameover",changeState:"game:changeState"},loading:{enable:"loading:enable",disable:"loading:disable",refresh:"loading:refresh",sceneloaded:"loading:sceneloaded",levelloaded:"loading:levelloaded"},vjoy:{move:"tapsinput:move",up:"tapsinput:up",down:"tapsinput:down"},stars:{refresh:"stars:refresh",refreshInGame:"stars:refreshInGame",addStars:"stars:addStars",addIngameStars:"stars:addIngameStars",addInGameStarsToRealWallet:"stars:addInGameStarsToRealWallet",resetIngame:"stars:resetIngame"},sc:{initialiced:"sc:initialiced",avatarTextureReady:"sc:avatarTextureReady",avatar3dReady:"sc:avatar3dReady",bodyloading:"sc:avatar3dReady",bodyloaded:"sc:avatar3dReady",facesloaded:"sc:facesloaded",conversationIdReady:"sc:conversationIdReady",sessionIdReady:"sc:sessionIdReady",sessionIdNotReady:"sc:sessionNotIdReady"},managers:{loadingComplete:"managers:loadingComplete",loadBitmoji:"loadBitmoji",onBitmojiReady:"onBitmojiId",dataloaded:"dataloaded",gameDataLoaded:"gameDataLoaded",soundManagerLoaded:"soundManagerLoaded"},client:{status:"client:status",statusconnected:"client:status:connected",hostRecognized:"client:hostrecognized",visibilityChange:"client:visibilityChange"},match:{start:"match:start",end:"match:end",ready:"match:ready",join:"match:join",updateOpponent:"match:updateOpponent",spawnObject:"match:spawnObject",updateObject:"match:updateObject",pickpackage:"match:pickpackage",pickstar:"match:pickstar",deliverpackage:"match:deliverpackage",stolepackage:"match:stolepackage",leave:"match:leave",levelloaded:"match:levelloaded",affectedskill:"match:affectedskill",countdown:"match:countdown",presencemeta:"match:presencemeta",requestEntitySync:"match:requestentitysync",receiveEntitySync:"match:receiveentitysync",timer:"match:timer",stars:"match:stars",roundCountdown:"match:roundcountdown",enabletimer:"match:enabletimer",minBoxes:"match:minBoxes",maxBoxes:"match:maxBoxes",hostChange:"match:hostChange",leaderboard:"match:leaderboard",spawnStartPackages:"match:spawnstartpackages",sendSyncro:"match:sentsyncro",removeBot:"match:removebot",showTutorial:"match:showTutorial",showTutorialPopup:"match:showTutorialPopup",showTutorialSkill:"match:showTutorialSkill",hideTutorialText:"match:hideTutorialText",changeSkill:"match:changeSkill",disableArrows:"match:disableArrows",enableArrows:"match:enableArrows"},entity:{activateObstacle:"entity:activeObstacle",deactivateObstacle:"entity:deactiveObstacle",sendSync:"entity:sendSync",receiveSync:"entity:receiveSync"},stream:{join:"stream:join",leave:"stream:leave",playpress:"stream:playpress",countdown:"stream:countdown",endgame:"stream:endgame",quit:"stream:quit"},UIEventListeners:{mainMenuEventListener:{setAvatarImage:"setAvatarImage",setCoinsTxt:"setCoinsTxt",unableToJoinPopupCancel:"unableToJoinPopupCancel",enableShop:"enableShop",mainMenuLoaded:"mainmenuloaded",loadMainMenuSkill:"loadMainMenuSkill",loadMainMenuBalloon:"loadMainMenuBalloon"},skillsMenu:{refreshSkills:"refreshSkills"},gameplayMenu:{enableSkills:"enableSkills"},chestRewardMenu:{begin:"chestRewardMenu: begin"}},skills:{use:"skills:use",upgrade:"skills:upgrade",remove:"skills:remove",replace:"skills:replace",selected:"skills:selected",forceCooldown:"skills:forceCooldown",enabled:"skills:enabled",refreshcards:"skills:refreshcards"},leaderboard:{refresh:"leaderboard:refresh",updatePlayer:"leaderboard:updatePlayer",setState:"leaderboard:setState",reset:"leaderboard:reset",refresh2D:"leaderboard:refresh2D",refresh3D:"leaderboard:refresh3D",notifyRank:"leaderboard:notifyRank",types:{mini:0,round:1,final:2}},store:{refreshStore:"store:refreshstore",iapManagerLoaded:"store:loaded",ballonLoaded:"store:ballonloaded",purchasesLoaded:"store:purchasesloaded",updateBalloon:"store:updateballoon"}},this.app.buttonSound={none:"None",standard:"Standard",play:"Play"},this.app.sound={selectPlayButton:"SelectPlayButton",pressButton:"PressButton",putSkillOnDeck:"PutSkillOnDeck",removeSkillFromDeck:"RemoveSkillFromDeck",upgradeSkill:"UpgradeSkill",freezeOriginDestination:"FreezeOriginDestination",zombieOriginDestination:"ZombieOriginDestination",bananaFakeBoxOrigin:"BananaFakeBoxOrigin",ghostOrigin:"GhostOrigin",invincibleOrigin:"InvincibleOrigin",thiefOrigin:"ThiefOrigin",umbrellaOrigin:"UmbrellaOrigin",grappleOrigin:"GrappleOrigin",bananaDestination:"BananaDestination",fakeBoxDestination:"FakeBoxDestination",thiefDestination:"ThiefDestination",grappleDestination:"GrappleDestination",skillReady:"SkillReady",pickUpBox:"PickUpBox",pickUpStar:"PickUpStar",deliverBox:"DeliverBox",round1Opening:"Round1Opening",round2Opening:"Round2Opening",finalRoundOpening:"FinalRoundOpening",startMatchCountdown:"StartMatchCountdown",finishRoundCountdown:"FinishRoundCountdown",loseRound:"LoseRound",winRound:"WinRound",winGame:"WinGame",openChest:"OpenChest",getReward:"GetReward",starsGoingToChest:"StarsGoingToChest",run:"Run"},this.app.music={mainMenu:"MainMenuMusic",leaderboardFinalScreen:"LeaderboardFinalScreen"},this.app.PlayerMatchStates={NORMAL:"normal",WATCHER:"watcher"},this.app.debugNpcIds=["1ead45b2-7e38-48a8-b121-6c998bf1becf","4ab75fc9-fdae-4431-8976-c6571c06fbaf","35e5af98-7e43-4057-a01c-2a80ac85e614","8673bd37-3d91-4f46-a560-6a0931c74f7a","6e21e203-f10d-4d69-ba04-1129671a298a","05a2f2cc-7768-439c-914f-13e0c0527669","c3e2ca7e-6023-42eb-9928-1de03e4874ac","d8145ed9-70aa-4466-814a-04598494ded2","0f2e4758-5d90-4623-9f3c-ee6c3d93aa5c","920770b0-880f-4845-8db5-7160f3c84e9a","e6661449-09a7-4009-81e7-4462f5388228","36f8f3e6-6744-463e-985b-c9e1ccbd1fb1","ef40e498-5324-4eb2-af39-c09587451a85","5c88c5d1-2359-4ea7-83af-fc2743c3fa24","6aa12757-bab8-456f-a125-b6b98742d4a3","4835715c-dbf1-4570-9890-ee6ccc097727","ecce82bd-cd96-498b-a1b5-c0df8a7a527f","7fe0988a-6a73-4416-8e2e-fdbddbae5242","251286c3-4bab-47b7-9641-0ae36c740e70","dca38ce6-6b9c-4859-ac51-c8d8e7f486ee","c44a71d1-7585-4d32-90c6-00076e092afe","a2fd5b4f-9e60-41db-acf9-8e36c45a23ec","9af0dad8-2c45-4972-a1ad-55a7cadbee3b","983c116b-2d63-42d5-b472-3ec7bacdef70","91248c5f-7a25-47e3-b969-36bc8768e8ca"],this.app.defaultGravity={x:this.app.systems.rigidbody.gravity.x,y:this.app.systems.rigidbody.gravity.y,z:this.app.systems.rigidbody.gravity.z},this.app.maxnumplayers=8,this.app.MaxCollectablePackages=3,this.app.avatarsize=512,this.app.isDevLaunch=function(){var e=window.location.href;return!!(e.startsWith("https://launch.playcanvas.com")||e.startsWith("http://launch.playcanvas.com")||e.startsWith("https://playcanv.as/"))},this.app.spawnableObjects={PACKAGE:"Package",BANANA:this.app.skills.Banana,FAKEBOX:this.app.skills.FakeBox,FALLINGBOX:this.app.skills.FallingBox},this.app.syncIdCount=0,this.app.getSyncId=function(){return e.app.syncIdCount++,"uid:"+e.app.syncIdCount},this.app.check=function(e){if(!e)throw"Undefined parameter "+e;return e},this.app.restart=function(e,a){let t=window.location.href,n=e+"=";t.indexOf(n)>-1&&(t=t.slice(0,t.indexOf(n)-1));let i=t.includes("?")?"&":"?",s=t+i+n+a;location.replace(s)},this.ray=new pc.Ray,this.app.analytics={AmplitudeDevApiKey:"e3b97b13a0c282699b803539a119b38f",AmplitudeProdApiKey:"478763295529a22f4cd47c9ecc0241af"},this.app.trackingEvents={upgradeSkill:"upgrade_skill",startLevel:"start_level",endRound:"end_round",adView:"ad_view",openBox:"open_box",socketError:"socket_error",unableToJoinPartyMatch:"unable_to_join_original_party_match",unableToShowAd:"unable_to_show_ad",endGame:"end_game",halfGame:"half_game"},this.app.upgradeSkillTypeBtnText={Free:"FREE",WatchAd:"WATCH AD"},this.app.upgradeSkillActionType={Free:"free",Ad:"ad",Token:"token"},this.app.OS=function(){var e,a=navigator.userAgent,t=navigator.platform;return["Macintosh","MacIntel","MacPPC","Mac68K"].includes(t)?e="Mac OS":["iPhone","iPad","iPod"].includes(t)?e="iOS":["Win32","Win64","Windows","WinCE"].includes(t)?e="Windows":/Android/.test(a)?e="Android":/Linux/.test(t)&&(e="Linux"),e},this.app.ads={placement:{UpgradeSkill:"upgrade_skill",EndMatchLose:"end_match_lose",DoubleReward:"double_reward",ReturnToMenu:"return_to_menu",AddStarsToStarBox:"add_stars_to_starbox",Intermission:"intermission",LeaderBoard:"leaderboard",PlayWithAds:"playwithads",UnlockSkillAd:"unlockskillad",UnlockBalloonAd:"unlockballoonad",UnlockSkillAdMainScreen:"unlockskilladmainscreen",UnlockBallonAdMainScreen:"unlockballonadmainscreen",ChestMenuKeys:"chestMenuKeys",UnlockSkin:"unlockSkin",GetItSkinUnlock:"getItSkinUnlock",ShopUnlockSkin:"shopUnlockSkin",GetItLooksGoodUnlockSkin:"getItLooksGoodUnlockSkin",EarnGems:"earnGems"},type:{Rewarded:"rewarded",Interstitial:"interstitial"}},this.app.starsToGetFromStarBoxAd=20,this.app.arrowPointer={isEnable:"ArrowPointer: enablePointer",setTarget:"ArrowPointer: setTarget"},this.app.botNames=["Yourealion","Women Spin","Coffee Rule","kartier klass","Pink Page","Tarry Damn","sparkly","Snowier","Skull Crusher","Kunning king","Hideki Riyuga","Cute Ownership","2Star Princess","Creamy Crux","Silvermoon","Glory Pure","Maid Cheer","diamondhand146","Lodi Creamy","Tiny Force","Great","Mom Crying","Live Chic","Soft Mambo","sweetie","Baby Slamming","Squatch","Dove girl","Winning Mob","Fresh Face","Strides Drink","FoxHound42","Goddess","Buckshot","Flying Mouse","Couch King","Story Of Me","CandyRaid","alwayssbeyou","Ever Next","Far Racer","Dimples","Barber Cut","ValkonX11","Jaycee","Dracula Nurse","Kral III","Dazzles","Monkey","taken by Wine","Zombie Edge","Tonight Gamer","capncrunchcx","BothSidesCoin","Sugary pie","Polar Mode"]};var Bitmoji3d=pc.createScript("bitmoji3d");Bitmoji3d.attributes.add("showDefaultBitmoji",{type:"boolean",default:!0}),Bitmoji3d.attributes.add("loadingIconEntity",{type:"entity"}),Bitmoji3d.attributes.add("defaultBitmoji3dModelAsset",{type:"asset"}),Bitmoji3d.attributes.add("defaultBitmoji3dMaterialAsset",{type:"asset"}),Bitmoji3d.attributes.add("layerName",{type:"string"}),Bitmoji3d.attributes.add("stateAnimMappings",{type:"json",schema:[{name:"stateName",type:"string",default:""},{name:"animAsset",type:"asset"}],array:!0}),Bitmoji3d.faces={win:"win",cheerful:"cheerful",determined:"determined",shocked:"shocked",scared:"scared",thinking:"thinking",compression:"compression",blink:"idle-blink",cheeky:"cheeky",angry:"angry",lose:"lose",idle:"idle"},Bitmoji3d.prototype.initialize=function(){if(void 0===this.isInit){this.isInit=!0;var t=this;this.entity.model.enabled=!1,this._faceTextureAssets={},this._faceMaterial=null,this._currentFace=Bitmoji3d.faces.idle,this._lastFrameAnimState="",this._currentAnimTrack=null,this._faceTexturesLoaded=!1,this._animationsLoaded=!1,this.entity.on("bitmoji:bodyloading",(function(){this.loadingIconEntity&&(this.loadingIconEntity.enabled=!0)}),this),this.entity.on("bitmoji:bodyloaded",this.loadBodyAsset,this),this.entity.on("bitmoji:facesloaded",this.loadFaceTextures,this),this.showDefaultBitmoji&&this.app.glbConvertedAssets.load(this.defaultBitmoji3dModelAsset,function(t,i){t||this._onDefaultBitmojiLoaded(i)}.bind(this));for(var i=0,e=0;e<this.stateAnimMappings.length;++e){var a=this.stateAnimMappings[e];a.animAsset&&this.app.glbConvertedAssets.loadBitmoji(a.animAsset,(function(e,a){e&&console.error("Cannot load animation asset: "+e),(i+=1)==t.stateAnimMappings.length&&(t._animationsLoaded=!0,t._addAnimations())}))}this.loadingIconEntity&&(this.loadingIconEntity.enabled=!1)}},Bitmoji3d.prototype.update=function(t){this._faceTexturesLoaded&&this._updateFaces(t)},Bitmoji3d.prototype.loadBodyAsset=function(t){if(this.initialize(),this._faceMaterial=null,t){var i,e=t.resource;if(null==e||null==e)return;try{if(null!==e.materials){for(i=0;i<e.materials.length;++i){var a=e.materials[i];if("face_group_MAT"==a.resource.name){this._faceMaterial=a.resource;break}}null!==e.model&&void 0!==e.model&&(this.entity.model.asset=e.model),this._addAnimations()}}catch(t){Debug.log("ERROR:%o",t)}}this.loadingIconEntity&&(this.loadingIconEntity.enabled=!1)},Bitmoji3d.prototype.loadFaceTextures=function(t){var i;this.initialize(),this._faceTextureAssets={};for(var e=0;e<t.length;++e)i=t[e],this._faceTextureAssets[i.name]=i;this._faceTexturesLoaded=!0,this._changeFace(this._currentFace)},Bitmoji3d.prototype._addAnimations=function(){if(this._animationsLoaded){if("null"!==this.layerName&&void 0!==this.entity.anim)for(var t=this.entity.anim.findAnimationLayer(this.layerName),i=0;i<this.stateAnimMappings.length;++i){var e=this.stateAnimMappings[i];if(e.animAsset){var a=this.app.glbConvertedAssets.get(e.animAsset.id);null===a?console.error("Animation "+e.animAsset.name+" not ready"):t.assignAnimation(e.stateName,a.resource.animations[0].resource)}}void 0!==this.entity.model&&(this.entity.model.enabled=!0)}"null"===this.layerName&&(this.entity.model.enabled=!0)},Bitmoji3d.prototype._onDefaultBitmojiLoaded=function(t){if(void 0!==this.entity.model&&null===this.entity.model.asset)if(null===t);else if(this.entity.model.asset=t.resource.model,null!==this.defaultBitmoji3dMaterialAsset){var i=this.entity.model.meshInstances;for(let t=0;t<i.length;++t)i[t].material=this.defaultBitmoji3dMaterialAsset.resource}this._addAnimations()},Bitmoji3d.prototype._changeFace=function(t){if(this._faceMaterial){var i=this._faceTextureAssets[t];i?(this._faceMaterial.diffuseMap=i.resource,this._faceMaterial.update()):console.error("Missing face texture: "+t)}this._currentFace=t},Bitmoji3d.prototype._updateFaces=function(t){if("null"!==this.layerName){var i,e,a=this.entity.anim.baseLayer.activeState;if(this._lastFrameState!=a)for(e=0;e<this.stateAnimMappings.length;++e){var s=this.stateAnimMappings[e];if(s.stateName==a){var n=this.app.glbConvertedAssets.get(s.animAsset.id);this._currentAnimTrack=n.resource.animations[0].resource;break}}var o=this._currentAnimTrack;if(o&&(i=o.facialSwaps),i){var r=this.entity.anim.baseLayer.activeStateCurrentTime;r%=this.entity.anim.baseLayer.activeStateDuration;var d=i.times,l=0;for(e=0;e<d.length;++e)r>=d[e]&&(l=e);var m=i.expressions[l];this._currentFace!=m&&this._changeFace(m)}this._lastFrameState=a}};var Spinner=pc.createScript("spinner");Spinner.attributes.add("speed",{type:"vec3",description:"Euler angle speed"}),Spinner.prototype.initialize=function(){this.angle=0,this._eulerAngles=new pc.Vec3},Spinner.__changeThisFrame=new pc.Vec3,Spinner.prototype.update=function(e){let i=Spinner.__changeThisFrame;i.copy(this.speed),i.scale(e),void 0!==this._eulerAngles&&(this._eulerAngles.add(i),this._eulerAngles.x=bitmojiutils.wrapAngle360(this._eulerAngles.x),this._eulerAngles.y=bitmojiutils.wrapAngle360(this._eulerAngles.y),this._eulerAngles.z=bitmojiutils.wrapAngle360(this._eulerAngles.z),this.entity.setLocalEulerAngles(this._eulerAngles))};pc.script.attribute("materials","asset",[],{type:"material"}),pc.script.attribute("shader","asset",[],{type:"shader",max:1});var Plasma=pc.createScript("plasma");Plasma.attributes.add("materials",{type:"asset",array:!0}),Plasma.attributes.add("shader",{type:"asset"}),Plasma.attributes.add("stickman",{type:"entity"}),Plasma.attributes.add("stickmanRainbow",{type:"entity"}),Plasma.prototype.initialize=function(){for(var t=this.shader.resource,a=0;a<this.materials.length;a++){var e=this.materials[a].resource;e.chunks.APIVersion=pc.CHUNKAPI_1_55,e.chunks.emissivePS=t,e.diffuseMap=new pc.Texture(this.app.graphicsDevice,{width:1,height:1,format:pc.PIXELFORMAT_R8_G8_B8}),e.setParameter("iGlobalTime",0),e.update()}this.app.on(Events.OnRageModeActivated,this.OnRageModeActivated,this),this.app.on(Events.OnRageModeDeactivated,this.OnRageModeDeactivated,this),this.app.on(Events.OnLoadLevel,this.OnLoadLevel,this),this.isEffectRunning=!0,this.time=0},Plasma.prototype.OnLoadLevel=function(){this.stickmanRainbow.enabled=!1},Plasma.prototype.OnRageModeActivated=function(){this.stickman.enabled=!1,this.stickmanRainbow.enabled=!0,this.isEffectRunning=!0},Plasma.prototype.OnRageModeDeactivated=function(){this.stickman.enabled=!0,this.stickmanRainbow.enabled=!1,this.isEffectRunning=!1},Plasma.prototype.update=function(t){if(this.isEffectRunning){this.time+=t;for(var a=0;a<this.materials.length;a++){this.materials[a].resource.setParameter("iGlobalTime",this.time)}}};var ProxyBitmoji3dLoader=pc.createScript("proxyBitmoji3dLoader");ProxyBitmoji3dLoader.BITMOJI_AVATAR_IDS=[{"Opponent ID":"opponent"},{"Random NPC":"random"},{"NPC 1":"1ead45b2-7e38-48a8-b121-6c998bf1becf"},{"NPC 2":"4ab75fc9-fdae-4431-8976-c6571c06fbaf"},{"NPC 3":"35e5af98-7e43-4057-a01c-2a80ac85e614"},{"NPC 4":"8673bd37-3d91-4f46-a560-6a0931c74f7a"},{"NPC 5":"6e21e203-f10d-4d69-ba04-1129671a298a"},{"NPC 6":"05a2f2cc-7768-439c-914f-13e0c0527669"},{"NPC 7":"c3e2ca7e-6023-42eb-9928-1de03e4874ac"},{"NPC 8":"d8145ed9-70aa-4466-814a-04598494ded2"},{"NPC 9":"0f2e4758-5d90-4623-9f3c-ee6c3d93aa5c"},{"NPC 10":"920770b0-880f-4845-8db5-7160f3c84e9a"},{"NPC 11":"e6661449-09a7-4009-81e7-4462f5388228"},{"NPC 12":"36f8f3e6-6744-463e-985b-c9e1ccbd1fb1"},{"NPC 13":"ef40e498-5324-4eb2-af39-c09587451a85"},{"NPC 14":"5c88c5d1-2359-4ea7-83af-fc2743c3fa24"},{"NPC 15":"6aa12757-bab8-456f-a125-b6b98742d4a3"},{"NPC 16":"4835715c-dbf1-4570-9890-ee6ccc097727"},{"NPC 17":"ecce82bd-cd96-498b-a1b5-c0df8a7a527f"},{"NPC 18":"7fe0988a-6a73-4416-8e2e-fdbddbae5242"},{"NPC 19":"251286c3-4bab-47b7-9641-0ae36c740e70"},{"NPC 20":"dca38ce6-6b9c-4859-ac51-c8d8e7f486ee"},{"NPC 21":"c44a71d1-7585-4d32-90c6-00076e092afe"},{"NPC 22":"a2fd5b4f-9e60-41db-acf9-8e36c45a23ec"},{"NPC 23":"9af0dad8-2c45-4972-a1ad-55a7cadbee3b"},{"NPC 24":"983c116b-2d63-42d5-b472-3ec7bacdef70"},{"NPC 25":"91248c5f-7a25-47e3-b969-36bc8768e8ca"}],ProxyBitmoji3dLoader.attributes.add("bitmojiType",{type:"string",default:"opponent",enum:ProxyBitmoji3dLoader.BITMOJI_AVATAR_IDS}),ProxyBitmoji3dLoader.prototype.loadBitmoji=function(e,t){var a=this;this._log=new Log("ProxyBitmoji3dLoader"),this._bitmojiAsset=null,this._faceTextureAssets=null,this._destroyed=!1,this._userId=e,this._avatarId=t,a.entity.fire("bitmoji:bodyloading");var o=this.bitmojiType;if("user"==this.bitmojiType||"random"==this.bitmojiType){var i=ProxyBitmoji3dLoader.BITMOJI_AVATAR_IDS,s=i[Math.floor(pc.math.random(2,i.length))];o=s[Object.keys(s)[0]]}else"opponent"==this.bitmojiType&&(o=t);this._getBitmojiData(o,(function(t,o){null!==t?(a._log.warn(t),a.entity.fire("bitmoji:bodyloaded")):loadBitmoji3d(o,(function(t,o){t?(a._log.error("Error loading model"),a._log.error(t)):a._bitmojiAsset=o,a._destroyed?a._unloadBitmojiAsset():a.entity.fire("bitmoji:bodyloaded",o,e)}),(function(t,o){t&&(a._log.error("Error loading face textures"),a._log.error(t)),a._faceTextureAssets=o,a._destroyed?a._unloadFaceTextures():a.entity.fire("bitmoji:facesloaded",o,e)}))})),this.entity.on("destroy",(function(){this._unloadBitmojiAsset(),this._unloadFaceTextures(),this._destroyed=!0}),this)},ProxyBitmoji3dLoader.prototype._unloadBitmojiAsset=function(){this._bitmojiAsset&&(this._bitmojiAsset.unload(),this.app.assets.remove(this._bitmojiAsset)),this._bitmojiAsset=null},ProxyBitmoji3dLoader.prototype._unloadFaceTextures=function(){if(this._faceTextureAssets)for(var e=0;e<this._faceTextureAssets.length;++e)this._faceTextureAssets[e].unload(),this.app.assets.remove(this._faceTextureAssets[e]);this._faceTextureAssets=null},ProxyBitmoji3dLoader.prototype._getBitmojiData=async function(e,t){if(e)if(this.app.isDevLaunch()){var a=new XMLHttpRequest,o="https://bitmoji.api.snapchat.com/bitmoji-for-games/test_avatar?avatar_id="+e+"&lod=3";a.open("GET",o,!0),a.responseType="arraybuffer",a.onload=function(e){200==this.status?t(null,this.response):t(this.status+this.statusText)},a.onerror=function(e){t(this.statusText)},a.send()}else{var i=await sc.fetchAvatar3D(e).catch((e=>console.error(e.message)));void 0!==i&&void 0!==i.url?t(null,i.url):t("Error from Snapchat SDK fetching Avatar 3D")}else t("Account has no Bitmoji, doing nothing")};var GameMessageManager=pc.createScript("gameMessageManager");GameMessageManager.attributes.add("gameMessage",{type:"entity"}),GameMessageManager.attributes.add("gameMessageTxt",{type:"entity"}),GameMessageManager.attributes.add("gameMessageUIs",{type:"entity",array:!0}),GameMessageManager.prototype.initialize=function(){this.app.on("onGameMessageShow",this.onGameMessageShow,this),this.app.on("fadeOutGameMessage",this.fadeOut,this)},GameMessageManager.prototype.onGameMessageShow=function(e){this.fadeIn(),this.gameMessageTxt.element.text=e},GameMessageManager.prototype.fadeIn=function(){this.gameMessage.enabled=!0;for(let e=0;e<this.gameMessageUIs.length;e++)this.gameMessageUIs[e].element.opacity=1},GameMessageManager.prototype.fadeOut=function(){for(let e=0;e<this.gameMessageUIs.length;e++)TweenWrapper.TweenOpacity(this.gameMessageUIs[e],1,0,2.5,(()=>{this.gameMessage.enabled=!1}))},GameMessageManager.prototype.update=function(e){};var DefaultGlbAssetLoader=pc.createScript("defaultGlbAssetLoader");DefaultGlbAssetLoader.attributes.add("assets",{type:"asset",array:!0}),DefaultGlbAssetLoader.attributes.add("bitmojiAnimationAssets",{type:"asset",array:!0}),DefaultGlbAssetLoader.initialized=!1,DefaultGlbAssetLoader.ready=!1,DefaultGlbAssetLoader.prototype.initialize=function(){if(DefaultGlbAssetLoader.initialized)Debug.log("Default GLB assets already loaded");else{this._assetsLoaded=0,this._glbConvertedAssets=this.app.glbConvertedAssets;var e=this,fireEventIfFinished=function(){e.assets.length+e.bitmojiAnimationAssets.length==e._assetsLoaded&&(DefaultGlbAssetLoader.ready=!0,e.app.fire("defaultglbs:loaded"))},assetListLooper=function(e,t){var s;for(s=0;s<e.length;++s)t(e[s])};assetListLooper(this.assets,(function(t){e._glbConvertedAssets.load(t,(function(t,s){t&&console.error(t),e._assetsLoaded+=1,fireEventIfFinished()}))})),assetListLooper(this.bitmojiAnimationAssets,(function(t){e._glbConvertedAssets.loadBitmoji(t,(function(t,s){t&&console.error(t),e._assetsLoaded+=1,fireEventIfFinished()}))})),DefaultGlbAssetLoader.initialized=!0,fireEventIfFinished()}};!function(){var n=pc.Application.getApplication(),i={},o={},t={};i._assets=o,i.get=function(n){return o[n]},i.add=function(n,i){o[n]||(o[n]=i)},i._load=function(i,a,l){var d=i.id,e=o[d];if(e)e.loaded?l(null,e):e.ready((function(n){l(null,e)}));else{var u=function(n,i,o){var t;t=i?loadBitmojiAnimation3d(n.resource,n.name,(function(n,i){o(n,i)})):bitmojiutils.loadGlbContainerFromAsset(n,null,n.name,(function(n,i){o(n,i)})),this.add(n.id,t)}.bind(this),onGlbConverted=function(n,i){var o=t[d];if(o){for(var a=0;a<o.length;++a)o[a](n,i);t[d]=null}};i.loaded?u(i,a,l):(i.loading||(i.ready((function(){u(i,a,onGlbConverted)})),n.assets.load(i),t[d]=[]),t[d].push(l))}},i.load=function(n,i){this._load(n,!1,i)},i.loadBitmoji=function(n,i){this._load(n,!0,i)},n.glbConvertedAssets=i}();!function(){var e={},n=pc.Application.getApplication();e.loadGlbContainerFromAsset=function(e,n,r,t){var l=new Blob([e.resource]),o=URL.createObjectURL(l);return this.loadGlbContainerFromUrl(o,n,r,(function(e,n){t(e,n),URL.revokeObjectURL(o)}))},e.loadGlbContainerFromUrl=function(e,r,t,l){var o=t+".glb",a={url:e,filename:o},i=new pc.Asset(o,"container",a,null,r);return i.once("load",(function(e){if(l){var n=e.resource.animations;if(null!==n)if(1==n.length)n[0].name=t;else if(n.length>1)for(var r=0;r<n.length;++r)n[r].name=t+" "+r.toString();l(null,e)}})),n.assets.add(i),n.assets.load(i),i},e.wrapAngle360=function(e){return e%360},e.cloneTexture=function(e){var n=new pc.Texture(e.device,e);return n._levels=function(e){for(var n=[],r=0;r<e._levels.length;++r){var t=[];if(e.cubemap)for(var l=0;l<6;++l)t.push(e._levels[r][l]);else t=e._levels[r];n.push(t)}return n}(e),n},e.cloneTextureAsset=function(n){var r=new pc.Asset(n.name,n.type,n.file,n.data,n.options),t=n.resource;return r.loaded=!0,r.resource=e.cloneTexture(t),n.registry.add(r),r},window.bitmojiutils=e}();!function(){var i=pc.Application.getApplication();window.loadBitmoji3d=function loadBitmoji3d(t,o,a){var n={global:{postprocess:function(t){var o=t.extras;if(o){var n,e,r=o.facialExpressionTextures,l=0,s=[],c="",onFaceTextureLoaded=function(i){i&&s.push(i),(l+=1)==r.length&&a(c,s)};for(n=0;n<r.length;++n){e=r[n];var u=i.assets.getByUrl(e.uri);u&&u.resorce?(u=bitmojiutils.cloneTextureAsset(u),onFaceTextureLoaded(u)):i.assets.loadFromUrlAndFilename(e.uri,e.name,"texture",(function(i,t){i&&(c+=i+"\n"),onFaceTextureLoaded(t)}))}}}}},e=t,r=!1;if("string"!=typeof e){var l=new Blob([t]);e=URL.createObjectURL(l),r=!0}var s=bitmojiutils.loadGlbContainerFromUrl(e,n,"bitmoji-container",(function(i,t){i?callback(i):i?o(i):o(null,t)}));return r&&URL.revokeObjectURL(e),s},window.loadBitmojiAnimation3d=function loadBitmojiAnimation3d(i,t,o){var a,n=i,e=!1;if("string"!=typeof n){var r=new Blob([i]);n=URL.createObjectURL(r),e=!0}return a=bitmojiutils.loadGlbContainerFromUrl(n,{global:{postprocess:function(i,t){var o=i.animations[0].extras;o&&o.facial_swaps&&(t.animations[0].facialSwaps=o.facial_swaps)}}},t,(function(i,t){o(i,t)})),e&&URL.revokeObjectURL(n),a}}();var GameLauncher=pc.createScript("gameLauncher");GameLauncher.prototype.initialize=function(){this.app.fire(this.app.event.loading.disable),ScManager.instance.OnManagersLoadingComplete()};var DevelopmentStreamId=pc.createScript("developmentStreamId");DevelopmentStreamId.attributes.add("user",{title:"User",type:"string",enum:[{Shahzaib:"Shahzaib"},{Faiq:"Faiq"},{Saad:"Saad"},{Other:"Other"}],default:"Other"}),DevelopmentStreamId.prototype.initialize=function(){DevelopmentStreamId.id=this.user+"_Test_Stream"};var BitmojiStartAnimator=pc.createScript("bitmojiStartAnimator");BitmojiStartAnimator.attributes.add("stickmanModel",{type:"entity"}),BitmojiStartAnimator.attributes.add("bitmojiModel",{type:"entity"}),BitmojiStartAnimator.attributes.add("bitmojiParent",{type:"entity"}),BitmojiStartAnimator.prototype.initialize=function(){this.app.on("runBitmojiAnimation",this.runBitmojiAnimation,this),this.app.on(Events.OnLevelCompleted,this.OnLevelLoaded,this)},BitmojiStartAnimator.prototype.OnLevelLoaded=function(){},BitmojiStartAnimator.prototype.runBitmojiAnimation=function(){this.app.fire("changeMenuState",MenuManager.States.Gameplay),this.app.fire(Events.OnStartGame,!0)},BitmojiStartAnimator.prototype.update=function(t){};var BoundsInfo=pc.createScript("boundsInfo");BoundsInfo.attributes.add("minX",{type:"number"}),BoundsInfo.attributes.add("maxX",{type:"number"}),BoundsInfo.prototype.initialize=function(){},BoundsInfo.prototype.update=function(n){};var DamageTrigger=pc.createScript("damageTrigger");DamageTrigger.attributes.add("damageEvery",{type:"number",default:.25}),DamageTrigger.prototype.initialize=function(){this.maxDamageEvery=this.damageEvery},DamageTrigger.prototype.activateDamage=function(e){this.enableDamage=e,e&&(this.damageEvery=this.maxDamageEvery)},DamageTrigger.prototype.update=function(e){if(this.enableDamage&&(this.damageEvery-=e,this.damageEvery<=0)){this.damageEvery=this.maxDamageEvery;var a={color:null,type:CollectableType.Lava,pos:pc.Vec3.ZERO,isValidColor:!1};this.app.fire(Events.OnCollectablePicked,a)}};var CameraTrigger=pc.createScript("cameraTrigger");CameraTrigger.attributes.add("tag",{type:"string"}),CameraTrigger.attributes.add("speed",{type:"number",default:5}),CameraTrigger.attributes.add("onEnter",{type:"number",enum:[{Mainmenu:0},{Gameplay:1},{Fight:2},{Flight:3},{End:4},{Wall:5}]}),CameraTrigger.attributes.add("onLeave",{type:"number",enum:[{Mainmenu:0},{Gameplay:1},{Fight:2},{Flight:3},{End:4},{Wall:5}]}),CameraTrigger.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this),this.entity.collision.on("triggerleave",this.onTriggerExit,this)},CameraTrigger.prototype.onTriggerEnter=function(e){e.tags.has(this.tag)&&this.app.fire(Events.OnChangeCameraState,this.onEnter,this.speed)},CameraTrigger.prototype.onTriggerExit=function(e){e.tags.has(this.tag)&&this.app.fire(Events.OnChangeCameraState,this.onLeave,this.speed)},CameraTrigger.prototype.update=function(e){};var AdsManager=pc.createScript("adsManager");AdsManager.prototype.initialize=function(){AdsManager.instance=this,AdsManager.instance.adSlots="4fa55a2e-7167-4b76-88a4-9ef46d9bf314",AdsManager.instance.callbacks={},AdsManager.instance.adPlacement=void 0,AdsManager.instance.adType=void 0,AdsManager.instance.countDown=0,this.app.once(this.app.event.sc.initialiced,AdsManager.instance.initializeAds,this)},AdsManager.prototype.initializeAds=async function(){if(!this.app.isDevLaunch()){var a=await sc.initializeAds([this.adSlots]).catch((a=>console.error(a.message)));a.error?Debug.log(a.error):(AdsManager.instance.subscribeEvents(),AdsManager.instance.getUnconsumeAd())}},AdsManager.prototype.update=function(){AdsManager.instance.countDown>0&&AdsManager.instance.countDown--},AdsManager.prototype.subscribeEvents=function(){sc.app&&(sc.app.on("adReady",(function(a){a.slotId===AdsManager.instance.adSlots&&this.onAdReady(a)}),this),sc.app.on("adComplete",(function(a){a.slotId===AdsManager.instance.adSlots&&this.onAdComplete(a)}),this))},AdsManager.prototype.getUnconsumeAd=async function(){if(!this.app.isDevLaunch()){var a=await sc.getUnconsumedAds().catch((a=>console.error(a.message)));a.unconsumedAds&&a.unconsumedAds.length>0&&a.unconsumedAds.forEach((function(a){sc.consumeAd(a.requestId)}))}},AdsManager.prototype.showAd=async function(a,n,e,s){var t=this,d=await sc.isAdReady(AdsManager.instance.adSlots).catch((a=>console.error(a.message)));if(!AdsManager.instance.app.isDevLaunch()&&void 0!==d&&d.isReady&&(AdsManager.instance.countDown<=0||e==this.app.ads.type.Rewarded)){var c=Utils.randomName(10);return AdsManager.instance.callbacks[c]=a,AdsManager.instance.adPlacement=n,AdsManager.instance.adType=e,sc.watchAd(AdsManager.instance.adSlots,c),AdsManager.instance.countDown=this.app.adWaitTime,!0}if(e===t.app.ads.type.Rewarded)return!0===s&&GUIManager.instance.showPopup(t.app.popupMessages.AdUnavailable,t.closeAdUnavailablePopup),!1},AdsManager.prototype.onAdComplete=function(a){var n=a.developerPayload;sc.consumeAd(a.requestId),AdsManager.instance.trackAd(),null!==AdsManager.instance.callbacks[n]&&void 0!==AdsManager.instance.callbacks[n]&&AdsManager.instance.callbacks[n](),delete AdsManager.instance.callbacks[n]},AdsManager.prototype.onAdReady=function(a){a.slotId,AdsManager.instance.adSlots},AdsManager.prototype.trackAd=function(){},AdsManager.prototype.closeAdUnavailablePopup=function(){GUIManager.instance.hidePopup()};var RenderCameraToElement=pc.createScript("renderCameraToElement");RenderCameraToElement.attributes.add("elementTags",{type:"string",array:!0,description:"Render to elements that have these tags"}),RenderCameraToElement.attributes.add("renderResolution",{type:"vec2",description:"Resolution to render at"}),RenderCameraToElement.attributes.add("renderOnce",{type:"boolean",description:"Renders the first frame only"}),RenderCameraToElement.prototype.initialize=function(){this.createNewRenderTexture(),this.renderOnceFrameCount=0,this.on("destroy",(function(){this.assignTextureToElements(null),this.renderTarget.destroy(),this.texture.destroy()}),this)},RenderCameraToElement.prototype.update=function(e){this.renderOnce&&(this.renderOnceFrameCount+=1,this.renderOnceFrameCount>4&&(this.entity.enabled=!1))},RenderCameraToElement.prototype.createNewRenderTexture=function(){var e=this.app.graphicsDevice;if(this.texture&&this.renderTarget){var t=this.renderTarget,r=this.texture;this.renderTarget=null,this.texture=null,t.destroy(),r.destroy()}var n=new pc.Texture(e,{width:this.renderResolution.x,height:this.renderResolution.y,format:pc.PIXELFORMAT_R8_G8_B8,autoMipmap:!0});n.minFilter=pc.FILTER_LINEAR,n.magFilter=pc.FILTER_LINEAR;var a=new pc.RenderTarget(e,n,{depth:!0,flipY:!0,samples:2});this.entity.camera.renderTarget=a,this.texture=n,this.renderTarget=a,this.assignTextureToElements(this.texture)},RenderCameraToElement.prototype.assignTextureToElements=function(e){for(var t,r=0;r<this.elementTags.length;++r){t=this.app.root.findByTag(this.elementTags[r]);for(var n=0;n<t.length;++n)t[n].element.texture=e}};var ChestRoomSettings=pc.createScript("chestRoomSettings");ChestRoomSettings.attributes.add("firstIterationWinIndex",{type:"number",default:3}),ChestRoomSettings.attributes.add("winIndices",{type:"number",array:!0}),ChestRoomSettings.attributes.add("gemsRegularPrizeMin",{type:"number"}),ChestRoomSettings.attributes.add("gemsRegularPrizeMax",{type:"number"}),ChestRoomSettings.attributes.add("gemsBestPrizeMin",{type:"number"}),ChestRoomSettings.attributes.add("gemsBestPrizeMax",{type:"number"}),ChestRoomSettings.attributes.add("GemsBestPrizeIcon",{type:"asset",assetType:"sprite"}),ChestRoomSettings.attributes.add("keysForOpenRoom",{type:"number",default:3}),ChestRoomSettings.attributes.add("keysFromRewardedVideo",{type:"number",default:3}),ChestRoomSettings.prototype.initialize=function(){},ChestRoomSettings.prototype.update=function(t){};var BiggBossController=pc.createScript("biggBossController");BiggBossController.State={idle:0,attack:1,punch:2,tired:3,rage:4,victory:5,beaten:6,fall:7},BiggBossController.attributes.add("maxHealth",{type:"number",title:"Health"}),BiggBossController.attributes.add("currentState",{type:"number",enum:[{Idle:BiggBossController.State.idle},{Attack:BiggBossController.State.attack},{Punch:BiggBossController.State.punch},{Tired:BiggBossController.State.tired},{Rage:BiggBossController.State.rage},{Victory:BiggBossController.State.victory},{Beaten:BiggBossController.State.beaten},{Fall:BiggBossController.State.fall}]}),BiggBossController.attributes.add("animator",{type:"entity",title:"Animator"}),BiggBossController.attributes.add("modelObj",{type:"entity",title:"Model"}),BiggBossController.attributes.add("punchVFX",{type:"entity"}),BiggBossController.attributes.add("vfxPositions",{type:"entity",array:!0}),BiggBossController.attributes.add("testing",{title:"Testing",type:"json",schema:[{name:"customBossDamage",type:"number"},{name:"customBossScale",type:"number"}]}),BiggBossController.prototype.initialize=function(){this.initEvents(),this.initVars()},BiggBossController.prototype.postInitialize=function(){this.app.fire("ReferenceManager:SetBigBoss",this)},BiggBossController.prototype.onEnable=function(){this.changeState(BiggBossController.State.idle)},BiggBossController.prototype.onDisable=function(){},BiggBossController.prototype.onDestroy=function(){this.off("enable",this.onEnable,this),this.off("disable",this.onDisable,this),this.off("destroy",this.onDestroy,this),this.app.off("BigBossFighting:Begin",this.onFightStarted,this),this.app.off("BigBossFighting:BossTired",this.onBigBossTired,this),this.app.off("BigBossFighting:BossRage",this.onBigBossRage,this),this.app.off("PlayerBigBossFighting:HitBigBoss",this.onPlayerHit,this),this.app.off("BigBossFighting:BossBeaten",this.onBeaten,this),this.app.off("BigBossFighting:KillBoss",this.onBossDead,this),this.app.off("BigBoss:PlayPunchVfx",this.playPunchVfx,this),this.app.off(Events.OnPlayerDead,this.onPlayerDead,this),this.app.off(Events.OnRevivePlayer,this.onRevivePlayer,this),this.app.off(Events.OnFinishLineStarted,this.onFinishLineStarted,this)},BiggBossController.prototype.update=function(t){this.updatePunches(t),this.updateTiredness(t)},BiggBossController.prototype.initEvents=function(){this.on("enable",this.onEnable,this),this.on("disable",this.onDisable,this),this.on("destroy",this.onDestroy,this),this.app.on("BigBoss:IncreasePunches",(()=>{this.punchesCount++})),this.app.on("BigBossFighting:Begin",this.onFightStarted,this),this.app.on("BigBossFighting:BossTired",this.onBigBossTired,this),this.app.on("BigBossFighting:BossRage",this.onBigBossRage,this),this.app.on("PlayerBigBossFighting:HitBigBoss",this.onPlayerHit,this),this.app.on("BigBossFighting:BossBeaten",this.onBeaten,this),this.app.on("BigBossFighting:KillBoss",this.onBossDead,this),this.app.on("BigBoss:PlayPunchVfx",this.playPunchVfx,this),this.app.on(Events.OnPlayerDead,this.onPlayerDead,this),this.app.on(Events.OnRevivePlayer,this.onRevivePlayer,this),this.app.on(Events.OnFinishLineStarted,this.onFinishLineStarted,this)},BiggBossController.prototype.initVars=function(){this.punchTimer=0,this.tiredTimer=0,this.rageTimer=1,this.transitionDuration=0,this.prevState=this.currentState,this.stars=this.entity.findByName("Stars");var t=this.modelObj.render.meshInstances[0].material.clone();this.modelObj.render.meshInstances[0].material=t,this.mat=t},BiggBossController.prototype.changeState=function(t){this.prevState===this.currentState?this.transitionDuration=.2:this.transitionDuration=0,this.prevState=this.currentState,this.currentState=t,this.animator.anim.setInteger("State",t)},BiggBossController.prototype.onFinishLineStarted=function(){this.setUpPosition(),this.changeState(BiggBossController.State.attack)},BiggBossController.prototype.onFightStarted=function(){this.punchesCount=Settings.biggBossFighting.getBossPunches(),Debug.log("BiggBossController: onFightStarted -> ",this.punchesCount),this.punchTimer=.01,this.tiredTimer=0},BiggBossController.prototype.updatePunches=function(t){this.punchTimer<=0||(this.punchTimer-=t,this.punchTimer<=0&&(this.punchesCount>0?(this.punchesCount--,this.app.fire("BigBossFighting:ManageUI",!1,!0,!1),this.changeState(BiggBossController.State.punch),this.rotateTowardsPlayer(),this.punchTimer=this.getStateTime("Punch"),this.app.fire("TargetLocking:Show",!0,this.quadrent),this.app.fire("sound:playSound","Whoosh"),CustomCoroutine.Instance.set((()=>{this.app.fire("BigBoss:HitPlayer",this.getDamage(),this.quadrent),this.app.fire("TargetLocking:Show",!1,this.quadrent),this.app.fire("sound:playSound",`BigBossPunch${parseInt(pc.math.random(1,4.1))}`)}),this.punchTimer/2),GameManager.Instance.gameSpeedChangeSteps=5,CustomCoroutine.Instance.set((()=>{GameManager.Instance.gameSpeedChangeSteps*=2,GameManager.Instance.setGameSpeed(1)}),.625*this.punchTimer)):(GameManager.Instance.gameSpeedChangeSteps=5,this.app.fire("BigBoss:TiredOfPunches"))))},BiggBossController.prototype.onBigBossTired=function(){this.app.fire("sound:playSound","BigBossTired"),this.changeState(BiggBossController.State.tired),this.tiredTimer=Settings.biggBossFighting.bossSettings.bossTiredDuration,this.rotateTowardsPlayer(),this.enableStars(!0)},BiggBossController.prototype.updateTiredness=function(t){this.tiredTimer<=0||(this.tiredTimer-=t,this.tiredTimer<=0&&this.app.fire("BigBoss:TirednessEnded"))},BiggBossController.prototype.onBigBossRage=function(){this.app.fire("sound:playSound","BigBossRage"),this.changeState(BiggBossController.State.rage),this.punchesCount=Settings.biggBossFighting.getBossPunches(),this.punchTimer=this.getStateTime("Rage"),this.enableStars(!1)},BiggBossController.prototype.onPlayerHit=function(t){this.health-=t,this.health=pc.math.clamp(this.health,0,this.maxHealth),this.app.fire("FightView:SetHealth",AttackTarget.Boss,this.health/this.maxHealth),this.health<=0&&this.app.fire("BigBoss:Beaten")},BiggBossController.prototype.onBeaten=function(){this.app.fire("sound:playSound","BigBossTired"),this.punchTimer=0,this.tiredTimer=0,this.changeState(BiggBossController.State.beaten)},BiggBossController.prototype.onBossDead=function(){this.app.fire("sound:playSound","Fatality"),this.app.fire("sound:playSound","Falling",.2),this.changeState(BiggBossController.State.fall),CustomCoroutine.Instance.set((()=>{this.app.fire("BigBossFighting:OnComplete")}),this.getStateTime("Fall")+.2)},BiggBossController.prototype.onPlayerDead=function(){this.punchTimer=0,this.tiredTimer=0,this.changeState(BiggBossController.State.victory)},BiggBossController.prototype.onRevivePlayer=function(){this.changeState(BiggBossController.State.attack)},BiggBossController.prototype.playPunchVfx=function(){this.punchVFX.fire("Play",this.vfxPositions[0].getLocalPosition())},BiggBossController.prototype.setUpPosition=function(){},BiggBossController.prototype.getDamage=function(){let t=BiggBossFightingManager.Instance.isTutorialRequired,e=Settings.biggBossFighting.damageSettings.bossDamage;return t?e.x:e.y},BiggBossController.prototype.prepare=function(t,e){this.health=this.maxHealth,this.quadrent=0;let s=0,i=ReferenceManager.Instance.root.script.levelsData.difficultyData;for(let t=0;t<i.length;t++)if(e<=i[t].minLevel){s=i[t].bossLevelDelta;break}let o=Math.max(1,t.maxHeroLevel-s),n=Settings.biggBossFighting.bossSettings.bossScale;this.mat.diffuse=this.mat.emissive=t.color,this.health=this.maxHealth=t.health,this.bossLevel=o;let a=t.position.x,r=t.position.y,h=t.position.z+Settings.biggBossFighting.bossSettings.bossOffsetZ;Debug.log("Boss Z: ",h),this.enableStars(!1),this.entity.setLocalPosition(a,r,h),this.entity.setLocalEulerAngles(0,0,0),this.entity.setLocalScale(n,n,n)},BiggBossController.prototype.rotateTowardsPlayer=function(){let t=ReferenceManager.Instance.player.script.playerController,e=t.bigBossFightingController.swipeIndex;if(this.quadrent===e)return;this.quadrent=e;let s=this.entity.getLocalEulerAngles();Debug.log("player angle: ",t.y),TweenWrapper.TweenNumber(0,1,.5,(t=>{let e=pc.math.lerpAngle(s.y,90*this.quadrent,t.number);this.entity.setLocalEulerAngles(s.x,e,s.z)}))},BiggBossController.prototype.getStateTime=function(t){return t?this.animator.anim.baseLayer._controller._states[t].timelineDuration:(Debug.log("getStateTime: ",this.animator.anim.baseLayer.activeState),this.animator.anim.baseLayer.activeStateDuration+this.transitionDuration)},BiggBossController.prototype.enableStars=function(t){this.stars.enabled=t},BiggBossController.prototype.testStates=function(){this.testStateCurrent!==this.currentState&&(this.testStateCurrent=this.currentState,this.changeState(this.currentState),Debug.log("State: ",this.currentState))};var ConfigManager=pc.createScript("configManager");ConfigManager.EnvTypes={None:-1,Gamedistribution:0,Facebook:1},ConfigManager.attributes.add("version",{type:"string",title:"Version"}),ConfigManager.attributes.add("devMode",{type:"boolean",enum:[{Development:!0},{Production:!1}],title:"BuildType"}),ConfigManager.attributes.add("environmentType",{type:"number",enum:[{None:ConfigManager.EnvTypes.None},{Gamedistribution:ConfigManager.EnvTypes.Gamedistribution},{Facebook:ConfigManager.EnvTypes.Facebook}],title:"EnvType"}),ConfigManager.attributes.add("configs",{type:"asset",array:!0}),ConfigManager.instance=null,ConfigManager.prototype.initialize=function(){if(ConfigManager.instance=this,-1!==this.environmentType){let e=this.configs[this.environmentType].resource.instantiate();this.app.root.addChild(e)}this.app.fire(this.app.events.configManager.initialized)};var ChestRoomManager=pc.createScript("chestRoomManager");ChestRoomManager.attributes.add("commonIcons",{type:"json",schema:[{name:"keyIcon",type:"asset",assetType:"sprite"},{name:"gemIcon",type:"asset",assetType:"sprite"}]}),ChestRoomManager.attributes.add("bundles",{type:"json",schema:[{name:"rewardCollection",type:"entity",array:!0},{name:"type",type:"number",enum:[{Hats:0},{Shoes:1},{Kicks:2}]}],array:!0}),ChestRoomManager.attributes.add("skinIndices",{type:"json",schema:[{name:"premium",type:"number",array:!0}]}),ChestRoomManager.prototype.GetSkinPrice=function(e){let t=this.GetBoughtSkinsCount(e,SkinRarity.Common),r=Settings.upgrade.getMaxPrice(DataManager.Instance.kickLevel,DataManager.Instance.multiplierLevel);return r+parseInt(r*(t*Settings.upgrade.priceIncrement))},ChestRoomManager.prototype.GetBoughtSkinsCount=function(e,t){let r=e,n=t,s=0,o=[SkinStatus.Unlocked,SkinStatus.Selected,SkinStatus.Available];for(let e=0;e<o.length;e++){let t=o[e];s+=this.GetRewards(r,n,t).length}return s},ChestRoomManager.prototype.IsPremiumRewardAvailable=function(){return this.levelItterator+1<Settings.chestRoomSettings.winIndices.length},ChestRoomManager.prototype.IsProgressRewardAvailable=function(){var e=this.GetCollection(SkinType.Hats,SkinRarity.Common),t=[];for(let n=0;n<e.length;n++){var r=e[n].script.reward;r.IsLocked()&&t.push(r)}return this.currentProgressRewardIndex+1<t.length},ChestRoomManager.prototype.GetCollection=function(e,t){var r=_.findWhere(this.bundles,{type:e}),n=null;if(r)for(let e=0;e<r.rewardCollection.length;e++){var s=r.rewardCollection[e];if(s.script.collection.rarity===t){n=s.script.collection.rewards;break}}return n},ChestRoomManager.prototype.GetCurrentPrizeByRarity=function(e,t){var r=t===SkinRarity.Premium?this.currentPremiumRewardIndex:t===SkinRarity.Common&&e===SkinType.Hats?this.currentProgressRewardIndex:t===SkinRarity.Common&&e===SkinType.Kicks?this.currentKickRewardIndex:this.currentShoeRewardIndex;return this.GetCollection(e,t)[r].script.reward},ChestRoomManager.prototype.UpdateCurrentPrize=function(e){this.GetCurrentPrizeByRarity(SkinType.Hats,SkinRarity.Premium).SetStatus(e)},ChestRoomManager.prototype.UpdateCurrentProgressPrize=function(e){this.GetCurrentPrizeByRarity(SkinType.Hats,SkinRarity.Common).SetStatus(e)},ChestRoomManager.prototype.UpdateCurrentKick=function(e){this.GetCurrentPrizeByRarity(SkinType.Kicks,SkinRarity.Common).SetStatus(e)},ChestRoomManager.prototype.GetCurrentPrizeData=function(e,t){return this.GetCurrentPrizeByRarity(e,t)},ChestRoomManager.prototype.GetCurrentProgressSkin=function(){return this.GetCurrentProgressPrize().data.icon.resource},ChestRoomManager.prototype.GetCurrentProgressPrize=function(){return this.GetCurrentPrizeData(SkinType.Hats,SkinRarity.Common)},ChestRoomManager.prototype.GetCurrentBestPrizeSkin=function(){return this.GetCurrentBestPrize().data.icon.resource},ChestRoomManager.prototype.GetCurrentBestPrize=function(){return this.GetCurrentPrizeData(SkinType.Hats,SkinRarity.Premium)},ChestRoomManager.prototype.GetRandomGemsReward=function(){return 25},ChestRoomManager.prototype.GetCommonPendulumUnlockSkin=function(){this.pendulumCounter>=4&&(this.pendulumCounter=0);var e=null;if(0!==this.pendulumCounter)return 1===this.pendulumCounter?(e={value:1,sprite:this.commonIcons.keyIcon.resource,rewardType:PendulumReward.Key},this.pendulumCounter++,e):(e={value:this.GetRandomGemsReward(),sprite:this.commonIcons.gemIcon.resource,rewardType:PendulumReward.GemsSmall},this.pendulumCounter++,e);var t=this.GetCollection(SkinType.Hats,SkinRarity.Common);if(t)for(let n=t.length-1;n>this.currentProgressRewardIndex;n--){var r=t[n].script.reward;if(r.IsLocked())return e={value:r,sprite:r.data.icon.resource,rewardType:PendulumReward.Skin},this.pendulumCounter++,e}return this.pendulumCounter++,e},ChestRoomManager.prototype.GetSkinReward=function(e){var t=e.skinType,r=_.findWhere(this.bundles,{type:t}),n=[];if(r)for(let e=0;e<r.rewardCollection.length;e++){var s=r.rewardCollection[e];n.push(s.script.collection.rewards)}if(n)for(let t=0;t<n.length;t++)for(let r=0;r<n[t].length;r++){let s=n[t][r].script.reward;if(s.entity.name===e.key)return s}},ChestRoomManager.prototype.GetRewards=function(e,t,r){var n=[],s=this.GetCollection(e,t);for(let e=0;e<s.length;e++){let t=s[e].script.reward;t.GetStatus()==r&&n.push(t)}return n},ChestRoomManager.prototype.GetRandomSkinReward=function(e){let t=this.GetRewards(e,SkinRarity.Common,SkinStatus.Available),r=null;if(t.length>0){r=t[_.random(0,t.length-1)]}return r},ChestRoomManager.prototype.GetUnlockedItemsOfType=function(e){let t=[];for(let s=0;s<this.bundles.length;s++){let o=this.bundles[s];if(o.type===e)for(let e=0;e<o.rewardCollection.length;e++){var r=o.rewardCollection[e].script.collection;for(let e=0;e<r.rewards.length;e++){var n=r.rewards[e].script.reward;n.IsUnlocked()&&t.push(n)}}}return t},ChestRoomManager.prototype.GetLockedItemsOfType=function(e){let t=[];for(let s=0;s<this.bundles.length;s++){let o=this.bundles[s];if(o.type===e)for(let e=0;e<o.rewardCollection.length;e++){var r=o.rewardCollection[e].script.collection;for(let e=0;e<r.rewards.length;e++){var n=r.rewards[e].script.reward;n.IsLocked()&&t.push(n)}}}return t},ChestRoomManager.prototype.GetItemsOfType=function(e){let t=[];for(let s=0;s<this.bundles.length;s++){let o=this.bundles[s];if(o.type===e)for(let e=0;e<o.rewardCollection.length;e++){var r=o.rewardCollection[e].script.collection;for(let e=0;e<r.rewards.length;e++){var n=r.rewards[e].script.reward;t.push(n)}}}return t},ChestRoomManager.prototype.GetItemsOfName=function(e,t){},ChestRoomManager.prototype.initialize=function(){ChestRoomManager=this,this.keys=0,this.winIndicesIndex=0,this.currentWinIndex=0,this.currentRewardProgress=0,this.currentProgressRewardIndex=0,this.currentPremiumRewardIndex=0,this.currentKickRewardIndex=0,this.currentShoeRewardIndex=0,this.levelItterator=0,this.bestPrizeFound=!1,this.pendulumCounter=0,this.app.on(Events.OnCollectablePicked,this.OnCollectablePicked,this),this.app.on(Events.OnLevelLoaded,this.OnLevelLoaded,this),this.app.on(Events.OnFightSequenceCompleted,this.OnFightSequenceCompleted,this),this.app.on("BigBossFighting:OnComplete",this.OnFightSequenceCompleted,this),this.app.on(Events.OnLevelCompleted,this.OnLevelCompleted,this),this.app.on(Events.OnKeysRefill,this.OnKeysRefill,this);for(let t=0;t<this.bundles.length;t++){let r=this.bundles[t];for(let t=0;t<r.rewardCollection.length;t++){var e=r.rewardCollection[t].script.collection;for(let t=0;t<e.rewards.length;t++)e.rewards[t].script.reward}}},ChestRoomManager.prototype.postInitialize=function(){this.keys=PlayerPrefs.GetInt("keys",0),this.levelItterator=this.GetLevelItterator(),this.winIndicesIndex=PlayerPrefs.GetInt("winIndex",0),this.pendulumCounter=PlayerPrefs.GetInt("pendulumCounter",0),this.currentProgressRewardIndex=PlayerPrefs.GetInt("progressRewardIndex",0)},ChestRoomManager.prototype.GetLevelItterator=function(){var e=localStorage.getItem("levelItterator");return(null==e||isNaN(e))&&(e=0),parseInt(e)},ChestRoomManager.prototype.OnKeysRefill=function(){this.UpdateKeysBalance(Settings.chestRoomSettings.keysFromRewardedVideo)},ChestRoomManager.prototype.OnLevelCompleted=function(){var e=this.currentRewardProgress;if(localStorage.setItem("rewardProgress",e),PlayerPrefs.SetItem("keys",this.keys),PlayerPrefs.SetItem("pendulumCounter",this.pendulumCounter),this.bestPrizeFound){var t=this.GetCurrentPrizeByRarity(SkinType.Hats,SkinRarity.Premium);t.SetCost(0),t.SetStatus(SkinStatus.Selected),PlayerPrefs.AppendItem("rewards",t.entity.name),PlayerPrefs.SetItem("SelectedHat",t.entity.name),this.winIndicesIndex++,PlayerPrefs.SetItem("winIndex",this.winIndicesIndex),this.app.fire(Events.OnSkinSelected,{key:t.entity.name,skinType:SkinType.Hats}),this.IsPremiumRewardAvailable()?(this.levelItterator++,localStorage.setItem("levelItterator",this.levelItterator)):Debug.log("No premium rewards available.")}},ChestRoomManager.prototype.OnLevelLoaded=function(e){this.bestPrizeFound=!1,this.levelItterator=this.GetLevelItterator(),this.currentWinIndex=this.winIndicesIndex<1?Settings.chestRoomSettings.firstIterationWinIndex:Settings.chestRoomSettings.winIndices[this.winIndicesIndex%Settings.chestRoomSettings.winIndices.length],this.currentPremiumRewardIndex=this.skinIndices.premium[this.levelItterator],this.UpdateRewardProgress()},ChestRoomManager.prototype.UpdateRewardProgress=function(){var e=Math.ceil(this.currentRewardProgress);if(Debug.log("ChestRoomManager ---\x3e OnLevelLoaded ---\x3e Progress ",e),e>=100){this.currentRewardProgress=0;var t=ChestRoomManager.GetCurrentProgressPrize();t.SetCost(0),t.IsUnlocked()?(t.SetStatus(SkinStatus.Selected),PlayerPrefs.SetItem("SelectedHat",t.entity.name)):t.IsLocked()&&t.SetStatus(SkinStatus.Available),PlayerPrefs.AppendItem("rewards",t.entity.name),this.IsProgressRewardAvailable()?(this.currentProgressRewardIndex++,PlayerPrefs.SetItem("progressRewardIndex",this.currentProgressRewardIndex)):Debug.log("No progress rewards available.")}},ChestRoomManager.prototype.GetChestReward=function(){var e=null,t=!1;return this.keys>0&&(this.currentWinIndex>0&&(this.currentWinIndex--,(t=this.currentWinIndex<=0)&&(this.bestPrizeFound=t)),this.UpdateKeysBalance(-1),e={value:this.GetRandomGemsReward(),type:t?2:0,icon:t?this.GetCurrentBestPrizeSkin():null,isBestPrize:t,winIndices:this.currentWinIndex,keys:this.keys}),e},ChestRoomManager.prototype.OnFightSequenceCompleted=function(){if(!(LevelInfo.level<=1)){var e=parseFloat(localStorage.getItem("rewardProgress"));(null===e||e<0||isNaN(e))&&(e=0,localStorage.setItem("rewardProgress",0)),e+=33.33,e=Math.ceil(e),Debug.log("Load Reward Progress ---\x3e ",e),this.currentRewardProgress=e,this.currentRewardProgress>100&&(this.currentRewardProgress=100)}},ChestRoomManager.prototype.UpdateKeysBalance=function(e){this.keys+=e,this.keys=pc.math.clamp(this.keys,0,Settings.chestRoomSettings.keysForOpenRoom)},ChestRoomManager.prototype.OnCollectablePicked=function(e){e.type===CollectableType.Key&&this.keys+1<=3&&this.UpdateKeysBalance(1)},ChestRoomManager.prototype.update=function(e){};var AttachmentsHandler=pc.createScript("attachmentsHandler");AttachmentsHandler.attributes.add("head",{type:"entity"}),AttachmentsHandler.attributes.add("crownParent",{type:"entity"}),AttachmentsHandler.attributes.add("feet",{type:"entity",array:!0}),AttachmentsHandler.prototype.initialize=function(){this.footGear=[],this.reward=null,this.headGear=null,this.rewardData=null,this.kickName="",AttachmentsHandler=this,this.app.on(Events.OnSkinSelected,this.OnSkinSelected,this),this.app.on(Events.OnSkinUnselected,this.OnSkinUnselected,this),this.app.on(Events.OnLevelCompleted,this.OnLevelCompleted,this),this.app.on(Events.OnCollectablePicked,this.OnCollectablePicked,this),this.app.on(Events.OnLoseLooksGoodOffer,this.OnLoseLooksGoodOffer,this),this.app.on(Events.OnKeepLooksGoodOffer,this.OnKeepLooksGoodOffer,this),this.app.on(Events.OnLevelLoaded,this.OnStartGame,this)},AttachmentsHandler.prototype.OnStartGame=function(){var e=PlayerPrefs.GetItem("SelectedHat",""),t=PlayerPrefs.GetItem("SelectedShoes","");if(this.kickName=PlayerPrefs.GetItem("SelectedKick",DataManager.Instance.defaultKick),this.footGear.length>0)for(let e=0;e<this.footGear.length;e++)this.footGear[e].enabled=!0;else""!==t&&this.OnSkinSelected({key:t,skinType:SkinType.Shoes});this.headGear?this.headGear.enabled=!0:""!==e&&this.OnSkinSelected({key:e,skinType:SkinType.Hats}),this.handleKickSelection({key:this.kickName,skinType:SkinType.Kicks})},AttachmentsHandler.prototype.postInitialize=function(){},AttachmentsHandler.prototype.OnLoseLooksGoodOffer=function(){this.reset()},AttachmentsHandler.prototype.OnKeepLooksGoodOffer=function(){this.keep()},AttachmentsHandler.prototype.OnLevelCompleted=function(){this.rewardData=null,this.skinPickup=!1;for(let e=0;e<this.footGear.length;e++)this.footGear[e].enabled=!1;this.headGear&&(this.headGear.enabled=!1)},AttachmentsHandler.prototype.OnCollectablePicked=function(e){e.skinType===SkinType.Shoes&&(this.skinPickup=!0,this.handleFootGear(e))},AttachmentsHandler.prototype.OnSkinSelected=function(e){e.skinType===SkinType.Hats&&this.handleHeadGear(e),e.skinType===SkinType.Shoes&&this.handleFootGear(e),e.skinType===SkinType.Kicks&&this.handleKickSelection(e)},AttachmentsHandler.prototype.OnSkinUnselected=function(e){if(e.skinType===SkinType.Hats&&this.headGear&&this.headGear.destroy(),e.skinType===SkinType.Shoes)for(let e=0;e<this.footGear.length;e++)this.footGear[e].destroy();e.skinType,SkinType.Kicks,this.unkeep()},AttachmentsHandler.prototype.handleKickSelection=function(e){var t=ChestRoomManager.GetSkinReward(e);t&&(this.kickName=t.entity.name,this.reward=t)},AttachmentsHandler.prototype.handleHeadGear=function(e){var t=ChestRoomManager.GetSkinReward(e),a=t.data,n=t.entity.clone();this.headGear&&this.headGear.destroy(),this.head.addChild(n),n.setLocalScale(1,1,1),n.setLocalPosition(0,0,0),n.setLocalEulerAngles(0,0,0),n.enabled=!0,this.headGear=n,this.rewardData=a,this.crownParent.enabled=null==n,this.reward=t},AttachmentsHandler.prototype.handleFootGear=function(e){var t=ChestRoomManager.GetSkinReward(e),a=t.data;this.reward=t;for(let e=0;e<this.footGear.length;e++)this.footGear[e].destroy();for(let e=0;e<this.feet.length;e++){var n=t.entity.clone();this.feet[e].addChild(n),n.setLocalScale(1,1,1),n.setLocalPosition(0,0,0),n.setLocalEulerAngles(0,0,0),n.enabled=!0,this.rewardData=a,this.footGear.push(n)}},AttachmentsHandler.prototype.keep=function(e){var t=this.reward;t.SetCost(0),t.SetStatus(SkinStatus.Selected),t.data.type===SkinType.Hats?PlayerPrefs.SetItem("SelectedHat",t.entity.name):t.data.type===SkinType.Shoes?PlayerPrefs.SetItem("SelectedShoes",t.entity.name):t.data.type===SkinType.Kicks&&PlayerPrefs.SetItem("SelectedKick",t.entity.name)},AttachmentsHandler.prototype.unkeep=function(){var e=this.reward;e&&e.entity.name!==DataManager.Instance.defaultKick&&e.SetStatus(SkinStatus.Unlocked),e.data.type===SkinType.Hats?PlayerPrefs.SetItem("SelectedHat",""):e.data.type===SkinType.Shoes?PlayerPrefs.SetItem("SelectedShoes",""):e.data.type===SkinType.Kicks&&PlayerPrefs.SetItem("SelectedKick",DataManager.Instance.defaultKick)},AttachmentsHandler.prototype.reset=function(){for(let e=0;e<this.footGear.length;e++)this.footGear[e].destroy();this.headGear&&this.headGear.destroy()};var BonusMultiplierView=pc.createScript("bonusMultiplierView");BonusMultiplierView.attributes.add("multiplierTxt",{type:"entity",title:"Multiplier Text"}),BonusMultiplierView.attributes.add("timeoutBar",{type:"entity",title:"Timeout Bar"}),BonusMultiplierView.attributes.add("eventKey",{type:"string",default:"FightView:MultiplierTimerOver"}),BonusMultiplierView.attributes.add("type",{type:"number",enum:[{FightView:0},{BonusView:1}],default:0}),BonusMultiplierView.prototype.initialize=function(){this.timeoutTimer=0,this.totalTimer=1,this.entity.on("SetMultiplier",this.setMultiplier,this),this.entity.on("SetTimeOut",this.setTimeOut,this),this.on("destroy",this.onDestroy,this)},BonusMultiplierView.prototype.update=function(t){if(0===this.type)this.updateTimeOut(t)},BonusMultiplierView.prototype.onDestroy=function(){this.off("destroy",this.onDestroy,this),this.entity.off("BonusMultiplierView:SetMultiplier",this.setMultiplier,this),this.entity.off("BonusMultiplierView:SetTimeOut",this.setTimeOut,this)},BonusMultiplierView.prototype.setMultiplier=function(t){this.multiplierTxt.element.text=`X${t.toFixed(1)}`},BonusMultiplierView.prototype.setTimeOut=function(){switch(this.timeoutBar.setLocalScale(1,1,1),this.type){case 0:case 1:this.timeoutTimer=Settings.biggBossFighting.finishHimDuration,this.totalTimer=Settings.biggBossFighting.finishHimDuration}},BonusMultiplierView.prototype.updateTimeOut=function(t){if(this.timeoutTimer<0)return;this.timeoutTimer-=t;let i=this.timeoutBar.getLocalScale();i.x=this.timeoutTimer/this.totalTimer,this.timeoutBar.setLocalScale(i.x,i.y,i.z),this.timeoutTimer<0&&this.app.fire(this.eventKey)};var Collection=pc.createScript("collection");Collection.attributes.add("rarity",{type:"number",enum:[{Common:0},{Premium:1}]}),Collection.attributes.add("purchaseType",{type:"number",enum:[{Gems:0},{Rewarded:1}]}),Collection.attributes.add("rewards",{type:"entity",array:!0}),Collection.prototype.initialize=function(){},Collection.prototype.update=function(t){};var DodgeGuideView=pc.createScript("dodgeGuideView");DodgeGuideView.attributes.add("fadeSpeed",{type:"number",title:"Fade Speed"}),DodgeGuideView.attributes.add("opacityBounds",{type:"vec2",title:"Opacity Bounds"}),DodgeGuideView.attributes.add("handGuide",{type:"entity",title:"Hand Guide"}),DodgeGuideView.attributes.add("arrowLeft",{type:"entity",title:"Arrow Left"}),DodgeGuideView.attributes.add("arrowRight",{type:"entity",title:"Arrow Right"}),DodgeGuideView.prototype.initialize=function(){this.begin=!1,this.on("enable",this.onEnable,this),this.on("disable",this.onDisable,this),this.on("destroy",this.onDestroy,this),this.entity.on("EnableOneSwipe",this.enableOneSwipe,this)},DodgeGuideView.prototype.postInitialize=function(){this.onEnable()},DodgeGuideView.prototype.onEnable=function(){this.time=0,this.begin=!0,LevelInfo.isBigBossLevel?this.enableOneSwipe(1):this.enableOneSwipe(0)},DodgeGuideView.prototype.onDisable=function(){this.begin=!1},DodgeGuideView.prototype.onDestroy=function(){this.off("enable",this.onEnable,this),this.off("disable",this.onDisable,this),this.off("destroy",this.onDestroy,this)},DodgeGuideView.prototype.update=function(e){this.updateArrowsBlink(e)},DodgeGuideView.prototype.updateArrowsBlink=function(e){if(!this.begin)return;this.time+=e*this.fadeSpeed;let t=(Math.sin(this.time)+1)/2,i=pc.math.lerp(this.opacityBounds.y,this.opacityBounds.x,t),o=pc.math.lerp(this.opacityBounds.y,this.opacityBounds.x,1-t);this.arrowLeft.element.opacity=i,this.arrowRight.element.opacity=o},DodgeGuideView.prototype.enableOneSwipe=function(e){let t=!1,i=!1,o=!1,n=100,s=-100;switch(e){case 0:t=!0,i=!0;break;case 2:t=!0,o=!0,n=-50,s=-250;break;case 1:i=!0,o=!0,n=150,s=350}this.handGuide.enabled=o,this.handGuide.fire("Set:FromPos",n),this.handGuide.fire("Set:ToPos",s),this.handGuide.fire("Set:Movement",t),this.arrowLeft.enabled=t,this.arrowRight.enabled=i};var Ga=pc.createScript("ga");!function(e,n,a,t){var i="script",r="GameAnalytics";e[r]=e[r]||function(){(e[r].q=e[r].q||[]).push(arguments)},a=n.createElement(i),t=n.getElementsByTagName(i)[0],a.async=1,a.src="https://download.gameanalytics.com/js/GameAnalytics-4.4.5.min.js",t.parentNode.insertBefore(a,t)}(window,document);var GaKeys={[ConfigManager.EnvTypes.None]:{GameKey:"0b26e8b53003e12fe8f1a66cde79cdc0",SecretKey:"1008244ae973b53b14294d11aa1f638235197714"},[ConfigManager.EnvTypes.Snap]:{GameKey:"0b26e8b53003e12fe8f1a66cde79cdc0",SecretKey:"1008244ae973b53b14294d11aa1f638235197714"},[ConfigManager.EnvTypes.Gamedistribution]:{GameKey:"0b26e8b53003e12fe8f1a66cde79cdc0",SecretKey:"1008244ae973b53b14294d11aa1f638235197714"},[ConfigManager.EnvTypes.Facebook]:{GameKey:"0b26e8b53003e12fe8f1a66cde79cdc0",SecretKey:"1008244ae973b53b14294d11aa1f638235197714"}};GameAnalytics("setEnabledInfoLog",!1),Ga.prototype.initialize=function(){let e=GaKeys[ConfigManager.instance.environmentType].GameKey,n=GaKeys[ConfigManager.instance.environmentType].SecretKey;ConfigManager.instance.environmentType!==ConfigManager.EnvTypes.None&&(GameAnalytics("initialize",e,n),this.app.on(Events.OnUpgradeKick,this.OnUpgradeKick,this),this.app.on(Events.OnUpgradeMultiplier,this.OnUpgradeMultiplier,this),this.app.on(Events.OnStartGame,this.OnStartGame,this),this.app.on(Events.OnLevelCompleted,this.OnLevelCompleted,this))},Ga.prototype.OnUpgradeKick=function(e){GameAnalytics("addDesignEvent","OnUpgradeKick",e)},Ga.prototype.OnUpgradeMultiplier=function(e){GameAnalytics("addDesignEvent","OnUpgradeMultiplier",e)},Ga.prototype.OnStartGame=function(e){e&&(this.currentLevel=LevelGenerator.prototype.GetCurrentLevel(),Debug.log(this.currentLevel),GameAnalytics("addProgressionEvent","Start","level"+this.currentLevel))},Ga.prototype.OnLevelCompleted=function(){GameAnalytics("addProgressionEvent","Complete","level"+this.currentLevel)};var BiggBossFightingSettings=pc.createScript("biggBossFightingSettings");BiggBossFightingSettings.attributes.add("levelsBetweenBigBoss",{type:"number",title:"Levels Between Big Boss"}),BiggBossFightingSettings.attributes.add("finishHimDelay",{type:"number",title:"Finish Him Delay"}),BiggBossFightingSettings.attributes.add("finishHimDuration",{type:"number",title:"Finish Him Duration"}),BiggBossFightingSettings.attributes.add("bossSettings",{title:"Boss Settings",type:"json",schema:[{name:"bossMaxPunches",type:"vec2",title:"Boss Max Punches"},{name:"bossScale",type:"number",title:"Boss Scale"},{name:"bossOffsetZ",type:"number",title:"Boss OffsetZ"},{name:"bossPunchShake",type:"number",title:"Boss Punch Shake"},{name:"bossTiredDuration",type:"number",title:"Boss Tired Duration"},{name:"bossSecondPunchDelay",type:"number",title:"Boss Second Punch Delay"}]}),BiggBossFightingSettings.attributes.add("heroSettings",{title:"Hero Settings",type:"json",schema:[{name:"heroMaxPunches",type:"number",title:"Hero Max Punches"},{name:"heroPunchShake",type:"number",title:"Hero Punch Shake"},{name:"dodgeDistance",type:"number",title:"Dodge Distance"},{name:"dodgeDuration",type:"number",title:"Dodge Duration"},{name:"heroTurnDuration",type:"number",title:"Hero Turn Duration"},{name:"heroRotationOffsetY",type:"number",title:"Hero Rotation OffsetY"},{name:"heroMaxAttackDelay",type:"number",title:"Hero Max Attack Delay"},{name:"heroOffsetFactor",type:"number",title:"Hero Offset Factor"}]}),BiggBossFightingSettings.attributes.add("damageSettings",{title:"Damage Settings",type:"json",schema:[{name:"heroDamage",type:"vec2",title:"Hero Damage"},{name:"bossDamage",type:"vec2",title:"Boss Damage"}]}),BiggBossFightingSettings.attributes.add("multiplierSettings",{title:"Multiplier Settings",type:"json",schema:[{name:"startMultiplier",type:"number",title:"Start Multiplier"},{name:"maxMultiplier",type:"number",title:"Max Multiplier"}]}),BiggBossFightingSettings.prototype.getBossPunches=function(){let e=pc.math.random(this.bossSettings.bossMaxPunches.x,this.bossSettings.bossMaxPunches.y);return Debug.log("getBossPunches: ",this.bossSettings.bossMaxPunches.x,this.bossSettings.bossMaxPunches.y,e,parseInt(e)),parseInt(e)};var TutorialManager=pc.createScript("tutorialManager");TutorialManager.attributes.add("level01FTUE",{type:"entity",array:!0}),TutorialManager.attributes.add("level02FTUE",{type:"entity",array:!0}),TutorialManager.attributes.add("toolTips",{type:"entity",array:!0}),TutorialManager.attributes.add("multiplierHandAnim",{type:"entity"}),TutorialManager.attributes.add("kickHandAnim",{type:"entity"}),TutorialManager.attributes.add("kickToolTip",{type:"entity"}),TutorialManager.instance=null,TutorialManager.prototype.initialize=function(){TutorialManager.instance=this,TutorialManager.instance.isLevelTutorial=!1,this.isKickUpgraded=!1,this.app.on(Events.OnLevelLoaded,this.OnLevelLoaded,this),this.app.on(Events.OnUpgradeKick,this.OnUpgradeKick,this)},TutorialManager.prototype.OnUpgradeKick=function(){this.isKickUpgraded||(this.isKickUpgraded=!0,this.multiplierHandAnim.enabled=!0,this.kickHandAnim.enabled=!0,this.kickToolTip.enabled=!1)},TutorialManager.prototype.OnLevelLoaded=function(t){switch(t.level){case 1:this.level_01_FTUE();break;case 2:this.level_02_FTUE();break;case 3:this.level_03_FTUE();break;default:this.enableAll()}},TutorialManager.prototype.enableAll=function(){this.setViewStatus(this.level01FTUE,!0),this.setViewStatus(this.level02FTUE,!0),this.setViewStatus(this.toolTips,!1),TutorialManager.instance.isLevelTutorial=!0},TutorialManager.prototype.level_01_FTUE=function(){this.app.fire("onGameMessageShow","Collect Stickmans!"),this.setViewStatus(this.level02FTUE,!1),this.setViewStatus(this.toolTips,!1),TutorialManager.instance.isLevelTutorial=!1},TutorialManager.prototype.level_02_FTUE=function(){this.enableAll(),this.app.fire("onGameMessageShow","Collect only right colors!"),this.setViewStatus(this.level02FTUE,!1),this.setViewStatus(this.toolTips,!0),TutorialManager.instance.isLevelTutorial=!1},TutorialManager.prototype.level_03_FTUE=function(){this.enableAll(),this.setViewStatus(this.level02FTUE,!1),this.setViewStatus(this.toolTips,!1),TutorialManager.instance.isLevelTutorial=!1},TutorialManager.prototype.setViewStatus=function(t,e){for(const a of t)a.enabled=e},TutorialManager.prototype.update=function(t){};var BiggBossFightingManager=pc.createScript("biggBossFightingManager");BiggBossFightingManager.Turn={player:0,boss:1},BiggBossFightingManager.prototype.initialize=function(){BiggBossFightingManager.Instance=this,this.app.on(Events.OnLevelLoaded,this.onLevelLoaded,this),this.app.on(Events.OnFinishLineReached,this.onFinishLineReached,this),this.app.on("BigBoss:TiredOfPunches",this.onBigBossTiredOfPunches,this),this.app.on("BigBoss:TirednessEnded",this.onBigBossTirednessEnded,this),this.app.on("BigBoss:Beaten",this.onBigBossBeaten,this),this.app.on("FightView:MultiplierTimerOver",this.onBonusTimeOver,this),this.app.on("BigBossFighting:BossKilled",this.onBossKilled,this),this.app.on("BigBossFighting:OnComplete",this.onComplete,this),this.app.on("BigBossFighting:UpdateDodgeTutorial",this.updateDodgeTutorial,this),this.app.on("BigBossFighting:ManageUI",this.uiEnableHelper,this)},BiggBossFightingManager.prototype.update=function(i){},BiggBossFightingManager.prototype.onLevelLoaded=function(i){let e=Settings.biggBossFighting.levelsBetweenBigBoss;this.isBigBossLevel=i.isBigBossLevel,this.isTutorialRequired=i.level%e==0,this.tutorial={dodgedRight:!1,dodgedLeft:!1}},BiggBossFightingManager.prototype.onFinishLineReached=function(){this.isBigBossLevel&&(this.app.fire(Events.OnChangeMenuState,MenuManager.States.BossFight),this.uiEnableHelper(!1,!0,!1),this.app.fire("BigBossFighting:Begin"))},BiggBossFightingManager.prototype.onBigBossTiredOfPunches=function(){this.uiEnableHelper(!0,!1,!1),this.app.fire("BigBossFighting:BossTired")},BiggBossFightingManager.prototype.onBigBossTirednessEnded=function(){this.uiEnableHelper(!1,!1,!1),this.app.fire("BigBossFighting:BossRage")},BiggBossFightingManager.prototype.onBigBossBeaten=function(){this.uiEnableHelper(!0,!1,!0),this.app.fire("BigBossFighting:BossBeaten")},BiggBossFightingManager.prototype.onBonusTimeOver=function(){this.uiEnableHelper(!1,!1,!1),this.app.fire("BigBossFighting:BonusTimeOver")},BiggBossFightingManager.prototype.onBossKilled=function(){this.uiEnableHelper(!1,!1,!1),this.app.fire("BigBossFighting:KillBoss")},BiggBossFightingManager.prototype.onComplete=function(){CustomCoroutine.Instance.set((()=>{this.app.fire("sound:playSound","LevelCompleted"),this.app.fire("changeMenuState",MenuManager.States.Win)}),1)},BiggBossFightingManager.prototype.uiEnableHelper=function(i,e,t){this.app.fire("FightView:EnableTapTap",i),this.app.fire("FightView:EnableDodgeGuide",e),this.isTutorialRequired&&e&&this.dodgeGuideTutorial(!0),this.app.fire("FightView:EnableBonusMultiplier",t)},BiggBossFightingManager.prototype.dodgeGuideTutorial=function(){this.tutorial.dodgedRight?this.tutorial.dodgedLeft?this.app.fire("FightView:SetDodgeGuide",0):this.app.fire("FightView:SetDodgeGuide",2):this.app.fire("FightView:SetDodgeGuide",1)},BiggBossFightingManager.prototype.updateDodgeTutorial=function(){this.tutorial.dodgedRight?this.tutorial.dodgedLeft||(this.tutorial.dodgedLeft=!0):this.tutorial.dodgedRight=!0};var SwipeEvent=pc.createScript("swipeEvent");SwipeEvent.direction={left:0,right:1,up:2,down:3},SwipeEvent.axis={x:0,y:1,xORy:2,xANDy:3},SwipeEvent.attributes.add("minimumSwipeDistance",{title:"Minimum Swipe Distance",type:"vec2"}),SwipeEvent.attributes.add("useAxis",{title:"Use Axis",type:"number",enum:[{x:SwipeEvent.axis.x},{y:SwipeEvent.axis.y},{"x || y":SwipeEvent.axis.xORy},{"x && y":SwipeEvent.axis.xANDy}]}),SwipeEvent.attributes.add("eventPreFix",{type:"string",title:"Event Pre Fix",default:"SwipeEvent:"}),SwipeEvent.attributes.add("eventPostFix",{title:"Event Post Fix",type:"json",schema:[{name:"leftSwipe",type:"string",title:"Left Swipe",default:"Left"},{name:"rightSwipe",type:"string",title:"Right Swipe",default:"Right"},{name:"upSwipe",type:"string",title:"Up Swipe",default:"Up"},{name:"downSwipe",type:"string",title:"Down Swipe",default:"Down"}]}),SwipeEvent.attributes.add("includeDir",{title:"Include Direction",type:"json",schema:[{name:"horizontal",type:"boolean",title:"Horizontal",default:!0},{name:"vertical",type:"boolean",title:"Vertical",default:!1}]}),SwipeEvent.attributes.add("args",{type:"json",title:"Arguments",schema:[{name:"value",type:"string"}],array:!0}),SwipeEvent.attributes.add("objsActiveState",{type:"json",title:"Entites",schema:[{title:"Enabled",name:"setActive",type:"boolean",default:!0},{title:"Use Input",name:"useInput",type:"boolean",default:!0},{title:"Entity",name:"obj",type:"entity"}],array:!0}),SwipeEvent.prototype.initialize=function(){this.initialized=!1,this.onEnable(),this.on("enable",this.onEnable,this),this.on("disable",this.onDisable,this),this.on("destroy",this.onDisable,this)},SwipeEvent.prototype.onEnable=function(){this.initialized||(this.initialized=!0,this.handle=this.entity,this.addHandleListeners(),this.touchId=-1,this.mousePos=new pc.Vec3,this.screen=this.getUIScreenComponent(),this.isCaptured=!1,this.isOnMe=!1,this.isCaptured=!1,this.isOnMe=!1)},SwipeEvent.prototype.onDisable=function(){this.initialized&&(this.initialized=!1,this.handle.element.off(pc.EVENT_MOUSEDOWN,this.onPressDown,this),this.app.mouse.off(pc.EVENT_MOUSEUP,this.onPressUp,this),this.app.touch&&(this.handle.element.off(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchEnd,this),this.app.touch.off(pc.EVENT_TOUCHCANCEL,this.onTouchEnd,this)))},SwipeEvent.prototype.getUIScreenComponent=function(){return this.handle.element.screen.screen},SwipeEvent.prototype.addHandleListeners=function(){this.handle.element.on(pc.EVENT_MOUSEDOWN,this.onPressDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onPressUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onPressMove,this),this.app.touch&&(this.handle.element.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchEnd,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchEnd,this))},SwipeEvent.prototype.onTouchStart=function(t){var e=t.changedTouches[0];this.touchId=e.identifier,this.startDrag(t.x,t.y),t.event.stopPropagation()},SwipeEvent.prototype.onTouchEnd=function(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e];if(i.id==this.touchId)return t.event.stopImmediatePropagation(),this.touchId=-1,void this.endDrag(i.x,i.y)}},SwipeEvent.prototype.onPressDown=function(t){t.event.stopImmediatePropagation(),this.startDrag(t.x,t.y)},SwipeEvent.prototype.onPressUp=function(t){t.event.stopImmediatePropagation(),this.endDrag(t.x,t.y)},SwipeEvent.prototype.startDrag=function(t,e){this.isOnMe=!0,this.setMouseXY(t,e)},SwipeEvent.prototype.endDrag=function(t,e){let i=Math.abs(t-this.mousePos.x),n=Math.abs(e-this.mousePos.y),s=t-this.mousePos.x<0?SwipeEvent.direction.left:SwipeEvent.direction.right,o=e-this.mousePos.y<0?SwipeEvent.direction.up:SwipeEvent.direction.down;this.isOnMe&&this.manageSwipe(i,n,s,o),this.isOnMe=!1},SwipeEvent.prototype.setMouseXY=function(t,e){this.mousePos.x=t,this.mousePos.y=e},SwipeEvent.prototype.manageSwipe=function(t,e,i,n){if(!this.entity.element.useInput)return;let s=!1;if(this.useAxis===SwipeEvent.axis.x?s=this.minimumSwipeDistance.x<t:this.useAxis===SwipeEvent.axis.y?s=this.minimumSwipeDistance.y<e:this.useAxis===SwipeEvent.axis.xORy?s=this.minimumSwipeDistance.x<t||this.minimumSwipeDistance.y<e:this.useAxis===SwipeEvent.axis.xANDy&&(s=this.minimumSwipeDistance.x<t&&this.minimumSwipeDistance.y<e),s){this.isCaptured=!0,this.raiseEvent(i,n);for(let t=0;t<this.objsActiveState.length;t++)this.objsActiveState[t].obj.enabled=this.objsActiveState[t].setActive,this.objsActiveState[t].obj.element.useInput=this.objsActiveState[t].useInput}},SwipeEvent.prototype.raiseEvent=function(t,e){let i=[],n=this.eventPreFix;this.includeDir.horizontal&&(t===SwipeEvent.direction.left?n+=this.eventPostFix.leftSwipe:t===SwipeEvent.direction.right&&(n+=this.eventPostFix.rightSwipe)),this.includeDir.vertical&&(e===SwipeEvent.direction.up?n+=this.eventPostFix.upSwipe:e===SwipeEvent.direction.down&&(n+=this.eventPostFix.downSwipe));for(let t=0;t<this.args.length;t++)i.push(this.args[t].value);this.app.fire(n,i)};var DodgePositionsBroadCaster=pc.createScript("dodgePositionsBroadCaster");DodgePositionsBroadCaster.attributes.add("positionRefs",{type:"entity",title:"Position References",array:!0}),DodgePositionsBroadCaster.prototype.initialize=function(){this.app.on(Events.OnFinishLineStarted,this.onFinishLineStarted,this)},DodgePositionsBroadCaster.prototype.onFinishLineStarted=function(){let t=[];for(let i=0;i<this.positionRefs.length;i++)t.push(this.positionRefs[i].getPosition());Debug.log("Positions: ",t),this.app.fire("DodgePositionsBroadCaster:Positions",t)};class PlayerBigBossFighting{constructor(t){this.reset(),this.controller=t,this.animator=t.PlayerAnimator.anim.baseLayer,this.rigidbody=t.PlayerRB,this.app=t.app}reset(){this.swipeIndex=0,this.attackingDelay=0,this.isFighting=!1,this.isMyTurn=!1,this.canAttack=!1,this.canDodge=!1,this.isBossBeaten=!1,this.dodgePositions=[]}setMultiplier(t,i){this.multiplier=t,this.mulIncrement=i}setDodgePositions(t){this.dodgePositions=[];for(let i=0;i<t.length;i++)this.dodgePositions.push(t[i].clone())}setDodgeCamera(t){this.app.fire(Events.OnChangeCameraState,CameraState["Dodge"+(t+1)],5)}setBossBeaten(){this.isBossBeaten=!0,this.app.fire("FightView:SetMultiplier",this.multiplier),this.app.fire("FightView:SetTimeOut",this.setTimeOut,this)}getSwipeIndex(t){return this.swipeIndex+=t===PlayerController.dodge.left?-1:1,this.swipeIndex<0?this.swipeIndex=3:this.swipeIndex>3&&(this.swipeIndex=0),this.swipeIndex}getAnimDuration(t){return this.animator._controller._states[t].timelineDuration}playerTurnToAttack(t){this.isMyTurn=t,this.canAttack=!1,this.attackingDelay=.2}attackBigBoss(t){this.isMyTurn&&this.canAttack&&(this.canAttack=!1,this.attackingDelay=Settings.biggBossFighting.heroSettings.heroMaxAttackDelay,this.controller.ProcessPunch(void 0,2),this.isBossBeaten&&(this.multiplier+=this.mulIncrement,this.app.fire("FightView:SetMultiplier",this.multiplier)),CustomCoroutine.Instance.set((()=>{this.app.fire("Player:PlayPunchVfx"),this.app.fire(Events.ShakeCamera,.4,.04,.1),this.isBossBeaten||this.app.fire("PlayerBigBossFighting:HitBigBoss",t)}),.15))}manageBigBossFighting(t){this.attackingDelay<=0||(this.attackingDelay-=t,this.attackingDelay<=0&&(this.canAttack=!0))}onBigBossFightStarted(){this.isFighting=!0,this.swipeIndex=0,this.canDodge=!0,this.playerTurnToAttack(!1),this.setDodgeCamera(0),this.controller.PlayAnim("Fight Idle")}onSwipe(t){if(!this.canDodge)return;this.app.fire("sound:playSound","DodgeJump"),this.canDodge=!1;let i=this.getSwipeIndex(t),e=this.rigidbody.getPosition(),s=this.dodgePositions[i],a=this.rigidbody.getLocalEulerAngles();TweenWrapper.TweenNumber(0,1,1,(t=>{let n=pc.math.lerp(e.x,s.x,t.number),o=pc.math.lerp(e.z,s.z,t.number);this.rigidbody.setPosition(n,e.y,o);let r=pc.math.lerpAngle(a.y,90*i,t.number);this.rigidbody.setLocalEulerAngles(a.x,r,a.z)}),(()=>{this.canDodge=!0,this.controller.PlayAnim("Fight Idle")})),this.setDodgeCamera(i),this.controller.ProcessDodge(t)}onBigBossRage(){this.controller.PlayAnim("Retreat");let t=this.controller.getAnimDuration("Retreat");CustomCoroutine.Instance.set((()=>{this.controller.PlayAnim("Fight Idle")}),t)}}var Reward=pc.createScript("reward");Reward.attributes.add("data",{type:"json",schema:[{name:"defaultStatus",type:"string",enum:[{Selected:"Selected"},{Available:"Available"},{Locked:"Locked"},{Unlocked:"Unlocked"}]},{name:"type",type:"number",enum:[{Hats:0},{Shoes:1},{Kicks:2}]},{name:"icon",type:"asset",assetType:"sprite"},{name:"animation",type:"asset",assetType:"animation"},{name:"cost",type:"number",default:0},{name:"costMax",type:"number",default:0}]}),Reward.prototype.SetStatus=function(t){PlayerPrefs.SetItem(this.entity.name,t)},Reward.prototype.GetCost=function(){return PlayerPrefs.GetInt(this.entity.name+"_Cost",this.data.costMax)},Reward.prototype.SetCost=function(t){PlayerPrefs.SetItem(this.entity.name+"_Cost",t)},Reward.prototype.GetMaxCost=function(){return this.data.costMax},Reward.prototype.GetStatus=function(){return PlayerPrefs.GetString(this.entity.name,this.data.defaultStatus)},Reward.prototype.IsAvailable=function(){return this.GetStatus()==SkinStatus.Available},Reward.prototype.IsLocked=function(){return this.GetStatus()==SkinStatus.Locked},Reward.prototype.IsUnlocked=function(){return this.GetStatus()==SkinStatus.Unlocked},Reward.prototype.IsSelected=function(){return this.GetStatus()==SkinStatus.Selected};var WaterController=pc.createScript("waterController");WaterController.attributes.add("waterRef",{type:"entity",title:"Water"}),WaterController.attributes.add("purpleWater",{title:"Bonus Level Settings",type:"json",schema:[{name:"tiling",type:"vec2",title:"Tiling"},{name:"color",type:"rgb",title:"Color"}]}),WaterController.attributes.add("lava",{title:"Big Boss Settings",type:"json",schema:[{name:"tiling",type:"vec2",title:"Tiling"},{name:"speed",type:"number",title:"Speed"},{name:"color",type:"rgb",title:"Color"},{name:"lightColor",type:"rgb",title:"Light Color"}]}),WaterController.attributes.add("colorSettings",{title:"Color Settings",type:"json",schema:[{name:"maxLevel",type:"number",title:"Max Level",description:"Maximum Level till this color settings will be applied."},{name:"keepDefault",type:"boolean",title:"Default Palette"},{name:"tiling",type:"vec2",title:"Tiling"},{name:"color",type:"rgb",title:"Color"}],array:!0}),WaterController.prototype.initialize=function(){this.lavaLerp=0,this.lavaDir=1,this.color=this.waterRef.render.meshInstances[0].material.diffuse,this.app.on(Events.OnLevelLoaded,this.onLevelLoaded,this)},WaterController.prototype.update=function(e){this.isBigBossLevel&&(this.lavaLerp+=this.lavaDir*this.lava.speed*e,this.lavaLerp=pc.math.clamp(this.lavaLerp,0,1),this.color.lerp(this.lava.lightColor,this.lava.color,this.lavaLerp),1!==this.lavaLerp&&0!==this.lavaLerp||(this.lavaDir*=-1),this.updateColor(this.color))},WaterController.prototype.onLevelLoaded=function(e){let t,l;if(this.isBigBossLevel=e.isBigBossLevel,e.isBigBossLevel)t=this.lava.color,l=this.lava.tiling;else if(e.isBonusLevel)t=this.purpleWater.color,l=this.purpleWater.tiling;else{let i=this.getLevelColors(e.level);t=i.color,l=i.tiling}Debug.log("tiling: ",l),this.waterRef.render.meshInstances[0].material.normalMapTiling=l,this.updateColor(t)},WaterController.prototype.updateColor=function(e){this.waterRef.render.meshInstances[0].material.diffuse.set(e.r,e.g,e.b),this.waterRef.render.meshInstances[0].material.update()},WaterController.prototype.getLevelColors=function(e){let t;for(let l=0;l<this.colorSettings.length;l++)if(!this.colorSettings[l].keepDefault&&this.colorSettings[l].maxLevel>=e%20){t={tiling:this.colorSettings[l].tiling,color:this.colorSettings[l].color};break}return t||{tiling:this.colorSettings[0].tiling,color:this.colorSettings[0].color}};var ChestRoomUiviewEventListener=pc.createScript("chestRoomUiviewEventListener");ChestRoomUiviewEventListener.attributes.add("bestPrize",{type:"entity"}),ChestRoomUiviewEventListener.attributes.add("chests",{type:"entity",array:!0}),ChestRoomUiviewEventListener.attributes.add("keys",{type:"entity",array:!0}),ChestRoomUiviewEventListener.attributes.add("vfxTestBtn",{type:"entity"}),ChestRoomUiviewEventListener.attributes.add("keysParent",{type:"entity"}),ChestRoomUiviewEventListener.attributes.add("buttonsParent",{type:"entity"}),ChestRoomUiviewEventListener.attributes.add("watchVideoButton",{type:"entity"}),ChestRoomUiviewEventListener.attributes.add("noThanksButton",{type:"entity"}),ChestRoomUiviewEventListener.instance=null,ChestRoomUiviewEventListener.prototype.initialize=function(){ChestRoomView=this,ChestRoomUiviewEventListener.instance=this,this.vfxIndex=0,this.loadingScreen=this.app.root.findByName("LoadScreen"),this.onEnable(),this.on("enable",this.onEnable,this),this.loadingAdScreen=this.app.root.findByName("Loading Ad Screen"),this.watchVideoButton.button.on("click",this.onWatchVideoPressUp,this),this.noThanksButton.button.on("click",this.onNoThanksPressUp,this),this.vfxTestBtn.button.on("click",(()=>{this.chests[this.vfxIndex].fire("PlayVfx"),this.vfxIndex++,this.vfxIndex>=this.chests.length&&(this.vfxIndex=0)})),this.clicked=!1},ChestRoomUiviewEventListener.prototype.onWatchVideoPressUp=async function(){if(ConfigManager.instance.environmentType!==ConfigManager.EnvTypes.None){const e=ChestRoomUiviewEventListener.instance.resumeGiveReward.bind(this),t=ChestRoomUiviewEventListener.instance.pauseGame.bind(this),i=ChestRoomUiviewEventListener.instance.resumeNoReward.bind(this),n=ChestRoomUiviewEventListener.instance.adNotAvailable.bind(this);this.app.fire("showRewardedAD",e,t,i,n)}else this.OnRewardSuccess()},ChestRoomUiviewEventListener.prototype.OnRewardSuccess=function(){ChestRoomManager.keys<Settings.chestRoomSettings.keysFromRewardedVideo&&(this.app.fire(Events.OnKeysRefill),this.UpdateKeys(ChestRoomManager.keys),this.watchVideoButton.enabled=!1,this.noThanksButton.enabled=!1)},ChestRoomUiviewEventListener.prototype.OnRewardFailed=function(){this.onNoThanksPressUp(),this.noThanksButton.enabled=!1,this.watchVideoButton.enabled=!1},ChestRoomUiviewEventListener.prototype.UpdateKeys=function(e){this.keysParent.enabled=!0;for(let t=0;t<this.keys.length;t++)this.keys[t].enabled=t<e},ChestRoomUiviewEventListener.prototype.AllChestsOpened=function(){var e=_.every(this.chests,(function(e){return!0===e.script.chestUibutton.clicked}));return Debug.log("AllChestsOpened: ",e),e},ChestRoomUiviewEventListener.prototype.onNoThanksPressUp=function(){this.bestPrizeFound?this.app.fire(Events.OnChangeMenuState,MenuManager.States.SkinUnlockedView):(this.loadingScreen.enabled=!0,this.app.fire(Events.OnLevelCompleted),this.app.fire(Events.OnChangeMenuState,MenuManager.States.Home),setTimeout((()=>{this.loadingScreen.enabled=!1}),1500))},ChestRoomUiviewEventListener.prototype.postInitialize=function(){for(let e=0;e<this.chests.length;e++)this.chests[e].name="Chest_"+e},ChestRoomUiviewEventListener.prototype.onEnable=function(){this.bestPrizeFound=!1,this.lastChestClicked=null,this.bestPrize.element.sprite=ChestRoomManager.GetCurrentBestPrizeSkin(),this.UpdateKeys(ChestRoomManager.keys),this.watchVideoButton.enabled=!1,this.noThanksButton.enabled=!1;for(let e=0;e<this.chests.length;e++)this.chests[e].script.chestUibutton.reset();Debug.log("BestPrizeFound: ",this.bestPrizeFound)},ChestRoomUiviewEventListener.prototype.OnChestClicked=function(e){var t=this.AllChestsOpened();if(ChestRoomManager.keys<=0)Debug.log("Keys: ",ChestRoomManager.keys," halting further code execution.");else if(t)Debug.log("AllChestsOpened: ",t," halting further code execution.");else{var i=ChestRoomManager.GetChestReward();if(this.bestPrizeFound=i.isBestPrize,GemsManager.collectedGems+=i.value,this.lastChestClicked=e,e.script.chestUibutton.UpdateChest(i),Debug.log("BestPrizeFound: ",this.bestPrizeFound),this.UpdateKeys(i.keys),i.winIndices>0&&i.keys<=0&&!this.AllChestsOpened())this.watchVideoButton.enabled=!0,this.noThanksButton.enabled=!0;else if(this.AllChestsOpened()){this.UpdateKeys(0),this.watchVideoButton.enabled=!1,this.noThanksButton.enabled=!1;var n=this;setTimeout((function(){n.onNoThanksPressUp()}),1500)}else!this.AllChestsOpened()&&i.keys<=0&&(this.watchVideoButton.enabled=!0,this.noThanksButton.enabled=!0)}},ChestRoomUiviewEventListener.prototype.resumeGiveReward=function(){this.loadingAdScreen.enabled=!1,this.OnRewardSuccess()},ChestRoomUiviewEventListener.prototype.pauseGame=function(){this.loadingAdScreen.enabled=!0},ChestRoomUiviewEventListener.prototype.resumeNoReward=function(){this.loadingAdScreen.enabled=!1,this.app.fire("adSkippedPopup"),this.OnRewardFailed()},ChestRoomUiviewEventListener.prototype.adNotAvailable=function(){this.loadingAdScreen.enabled=!1,this.app.fire("noAdPopup"),this.OnRewardFailed()},ChestRoomUiviewEventListener.prototype.update=function(e){};var CameraShake=pc.createScript("cameraShake");CameraShake.attributes.add("shakeInterval",{type:"number",default:.1,title:"Camera Shake Interval"}),CameraShake.attributes.add("maxShakeDistance",{type:"number",default:.1,title:"Max Shake Distance"}),CameraShake.attributes.add("duration",{type:"number",default:1,title:"Duration"}),CameraShake.prototype.initialize=function(){this.time=this.duration,this.timeSinceLastShake=0,this.startPosition=this.entity.getPosition().clone(),this.app.on("camera:shake",this.onStartShake,this),this.on("destroy",(function(){this.app.off("camera:shake",this.onStartShake,this)}),this)},CameraShake.prototype.update=function(t){if(this.time+=t,this.time<this.duration&&(this.timeSinceLastShake+=t,this.timeSinceLastShake>=this.shakeInterval)){var a=1-pc.math.clamp(this.time/this.duration,0,1),i=2*Math.PI*pc.math.random(0,1),e=pc.math.random(0,this.maxShakeDistance)*a+pc.math.random(0,this.maxShakeDistance)*a,s=e>1?2-e:e,h=s*Math.cos(i),n=s*Math.sin(i);this.entity.setLocalPosition(this.startPosition.x+h,this.startPosition.y+n,this.startPosition.z),this.timeSinceLastShake-=this.shakeInterval}},CameraShake.prototype.onStartShake=function(){let t=this.entity.getPosition();this.startPosition.set(t.x,t.y,t.z),this.time=0};var ChestUibutton=pc.createScript("chestUibutton");ChestUibutton.attributes.add("gemRegularPrize",{type:"entity"}),ChestUibutton.attributes.add("gemBestPrize",{type:"entity"}),ChestUibutton.attributes.add("skinBestPrize",{type:"entity"}),ChestUibutton.attributes.add("gemRegularPrizeText",{type:"entity"}),ChestUibutton.attributes.add("gemBestPrizeText",{type:"entity"}),ChestUibutton.attributes.add("skinBestPrizeIcon",{type:"entity"}),ChestUibutton.attributes.add("chestImg",{type:"entity",title:"Chest Image"}),ChestUibutton.attributes.add("openVfx",{type:"entity",title:"Open VFX"}),ChestUibutton.prototype.initialize=function(){this.entity.on("PlayVfx",(()=>{this.openVfx.fire("Play")})),this.entity.element.on(pc.EVENT_MOUSEUP,this.onPressUp,this),this.clicked=!1,this.app.touch&&this.entity.element.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this)},ChestUibutton.prototype.onPressUp=function(){if(Debug.log("onPressUp: ",this.entity.name),!this.clicked){var t=this.entity;ChestRoomView.OnChestClicked(t)}},ChestUibutton.prototype.onTouchStart=function(){if(!this.clicked){var t=this.entity;ChestRoomView.OnChestClicked(t)}},ChestUibutton.prototype.UpdateChest=function(t){switch(this.chestImg.fire("disable"),this.clicked=!0,t.type){case 0:this.gemBestPrize.enabled=!1,this.skinBestPrize.enabled=!1,this.gemRegularPrize.enabled=!0,this.gemRegularPrizeText.element.text=t.value,this.openVfx.fire("Play");break;case 1:this.gemBestPrize.enabled=!0,this.skinBestPrize.enabled=!1,this.gemRegularPrize.enabled=!1,this.gemRegularPrizeText.element.text=t.value,this.openVfx.fire("Play");break;case 2:this.gemBestPrize.enabled=!1,this.skinBestPrize.enabled=!0,this.gemRegularPrize.enabled=!1,this.skinBestPrizeIcon.element.sprite=t.icon,this.openVfx.fire("Play")}},ChestUibutton.prototype.reset=function(){this.clicked=!1,this.chestImg.enabled=!0,this.gemBestPrize.enabled=!1,this.skinBestPrize.enabled=!1,this.gemRegularPrize.enabled=!1},ChestUibutton.prototype.update=function(t){};var VfxController=pc.createScript("vfxController");VfxController.attributes.add("restoreEvent",{type:"string",title:"Restore Event"}),VfxController.attributes.add("lifeTimeRange",{type:"vec2",title:"Life Time Range"}),VfxController.attributes.add("spriteEntity",{type:"entity",title:"Sprite Entity"}),VfxController.attributes.add("rotationEntity",{type:"entity",title:"Rotation Entity"}),VfxController.attributes.add("scaleEntity",{type:"entity",title:"Scale Entity"}),VfxController.attributes.add("orientationSettings",{title:"Orientation Settings",type:"json",schema:[{name:"screenSpace",type:"boolean",title:"Screen Space"},{name:"offset",type:"vec3",title:"Offset"}]}),VfxController.attributes.add("colorSettings",{title:"Color Settings",type:"json",schema:[{name:"useColor",type:"boolean",title:"Use Color"},{name:"colors",type:"rgb",title:"Color Over Life Time",array:!0},{name:"startOpacity",type:"number",title:"Start Opcacity",default:1},{name:"endOpacity",type:"number",title:"End Opcacity",default:1}]}),VfxController.attributes.add("sizeSettings",{title:"Size Settings",type:"json",schema:[{name:"useSize",type:"boolean",title:"Use Size"},{name:"axis",type:"string",title:"Axis",default:"xyz"},{name:"size",type:"vec2",title:"Size Over Life Time"}]}),VfxController.attributes.add("posSettings",{title:"Position Settings",type:"json",schema:[{name:"resetBeforePlay",type:"boolean",title:"Reset Before Play"},{name:"speed",type:"vec3",title:"Speed"},{name:"obj",type:"entity",title:"Entity"}]}),VfxController.prototype.initialize=function(){this.camera=this.app.root.findByTag("Main Camera")[0],this.on("enable",this.onEnable,this),this.entity.on("setSpriteRotation",this.setSpriteRotation,this),this.entity.on("setSpritePosition",this.setSpritePosition,this),this.entity.on("setScale",this.setScale,this)},VfxController.prototype.postInitialize=function(){this.onEnable()},VfxController.prototype.onEnable=function(){if(this.age=0,this.scaleRatio=1,this.startPos?this.posSettings.obj.setLocalPosition(this.startPos.x,this.startPos.y,this.startPos.z):this.posSettings.obj&&(this.startPos=this.posSettings.obj.getLocalPosition()),this.lifeTime=pc.math.random(this.lifeTimeRange.x,this.lifeTimeRange.y),this.colorSettings.useColor&&(this.color=this.colorSettings.colors[0]),this.sizeSettings.useSize&&(this.size=this.sizeSettings.size.x),this.posSettings.resetBeforePlay)if(this.defaultPos)this.posSettings.obj.setLocalPosition(this.defaultPos.x,this.defaultPos.y,this.defaultPos.y);else{let t=this.posSettings.obj.getLocalPosition();this.defaultPos=new pc.Vec3(t.x,t.y,t.z)}},VfxController.prototype.update=function(t){this.age>=this.lifeTime||(this.age+=t,this.lookAtScreen(),this.updateColor(t),this.updateSize(t),this.updateOpacity(t),this.updatePos(t),this.age>=this.lifeTime&&(this.entity.enabled=!1))},VfxController.prototype.setSpriteRotation=function(t,e,i){this.rotationEntity.setLocalEulerAngles(t,e,i)},VfxController.prototype.setSpritePosition=function(t,e,i){this.spriteEntity.parent.setLocalPosition(t,e,i)},VfxController.prototype.setScale=function(t){this.scaleRatio=t},VfxController.prototype.lookAtScreen=function(){if(!this.orientationSettings.screenSpace)return;let t=this.camera.getPosition();t.x+=this.orientationSettings.offset.x,t.y+=this.orientationSettings.offset.y,t.z+=this.orientationSettings.offset.z,this.entity.lookAt(t.x,t.y,t.z)},VfxController.prototype.updateColor=function(t){this.colorSettings.useColor&&this.spriteEntity&&(this.spriteEntity.sprite?this.spriteEntity.sprite.color=Math.evaluateColor(this.colorSettings.colors,this.age/this.lifeTime):this.spriteEntity.element&&(this.spriteEntity.element.color=Math.evaluateColor(this.colorSettings.colors,this.age/this.lifeTime)))},VfxController.prototype.updateSize=function(t){if(!this.sizeSettings.useSize)return;let e=pc.math.lerp(this.sizeSettings.size.x,this.sizeSettings.size.y,this.age/this.lifeTime);e*=this.scaleRatio;let i=this.scaleEntity.getLocalScale(),s=this.sizeSettings.axis.includes("x"),o=this.sizeSettings.axis.includes("y"),n=this.sizeSettings.axis.includes("z");this.scaleEntity.setLocalScale(s?e:i.x,o?e:i.y,n?e:i.z)},VfxController.prototype.updateOpacity=function(t){let e=pc.math.lerp(this.colorSettings.startOpacity,this.colorSettings.endOpacity,this.age/this.lifeTime);this.spriteEntity.sprite?this.spriteEntity.sprite.opacity=e:this.spriteEntity.element&&(this.spriteEntity.element.opacity=e)},VfxController.prototype.updatePos=function(t){if(!this.posSettings.obj)return;let e=this.posSettings.obj.getLocalPosition();e.x+=t*this.posSettings.speed.x,e.y+=t*this.posSettings.speed.y,e.z+=t*this.posSettings.speed.z,this.posSettings.obj.setLocalPosition(e.x,e.y,e.z)};var MobileSafeArea=pc.createScript("mobileSafeArea");MobileSafeArea.attributes.add("debugConfig",{type:"json",name:"Debug Config",description:"Force safe areas to be applied to the UI. Useful testing layouts without a device.",schema:[{name:"enabled",type:"boolean",default:!1},{name:"top",type:"number",default:0},{name:"bottom",type:"number",default:0},{name:"left",type:"number",default:0},{name:"right",type:"number",default:0}]}),document.documentElement.style.setProperty("--sat","env(safe-area-inset-top)"),document.documentElement.style.setProperty("--sab","env(safe-area-inset-bottom)"),document.documentElement.style.setProperty("--sal","env(safe-area-inset-left)"),document.documentElement.style.setProperty("--sar","env(safe-area-inset-right)"),MobileSafeArea.prototype.initialize=function(){this.app.graphicsDevice.on("resizecanvas",this._onCanvasResize,this),this.on("attr:debugConfig",(function(e,t){this._safeAreaUpdate()}),this),this.on("destroy",(function(){this.app.graphicsDevice.off("resizecanvas",this._onCanvasResize,this)}),this),this._onCanvasResize()},MobileSafeArea.prototype._onCanvasResize=function(){this.entity.element.margin=pc.Vec4.ZERO,this._initialHeight=this.entity.element.height,this._initialWidth=this.entity.element.width,this._safeAreaUpdate()},MobileSafeArea.prototype._safeAreaUpdate=function(){var e=0,t=0,i=0,n=0;this.debugConfig.enabled?(e=this.debugConfig.top,t=this.debugConfig.bottom,i=this.debugConfig.left,n=this.debugConfig.right):(e=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sat")),t=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sab")),i=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sal")),n=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sar")));var a=window.innerHeight,s=window.innerWidth,o=e/a,r=t/a,l=i/s,m=n/s,d=this._initialHeight*o,u=this._initialHeight*r,h=this._initialWidth*l,p=this._initialWidth*m,f=this.entity.element.margin;f.x=h,f.y=u,f.z=p,f.w=d,this.entity.element.margin=f};var Vfxmanager=pc.createScript("vfxmanager");Vfxmanager.attributes.add("sharpLine",{type:"entity",title:"Sharp Line Pool"}),Vfxmanager.attributes.add("ring",{type:"entity",title:"Ring Pool"}),Vfxmanager.prototype.initialize=function(){Vfxmanager.Instance=this,this.sharpLinePool=this.sharpLine.script.PoolController,this.ringPool=this.ring.script.PoolController},Vfxmanager.prototype.getSharpLine=function(){return this.sharpLinePool.get()},Vfxmanager.prototype.getRing=function(){return this.ringPool.get()};var EmojiManager=pc.createScript("emojiManager");EmojiManager.attributes.add("emojisCorrect",{type:"asset",array:!0}),EmojiManager.attributes.add("emojisInCorrect",{type:"asset",array:!0}),EmojiManager.attributes.add("emojiImg",{type:"entity"}),EmojiManager.prototype.initialize=function(){this.app.on("onCorrectMobHit",this.onCorrectMobHit,this),this.app.on("onInCorrectMobHit",this.onInCorrectMobHit,this),this.isTweenRunning=!1},EmojiManager.prototype.isChance=function(){return getRandomInt(0,100)<80},EmojiManager.prototype.onCorrectMobHit=function(){this.isChance()&&this.showEmoji(this.emojisCorrect)},EmojiManager.prototype.onInCorrectMobHit=function(){this.isChance()&&this.showEmoji(this.emojisInCorrect)},EmojiManager.prototype.showEmoji=function(t){if(!this.isTweenRunning){this.isTweenRunning=!0;var e=t[Math.floor(Math.random()*t.length)];this.emojiImg.element.opacity=1,this.emojiImg.setLocalScale(0,0,0),this.emojiImg.element.sprite=e.resource,this.emojiImg.enabled=!0,this.emojiImg.tween(this.emojiImg.getLocalScale()).to(new pc.Vec3(1,1,1),.55,pc.BounceOut).start().on("complete",(()=>{CustomCoroutine.Instance.set((()=>{TweenWrapper.TweenOpacity(this.emojiImg,1,0,.2,(()=>{this.isTweenRunning=!1,this.emojiImg.enabled=!1}))}),.25)}))}},EmojiManager.prototype.update=function(t){};var PunchVfxController=pc.createScript("punchVfxController");PunchVfxController.attributes.add("scaleRef",{type:"entity",title:"Scale Reference"}),PunchVfxController.attributes.add("ringVFX",{type:"entity",title:"Ring VFX"}),PunchVfxController.attributes.add("sharpLines",{type:"entity",title:"Sharp Lines",array:!0}),PunchVfxController.prototype.initialize=function(){this.entity.on("Play",this.play,this)},PunchVfxController.prototype.play=function(t){this.entity.setLocalPosition(t.x,t.y,t.z);let e=parseInt(pc.math.random(0,100))%2+2,i=pc.math.random(0,359),n=e>=3;for(let t=0;t<e;t++)this.sharpLines[t].enabled=!0;for(let t=0;t<e;t++)this.sharpLines[t].enabled=!0,this.sharpLines[t].fire("setScale",1/this.scaleRef.getLocalScale().x),this.sharpLines[t].fire("setSpriteRotation",0,0,i+30*t+(n&&t>1?165:0));this.ringVFX.enabled=!0,this.ringVFX.fire("setScale",1/this.scaleRef.getLocalScale().x)};var ParticleManager=pc.createScript("particleManager");ParticleManager.attributes.add("mobHitEffect",{type:"asset",array:!0}),ParticleManager.attributes.add("painterEffect",{type:"asset",array:!0}),ParticleManager.attributes.add("playerEntity",{type:"entity"}),ParticleManager.attributes.add("playerUpgradeEffect",{type:"entity"}),ParticleManager.attributes.add("keyVFX",{type:"entity"}),ParticleManager.prototype.initialize=function(){this.app.on("onMobHit",this.onMobHit,this),this.app.on("onPainterHit",this.onPainterHit,this),this.app.on("onKeyHit",this.onKeyHit,this),this.app.on("onKickUp",this.onUpgradeKick,this),this.app.on("onMultiUpgraded",this.onUpgradeMultiplier,this)},ParticleManager.prototype.onUpgradeKick=function(){this.runUpgradeEffect()},ParticleManager.prototype.onKeyHit=function(){Debug.log("key"),this.keyVFX.script.keyVfx.runVFX()},ParticleManager.prototype.onUpgradeMultiplier=function(){this.runUpgradeEffect()},ParticleManager.prototype.runUpgradeEffect=function(){this.playerUpgradeEffect.particlesystem.reset(),this.playerUpgradeEffect.particlesystem.play()},ParticleManager.prototype.onPainterHit=function(t){let e=this.painterEffect[t].resource.instantiate();this.playerEntity.addChild(e),e.setLocalPosition(0,-.8,0),e.enabled=!0,e.particlesystem.reset(),e.particlesystem.play(),e.script.vfxDestroyTime.setTime(1)},ParticleManager.prototype.onMobHit=function(t,e){},ParticleManager.prototype.update=function(t){};var VfxDestroyTime=pc.createScript("vfxDestroyTime");VfxDestroyTime.prototype.initialize=function(){},VfxDestroyTime.prototype.setTime=function(t){CustomCoroutine.Instance.set((()=>{this.entity.destroy()}),t)},VfxDestroyTime.prototype.update=function(t){};var SnapLeaderboard=pc.createScript("snapLeaderboard");const SNAP_LeaderboardId="";SnapLeaderboard.prototype.initialize=function(){this.app.on("showLeaderboardMenu",this.onShowLeaderboard,this),this.app.on("postTournamentScore",this.onPostTournamentScore,this)},SnapLeaderboard.prototype.onShowLeaderboard=function(){sc.app&&sc.presentLeaderboard("").then((function(o){Debug.log(o)}))},SnapLeaderboard.prototype.onPostTournamentScore=function(o){sc.app&&sc.submitLeaderboardScore("",o).then((function(o){Debug.log(o)}))},SnapLeaderboard.prototype.update=function(o){};var TargetLocking=pc.createScript("targetLocking");TargetLocking.attributes.add("rotationSpeed",{type:"number",title:"Rotation Speed"}),TargetLocking.attributes.add("appearSpeed",{type:"number",title:"Appear Speed"}),TargetLocking.attributes.add("arrows",{type:"entity"}),TargetLocking.attributes.add("arrowsScale",{type:"vec2"}),TargetLocking.attributes.add("arrowsSpeed",{type:"number"}),TargetLocking.attributes.add("parentPos",{type:"entity"}),TargetLocking.attributes.add("positions",{type:"entity",array:!0}),TargetLocking.prototype.initialize=function(){this.scaleDir=1,this.lerpVal=0,this.targetScale=new pc.Vec3,this.isActive=!1,this.on("enable",this.onEnable,this),this.app.on("TargetLocking:Show",this.show,this)},TargetLocking.prototype.onEnable=function(){this.isActive=!1,this.scaleDir=1,this.lerpVal=0},TargetLocking.prototype.update=function(t){if(!this.isActive)return;this.entity.rotateLocal(0,this.rotationSpeed,0),this.lerpVal+=this.scaleDir*this.arrowsSpeed*t,this.lerpVal=pc.math.clamp(this.lerpVal,0,1);let e=pc.math.lerp(this.arrowsScale.x,this.arrowsScale.y,this.lerpVal);1!==this.lerpVal&&0!==this.lerpVal||(this.scaleDir*=-1),this.arrows.setLocalScale(e,e,e)},TargetLocking.prototype.show=function(t,e){let i=2,a=0;t?this.isActive=!0:(i=0,a=2);let s=this.parentPos.getLocalPosition(),r=this.positions[e].getLocalPosition();this.entity.setLocalPosition(r.x+s.x,r.y+s.y,r.z+s.z),this.entity.setLocalScale(a,a,a),this.targetScale.set(i,i,i),TweenWrapper.Tween(this.entity,this.entity.getLocalScale(),this.targetScale,this.appearSpeed,(()=>{this.isActive=t}),pc.BackOut)};var HandGuide=pc.createScript("handGuide");HandGuide.attributes.add("duration",{type:"number",title:"Duration"}),HandGuide.attributes.add("fromPos",{type:"vec3",title:"From Position"}),HandGuide.attributes.add("toPos",{type:"vec3",title:"To Position"}),HandGuide.prototype.initialize=function(){this.entity.on("Set:Movement",this.setMovement,this),this.entity.on("Set:Duration",this.setDuration,this),this.entity.on("Set:FromPos",this.setFromPos,this),this.entity.on("Set:ToPos",this.setToPos,this),this.to=new pc.Vec3,this.from=new pc.Vec3},HandGuide.prototype.setMovement=function(t){this.entity.setLocalPosition(this.fromPos.x,this.fromPos.y,this.fromPos.z),this.to.set(this.toPos.x,this.toPos.y,this.toPos.z),this.tweenRef&&TweenWrapper.StopTween(this.tweenRef),this.tweenRef=TweenWrapper.Tween(this.entity,this.entity.getLocalPosition(),this.to,this.duration,void 0,void 0,!0)},HandGuide.prototype.setDuration=function(t){this.duration=t},HandGuide.prototype.setFromPos=function(t,o,i){this.fromPos.set(t||this.fromPos.x,o||this.fromPos.y,i||this.fromPos.z)},HandGuide.prototype.setToPos=function(t,o,i){this.toPos.set(t||this.toPos.x,o||this.toPos.y,i||this.toPos.z)};var LookAtobject=pc.createScript("lookAtobject");LookAtobject.attributes.add("obj",{type:"entity",title:"LookAt Entity"}),LookAtobject.attributes.add("offset",{type:"vec3",title:"LookAt Offset"}),LookAtobject.attributes.add("lookAtX",{type:"boolean",title:"LookAt X",default:!0}),LookAtobject.attributes.add("lookAtY",{type:"boolean",title:"LookAt Y",default:!0}),LookAtobject.attributes.add("lookAtZ",{type:"boolean",title:"LookAt Z",default:!0}),LookAtobject.prototype.initialize=function(){},LookAtobject.prototype.postInitialize=function(){this.obj||(this.obj=this.app.root.findByTag("Main Camera")[0])},LookAtobject.prototype.update=function(t){if(!this.obj)return;let o=this.obj.getLocalPosition(),e=this.entity.getLocalPosition(),i=this.lookAtX?o.x+this.offset.x:e.x,a=this.lookAtY?o.y+this.offset.y:e.y,s=this.lookAtZ?o.z+this.offset.z:e.z;this.entity.lookAt(i,a,s)};var AnimateSprites=pc.createScript("animateSprites");AnimateSprites.attributes.add("animate",{type:"boolean"}),AnimateSprites.attributes.add("switchDelay",{type:"number"}),AnimateSprites.attributes.add("pairAnimations",{type:"number",default:0}),AnimateSprites.attributes.add("image",{type:"entity"}),AnimateSprites.attributes.add("sprites",{type:"asset",assetType:"sprite",array:!0}),AnimateSprites.prototype.initialize=function(){this.pauseAnimation=!1,this.currentSprite=0,this.currentPair=0},AnimateSprites.prototype.update=function(t){this.image&&this.animate&&!this.pauseAnimation&&(this.pauseAnimation=!0,CustomCoroutine.Instance.set(function(){this.showSprite(),this.pauseAnimation=!1,this.pairAnimations>0&&(this.currentPair++,this.pairAnimations<=this.currentPair&&(this.animate=!1,this.currentPair=0))}.bind(this),this.switchDelay))},AnimateSprites.prototype.showSprite=function(){try{this.animate&&(this.image.sprite.sprite=this.sprites[this.currentSprite].resource)}catch(t){}this.currentSprite++,this.currentSprite>=this.sprites.length&&(this.currentSprite=0)},AnimateSprites.prototype.play=function(t){this.animate=t},AnimateSprites.prototype.reset=function(){this.currentSprite=0,this.image.element.texture=this.sprites[this.currentSprite].resource};var KickVfxController=pc.createScript("kickVfxController");KickVfxController.attributes.add("scaleRef",{type:"entity",title:"Scale Reference"}),KickVfxController.attributes.add("ringVFX",{type:"entity",title:"Ring VFX"}),KickVfxController.attributes.add("magicLines",{type:"entity",title:"Magic Lines",array:!0}),KickVfxController.prototype.initialize=function(){this.entity.on("Play",this.play,this)},KickVfxController.prototype.play=function(t){t&&this.entity.setLocalPosition(t.x,t.y,t.z);let e=parseInt(pc.math.random(0,100))%5+4;Debug.log("magicLineCount: ",e);for(let t=0;t<e;t++)this.magicLines[t].enabled=!0,this.magicLines[t].fire("setScale",1/this.scaleRef.getLocalScale().x),this.magicLines[t].fire("setSpriteRotation",0,0,pc.math.random(0,359));this.ringVFX.enabled=!0,this.ringVFX.fire("setScale",1/this.scaleRef.getLocalScale().x)};var GemsManager=pc.createScript("gemsManager");GemsManager.prototype.initialize=function(){this.collectedGems=0,GemsManager=this,this.app.on(Events.OnCollectablePicked,this.OnCollectablePicked,this),this.app.on(Events.OnLevelCompleted,this.OnLevelCompleted,this)},GemsManager.prototype.OnLevelCompleted=function(){DataManager.Instance.setGems(this.collectedGems),this.app.fire("GemsMenu:UpdateGems",DataManager.Instance.gems,!1,!0),this.collectedGems=0},GemsManager.prototype.OnCollectablePicked=function(e){e.type===CollectableType.Gem&&this.collectedGems++},GemsManager.prototype.update=function(e){};var LooksGoodOnyouViewController=pc.createScript("looksGoodOnyouViewController");LooksGoodOnyouViewController.attributes.add("preview",{type:"entity"}),LooksGoodOnyouViewController.attributes.add("getButton",{type:"entity"}),LooksGoodOnyouViewController.attributes.add("loseButton",{type:"entity"}),LooksGoodOnyouViewController.instance=null,LooksGoodOnyouViewController.prototype.initialize=function(){LooksGoodOnyouViewController.instance=this,this.loadingAdScreen=this.app.root.findByName("Loading Ad Screen"),this.onEnable(),this.on("enable",this.onEnable,this),this.getButton.button.on("click",this.onGetButtonClicked,this),this.loseButton.button.on("click",this.onLoseButtonClicked,this)},LooksGoodOnyouViewController.prototype.onEnable=function(){var o=AttachmentsHandler.rewardData;o&&(this.preview.element.sprite=o.icon.resource)},LooksGoodOnyouViewController.prototype.onGetButtonClicked=function(){if(ConfigManager.instance.environmentType!==ConfigManager.EnvTypes.None){const o=LooksGoodOnyouViewController.instance.resumeGiveReward.bind(this),e=LooksGoodOnyouViewController.instance.pauseGame.bind(this),n=LooksGoodOnyouViewController.instance.resumeNoReward.bind(this),t=LooksGoodOnyouViewController.instance.adNotAvailable.bind(this);this.app.fire("showRewardedAD",o,e,n,t)}else this.onRewardSuccess()},LooksGoodOnyouViewController.prototype.onRewardSuccess=function(){this.app.fire(Events.OnKeepLooksGoodOffer),this.app.fire("changeMenuState",MenuManager.States.Win)},LooksGoodOnyouViewController.prototype.onRewardFailed=function(){this.app.fire("changeMenuState",MenuManager.States.Win)},LooksGoodOnyouViewController.prototype.onLoseButtonClicked=function(){this.app.fire(Events.OnLoseLooksGoodOffer),this.app.fire("changeMenuState",MenuManager.States.Win)},LooksGoodOnyouViewController.prototype.resumeGiveReward=function(){this.loadingAdScreen.enabled=!1,this.onRewardSuccess()},LooksGoodOnyouViewController.prototype.pauseGame=function(){this.loadingAdScreen.enabled=!0},LooksGoodOnyouViewController.prototype.resumeNoReward=function(){this.loadingAdScreen.enabled=!1,this.onRewardSuccess()},LooksGoodOnyouViewController.prototype.adNotAvailable=function(){this.loadingAdScreen.enabled=!1,this.app.fire("noAdPopup"),this.onRewardFailed()},LooksGoodOnyouViewController.prototype.update=function(o){};var PlayerPrefs=pc.createScript("playerPrefs");PlayerPrefs.prototype.initialize=function(){PlayerPrefs=this},PlayerPrefs.prototype.GetArray=function(t,e){let r=this.GetItem(t,e),o=[];return""!=r&&(o=r.split(",")),o},PlayerPrefs.prototype.AppendItem=function(t,e){let r=this.GetString(t,",");r+=","+e,this.SetItem(t,r)},PlayerPrefs.prototype.GetInt=function(t,e){return parseInt(this.GetItem(t,e))},PlayerPrefs.prototype.GetFloat=function(t,e){return parseFloat(this.GetItem(t,e))},PlayerPrefs.prototype.GetString=function(t,e){return this.GetItem(t,e)},PlayerPrefs.prototype.GetItem=function(t,e){var r=localStorage.getItem(t);return null==r&&(r=e,this.SetItem(t,r)),r},PlayerPrefs.prototype.SetItem=function(t,e){localStorage.setItem(t,e)};var ShopPaginationBtnEvent=pc.createScript("shopPaginationBtnEvent");ShopPaginationBtnEvent.attributes.add("btnEvent",{type:"string"}),ShopPaginationBtnEvent.attributes.add("index",{type:"number"}),ShopPaginationBtnEvent.prototype.initialize=function(){this.entity.button.on("click",this.onBtnClicked,this)},ShopPaginationBtnEvent.prototype.onBtnClicked=function(){this.app.fire(this.btnEvent,this.index)},ShopPaginationBtnEvent.prototype.update=function(t){};var SkinShopItemButton=pc.createScript("skinShopItemButton");SkinShopItemButton.attributes.add("adParent",{type:"entity"}),SkinShopItemButton.attributes.add("adCounterText",{type:"entity"}),SkinShopItemButton.attributes.add("selectedParent",{type:"entity"}),SkinShopItemButton.attributes.add("selectedColour",{type:"rgb"}),SkinShopItemButton.attributes.add("idleColour",{type:"rgb"}),SkinShopItemButton.attributes.add("bg",{type:"entity"}),SkinShopItemButton.attributes.add("pageIndex",{type:"number"}),SkinShopItemButton.attributes.add("skinType",{type:"number",enum:[{Hats:0},{Shoes:1},{Kicks:2}]}),SkinShopItemButton.attributes.add("data",{type:"json",schema:[{name:"type",type:"string",enum:[{Selected:"Selected"},{Available:"Available"},{Locked:"Locked"},{Unlocked:"Unlocked"}]},{name:"icon",type:"entity"}],array:!0}),SkinShopItemButton.instance=null,SkinShopItemButton.prototype.initialize=function(){},SkinShopItemButton.prototype.Setup=function(t){SkinShopItemButton.instance=this,this.entity.button.off("click",this.onClick,this),this.reward=t,this.loadingAdScreen=this.app.root.findByName("Loading Ad Screen");var e=PlayerPrefs.GetString("SelectedHat",""),n=PlayerPrefs.GetString("SelectedShoes",""),i=PlayerPrefs.GetString("SelectedKick",DataManager.Instance.defaultKick);t.GetStatus()===SkinStatus.Selected&&t.SetStatus(SkinStatus.Unlocked),(t.entity.name===e||t.entity.name===n||t.entity.name===i)&&(t.SetCost(0),t.SetStatus(SkinStatus.Selected)),this.adParent.enabled=t.GetCost()>0,this.adCounterText.element.text=t.GetCost()+"/"+t.GetMaxCost(),this.entity.button.on("click",this.onClick,this),this.updatePreview(t.GetStatus())},SkinShopItemButton.prototype.updatePreview=function(t){var e=t===SkinStatus.Selected;this.bg.element.color=e?this.selectedColour:this.idleColour,this.selectedParent.enabled=t===SkinStatus.Selected;for(let e=0;e<this.data.length;e++){var n=this.data[e];if(n.icon.enabled=t===n.type,t===n.type){switch(this.skinType){case SkinType.Hats:case SkinType.Shoes:break;case SkinType.Kicks:n.icon.element.sprite=this.reward.data.icon.resource}n.type!==SkinStatus.Locked&&(n.icon.element.sprite=this.reward.data.icon.resource)}}},SkinShopItemButton.prototype.onClick=function(){var t=this.reward.GetStatus(),e=this.reward.GetCost();switch(t){case SkinStatus.Selected:if(Debug.log(this.reward.entity.name+" Case SkinStatus.Selected"),this.reward.entity.name===DataManager.Instance.defaultKick)return;this.app.fire(Events.OnSkinUnselected,{key:this.reward.entity.name,skinType:this.skinType});break;case SkinStatus.Available:if(e>0)if(ConfigManager.instance.environmentType!==ConfigManager.EnvTypes.None){this.loadingAdScreen.enabled=!0;const t=SkinShopItemButton.instance.resumeGiveReward.bind(this),e=SkinShopItemButton.instance.pauseGame.bind(this),n=SkinShopItemButton.instance.resumeNoReward.bind(this),i=SkinShopItemButton.instance.adNotAvailable.bind(this);this.app.fire("showRewardedAD",t,e,n,i)}else this.onRewardSuccess();break;case SkinStatus.Locked:break;case SkinStatus.Unlocked:switch(this.app.fire(Events.OnSkinSelected,{key:this.reward.entity.name,skinType:this.skinType}),this.skinType){case SkinType.Hats:PlayerPrefs.SetItem("SelectedHat",this.reward.entity.name);break;case SkinType.Shoes:PlayerPrefs.SetItem("SelectedShoes",this.reward.entity.name);break;case SkinType.Kicks:PlayerPrefs.SetItem("SelectedKick",this.reward.entity.name)}}},SkinShopItemButton.prototype.onRewardSuccess=function(){var t=this.reward.GetCost();t-1<=0?(t=0,this.reward.SetCost(t),this.reward.SetStatus(SkinStatus.Unlocked),this.adParent.enabled=t>0,this.adCounterText.element.text=t+"/"+this.reward.GetMaxCost(),this.updatePreview(SkinStatus.Unlocked)):(t-=1,this.reward.SetCost(t),this.adParent.enabled=t>0,this.adCounterText.element.text=t+"/"+this.reward.GetMaxCost()),Debug.log("SkinShopItemButton.onRewardSuccess()")},SkinShopItemButton.prototype.onRewardFailed=function(){console.error("SkinShopItemButton.onRewardFailed()")},SkinShopItemButton.prototype.resumeGiveReward=function(){this.loadingAdScreen.enabled=!1,this.onRewardSuccess()},SkinShopItemButton.prototype.pauseGame=function(){this.loadingAdScreen.enabled=!0},SkinShopItemButton.prototype.resumeNoReward=function(){this.loadingAdScreen.enabled=!1,this.app.fire("adSkippedPopup"),this.onRewardFailed()},SkinShopItemButton.prototype.adNotAvailable=function(){this.loadingAdScreen.enabled=!1,this.app.fire("noAdPopup"),this.onRewardFailed()},SkinShopItemButton.prototype.update=function(t){};var SkinShopMenuEventListner=pc.createScript("skinShopMenuEventListner");SkinShopMenuEventListner.attributes.add("shopBtns",{type:"json",title:"Shop Buttons",schema:[{name:"closeShopBtn",type:"entity"},{name:"hatsTabBtn",type:"entity"},{name:"shoesTabBtn",type:"entity"},{name:"kicksTabBtn",type:"entity"},{name:"earnGemsBtn",type:"entity"},{name:"unlockRandomBtn",type:"entity"},{name:"unlockRandomPriceText",type:"entity"}]}),SkinShopMenuEventListner.attributes.add("shopTabs",{type:"json",title:"Shop Tabs",schema:[{name:"hatsTab",type:"entity"},{name:"shoesTab",type:"entity"},{name:"kickTab",type:"entity"}]}),SkinShopMenuEventListner.attributes.add("hatPages",{type:"json",title:"hat pages",schema:[{name:"hatsMainPage",type:"entity"},{name:"hatsPages",type:"entity",array:!0},{name:"hatsPageIndicator",type:"entity",array:!0}]}),SkinShopMenuEventListner.attributes.add("shoesPages",{type:"json",title:"shoes pages",schema:[{name:"shoesMainPage",type:"entity"},{name:"shoesPages",type:"entity",array:!0},{name:"shoesPageIndicator",type:"entity",array:!0}]}),SkinShopMenuEventListner.attributes.add("kickPages",{type:"json",title:"hat pages",schema:[{name:"kickMainPage",type:"entity"},{name:"kickPages",type:"entity",array:!0},{name:"kickPageIndicator",type:"entity",array:!0}]}),SkinShopMenuEventListner.attributes.add("threeDView",{type:"entity"}),SkinShopMenuEventListner.instance=null,SkinShopMenuEventListner.prototype.initialize=function(){SkinShopMenuEventListner.instance=this,this.loadingAdScreen=this.app.root.findByName("Loading Ad Screen"),this.initEvents(),this.TAB_HIGHLIGHT_COLOR=new pc.Color(121/255,85/255,206/255,1),this.TAB_UNHIGHLIGHT_COLOR=new pc.Color(96/255,68/255,164/255,1),this.on("enable",this.onEnable,this),this.on("disable",this.onDisable,this),this.onEnable(),this.app.on(Events.OnSkinSelected,this.OnSkinSelected,this),this.app.on(Events.OnSkinUnselected,this.OnSkinUnselected,this),this.hatsPageIndex=0,this.kicksPageIndex=0},SkinShopMenuEventListner.prototype.postInitialize=function(){this.hatsPageIndex=PlayerPrefs.GetInt("hatsPageIndex",0),this.kicksPageIndex=PlayerPrefs.GetInt("kicksPageIndex",2),Debug.log("hatsIndex: ",this.hatsPageIndex," kicksIndex: ",this.kicksPageIndex)},SkinShopMenuEventListner.prototype.OnSkinUnselected=function(e){var t=[];switch(e.skinType){case SkinType.Hats:t=this.hatPages.hatsMainPage.script.skinShopPage.data.buttons;break;case SkinType.Shoes:t=this.shoesPages.shoesMainPage.script.skinShopPage.data.buttons;break;case SkinType.Kicks:t=this.kickPages.kickMainPage.script.skinShopPage.data.buttons}this.updateUnselectButtonPreviews(t,e)},SkinShopMenuEventListner.prototype.OnSkinSelected=function(e){var t=[];switch(e.skinType){case SkinType.Hats:t=this.hatPages.hatsMainPage.script.skinShopPage.data.buttons;break;case SkinType.Shoes:t=this.shoesPages.shoesMainPage.script.skinShopPage.data.buttons;break;case SkinType.Kicks:t=this.kickPages.kickMainPage.script.skinShopPage.data.buttons}this.updateButtonPreviews(t,e)},SkinShopMenuEventListner.prototype.updateButtonPreviews=function(e,t){var n=t.key;t.skinType;Debug.log("Data: ",t);for(let t=0;t<e.length;t++){var i=e[t].script.skinShopItemButton,s=i.reward;s&&(s.entity.name===n?(i.skinType===SkinType.Hats?PlayerPrefs.SetItem("hatsPageIndex",this.hatsPageIndex):i.skinType===SkinType.Kicks&&PlayerPrefs.SetItem("kicksPageIndex",this.kicksPageIndex),s.SetStatus(SkinStatus.Selected)):s.GetStatus()===SkinStatus.Selected&&s.SetStatus(SkinStatus.Unlocked),i.updatePreview(s.GetStatus()))}},SkinShopMenuEventListner.prototype.updateUnselectButtonPreviews=function(e,t){var n=t.key;t.skinType;for(let t=0;t<e.length;t++){var i=e[t].script.skinShopItemButton,s=i.reward;s&&(s.entity.name===n&&s.SetStatus(SkinStatus.Unlocked),i.updatePreview(s.GetStatus()))}},SkinShopMenuEventListner.prototype.updatePrice=function(){let e=ChestRoomManager.GetRandomSkinReward(SkinType.Hats),t=ChestRoomManager.GetSkinPrice(SkinType.Hats);Debug.log("SkinPrice: ",t),this.shopBtns.unlockRandomPriceText.element.text=t,this.shopBtns.unlockRandomBtn.enabled=null!=e},SkinShopMenuEventListner.prototype.onDisable=function(){this.threeDView.enabled=!1},SkinShopMenuEventListner.prototype.onEnable=function(){this.threeDView.enabled=!0,this.updatePrice();let e=PlayerPrefs.GetArray("rewards","");Debug.log("Rewards: ",e);let t=[];var n=ChestRoomManager.GetItemsOfType(SkinType.Hats);for(let i=0;i<e.length;i++)for(let s=0;s<n.length;s++){let a=n[s];a.entity.name===e[i]&&t.push(a)}for(let e=0;e<n.length;e++)t.includes(n[e])||t.push(n[e]);t.length>0&&(n=t);var i=ChestRoomManager.GetItemsOfType(SkinType.Shoes),s=ChestRoomManager.GetItemsOfType(SkinType.Kicks);this.hatPages.hatsMainPage.script.skinShopPage.Setup(n),this.shoesPages.shoesMainPage.script.skinShopPage.Setup(i),this.kickPages.kickMainPage.script.skinShopPage.Setup(s);let a=this;setTimeout((function(){a.app.fire("hatPageChange",a.hatsPageIndex),a.app.fire("kickPageChange",a.kicksPageIndex)}),100)},SkinShopMenuEventListner.prototype.initEvents=function(){this.shopBtns.earnGemsBtn.button.on("click",this.onEarnGemsBtnClicked,this),this.shopBtns.unlockRandomBtn.button.on("click",this.onUnlockRandomBtnClicked,this),this.shopBtns.closeShopBtn.button.on("click",this.onCloseShopBtnClicked,this),this.shopBtns.hatsTabBtn.button.on("click",this.onHatsTabBtnClicked,this),this.shopBtns.shoesTabBtn.button.on("click",this.onShoesTabBtnClicked,this),this.shopBtns.kicksTabBtn.button.on("click",this.onKicksTabBtnClicked,this),this.app.on("hatPageChange",this.onHatPageChanged,this),this.app.on("kickPageChange",this.onKickPageChanged,this)},SkinShopMenuEventListner.prototype.onEarnGemsBtnClicked=function(){if(ConfigManager.instance.environmentType!==ConfigManager.EnvTypes.None){this.loadingAdScreen.enabled=!0;const e=SkinShopMenuEventListner.instance.resumeGiveReward.bind(this),t=SkinShopMenuEventListner.instance.pauseGame.bind(this),n=SkinShopMenuEventListner.instance.resumeNoReward.bind(this),i=SkinShopMenuEventListner.instance.adNotAvailable.bind(this);this.app.fire("showRewardedAD",e,t,n,i)}else this.onEarnRewardSuccess()},SkinShopMenuEventListner.prototype.onEarnRewardSuccess=function(){DataManager.Instance.setGems(2048),this.app.fire("GemsMenu:UpdateGems",DataManager.Instance.gems,!1,!0)},SkinShopMenuEventListner.prototype.onEarnRewardFail=function(){console.error("SkinShopMenuEventListner.onEarnRewardFail")},SkinShopMenuEventListner.prototype.onUnlockRandomBtnClicked=function(){let e=ChestRoomManager.GetSkinPrice(SkinType.Hats);if(DataManager.Instance.gems-e>=0){let t=ChestRoomManager.GetRandomSkinReward(SkinType.Hats);t&&(DataManager.Instance.setGems(-e),this.app.fire("GemsMenu:UpdateGems",DataManager.Instance.gems,!0),t.SetStatus(SkinStatus.Unlocked),this.app.fire(Events.OnSkinSelected,{key:t.entity.name,skinType:SkinType.Hats}),PlayerPrefs.SetItem("SelectedHat",t.entity.name),Debug.log("Reward: ",t),this.updatePrice())}else Debug.error("Not Enough Gems!!"),this.app.fire("GemsMenu:UpdateGems",DataManager.Instance.gems,!0)},SkinShopMenuEventListner.prototype.onCloseShopBtnClicked=function(){this.app.fire("changeMenuState",MenuManager.States.Home)},SkinShopMenuEventListner.prototype.onHatsTabBtnClicked=function(){this.highLightTab(this.shopTabs.hatsTab),this.openPage(this.hatPages.hatsMainPage)},SkinShopMenuEventListner.prototype.onShoesTabBtnClicked=function(){this.highLightTab(this.shopTabs.shoesTab),this.openPage(this.shoesPages.shoesMainPage)},SkinShopMenuEventListner.prototype.onKicksTabBtnClicked=function(){this.highLightTab(this.shopTabs.kickTab),this.openPage(this.kickPages.kickMainPage)},SkinShopMenuEventListner.prototype.highLightTab=function(e){this.resetTabs(),e.element.color=this.TAB_HIGHLIGHT_COLOR},SkinShopMenuEventListner.prototype.openPage=function(e){this.closeAllPages(),e.enabled=!0},SkinShopMenuEventListner.prototype.resetTabs=function(){this.shopTabs.hatsTab.element.color=this.TAB_UNHIGHLIGHT_COLOR,this.shopTabs.shoesTab.element.color=this.TAB_UNHIGHLIGHT_COLOR,this.shopTabs.kickTab.element.color=this.TAB_UNHIGHLIGHT_COLOR},SkinShopMenuEventListner.prototype.closeAllPages=function(){this.hatPages.hatsMainPage.enabled=!1,this.shoesPages.shoesMainPage.enabled=!1,this.kickPages.kickMainPage.enabled=!1},SkinShopMenuEventListner.prototype.onHatPageChanged=function(e){this.hatsPageIndex=e},SkinShopMenuEventListner.prototype.resetHatPaginationSelection=function(){this.hatsPageIndex=0},SkinShopMenuEventListner.prototype.onKickPageChanged=function(e){this.kicksPageIndex=e},SkinShopMenuEventListner.prototype.resetKickPaginationSelection=function(){this.kicksPageIndex=0},SkinShopMenuEventListner.prototype.resumeGiveReward=function(){this.loadingAdScreen.enabled=!1,this.onEarnRewardSuccess()},SkinShopMenuEventListner.prototype.pauseGame=function(){this.loadingAdScreen.enabled=!0},SkinShopMenuEventListner.prototype.resumeNoReward=function(){this.loadingAdScreen.enabled=!1,this.app.fire("adSkippedPopup"),this.onEarnRewardFail()},SkinShopMenuEventListner.prototype.adNotAvailable=function(){this.loadingAdScreen.enabled=!1,this.app.fire("noAdPopup"),this.onEarnRewardFail()},SkinShopMenuEventListner.prototype.update=function(e){};var SkinShopPage=pc.createScript("skinShopPage");SkinShopPage.attributes.add("data",{type:"json",schema:[{name:"buttons",type:"entity",array:!0},{name:"type",type:"number",enum:[{Hats:0},{Shoes:1},{Kicks:2}]},{name:"purchaseType",type:"number",enum:[{Gems:0},{Rewarded:1}]}]}),SkinShopPage.prototype.Setup=function(t){this.collection=t;for(let e=0;e<this.data.buttons.length;e++){this.data.buttons[e].script.skinShopItemButton.Setup(t[e])}},SkinShopPage.prototype.initialize=function(){},SkinShopPage.prototype.update=function(t){};var SkinUnlockedViewController=pc.createScript("skinUnlockedViewController");SkinUnlockedViewController.attributes.add("preview",{type:"entity"}),SkinUnlockedViewController.attributes.add("getItButton",{type:"entity"}),SkinUnlockedViewController.attributes.add("getItButtonAds",{type:"entity"}),SkinUnlockedViewController.attributes.add("loseItButton",{type:"entity"}),SkinUnlockedViewController.attributes.add("loadingScreen",{type:"entity"}),SkinUnlockedViewController.attributes.add("winScreen",{type:"entity"}),SkinUnlockedViewController.instance=null,SkinUnlockedViewController.prototype.initialize=function(){SkinUnlockedViewController.instance=this,this.loadingAdScreen=this.app.root.findByName("Loading Ad Screen"),this.on("enable",this.onEnable,this),this.onEnable(),this.getItButton.button.on("click",this.OnGetItClicked,this),this.loseItButton.button.on("click",this.OnLoseItClicked,this),this.getItButtonAds.button.on("click",this.OnGetItClicked,this)},SkinUnlockedViewController.prototype.OnLoseItClicked=function(){this.onRewardSuccess()},SkinUnlockedViewController.prototype.OnGetItClicked=function(){var e=this.winScreen.script.winScreenEventListner.pendulumData;if(e){if(PlayerPrefs.AppendItem("rewards",e.value.entity.name),this.app.fire(Events.OnSkinSelected,{key:e.value.entity.name,skinType:SkinType.Hats}),this.app.fire(Events.OnKeepLooksGoodOffer,{key:e.value.entity.name,skinType:SkinType.Hats}),this.winScreen.script.winScreenEventListner.pendulumData=null,ChestRoomManager.currentRewardProgress>=100){let e=this;return this.getItButton.enabled=!1,this.loseItButton.enabled=!1,this.getItButtonAds.enabled=!1,setTimeout((function(){e.handleButtons(!0)}),1e3),void(this.preview.element.sprite=ChestRoomManager.GetCurrentProgressSkin())}}else ChestRoomManager.currentRewardProgress>=100&&CustomCoroutine.Instance.set(async function(){await AdsManager.instance.showAd(this.onRewardSuccess.bind(this),this.app.ads.placement.GetItSkinUnlock,this.app.ads.type.Interstitial,!1)||this.onRewardFailed()}.bind(this),.1);ChestRoomManager.keys>=3?this.app.fire(Events.OnChangeMenuState,MenuManager.States.ChestRoom):this.loadHome()},SkinUnlockedViewController.prototype.onRewardSuccess=function(){ChestRoomManager.UpdateRewardProgress(),ChestRoomManager.keys>=3?this.app.fire(Events.OnChangeMenuState,MenuManager.States.ChestRoom):this.loadHome()},SkinUnlockedViewController.prototype.onRewardFailed=function(){ChestRoomManager.keys>=3?this.app.fire(Events.OnChangeMenuState,MenuManager.States.ChestRoom):this.loadHome()},SkinUnlockedViewController.prototype.loadHome=function(){this.loadingScreen.enabled=!0,this.app.fire(Events.OnLevelCompleted),this.app.fire(Events.OnChangeMenuState,MenuManager.States.Home),setTimeout((()=>{this.loadingScreen.enabled=!1}),1500)},SkinUnlockedViewController.prototype.onEnable=function(){var e=this.winScreen.script.winScreenEventListner.pendulumData;this.handleButtons(!1),e?this.preview.element.sprite=e.sprite:ChestRoomManager.currentRewardProgress>=100?(this.handleButtons(!0),this.preview.element.sprite=ChestRoomManager.GetCurrentProgressSkin()):this.preview.element.sprite=ChestRoomManager.GetCurrentBestPrizeSkin()},SkinUnlockedViewController.prototype.handleButtons=function(e){if(this.getItButtonAds.enabled=e,this.loseItButton.enabled=!1,this.getItButton.enabled=!e,!0===e){let e=this;setTimeout((function(){e.loseItButton.enabled=!0}),3)}},SkinUnlockedViewController.prototype.update=function(e){};var EmojiRotation=pc.createScript("emojiRotation");EmojiRotation.prototype.initialize=function(){this.entity.tween(this.entity.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,-20),1,pc.Linear).loop(!0).yoyo(!0).start()},EmojiRotation.prototype.update=function(t){};var FireworksController=pc.createScript("fireworksController");FireworksController.attributes.add("particles",{type:"entity",title:"Particles",array:!0}),FireworksController.prototype.initialize=function(){this.entity.on("Play",this.play,this),this.entity.on("Stop",this.stop,this)},FireworksController.prototype.play=function(){for(let t=0;t<this.particles.length;t++)this.particles[t].particlesystem.reset(),this.particles[t].enabled=!0},FireworksController.prototype.stop=function(){for(let t=0;t<this.particles.length;t++)this.particles[t].enabled=!1};var FireworksVfxHandler=pc.createScript("fireworksVfxHandler");FireworksVfxHandler.attributes.add("fireworks",{type:"entity",title:"Fireworks",array:!0}),FireworksVfxHandler.prototype.initialize=function(){this.app.on("FireworksVfx:Play",this.play,this),this.app.on("FireworksVfx:Stop",this.stop,this)},FireworksVfxHandler.prototype.play=function(r,t){this.fireworks[r].fire("Play"),t&&CustomCoroutine.Instance.set((()=>{this.stop(r)}),t)},FireworksVfxHandler.prototype.stop=function(r){this.fireworks[r].fire("Stop")};var BalanceView=pc.createScript("balanceView");BalanceView.prototype.initialize=function(){},BalanceView.prototype.update=function(e){};var Uianimator=pc.createScript("uianimator");Uianimator.attributes.add("opacity",{title:"Opacity Settings",type:"json",schema:[{name:"includeChildren",title:"Apply on Children",type:"boolean",default:!1},{name:"from",title:"From",min:0,max:1,type:"number",default:0},{name:"to",title:"To",min:0,max:1,type:"number",default:1},{name:"duration",title:"Duration",type:"number",default:.5},{name:"delay",title:"Delay",type:"number",default:0},{name:"obj",title:"Entity",type:"entity"}],array:!0}),Uianimator.attributes.add("scale",{title:"Scale Settings",type:"json",schema:[{name:"animType",title:"Animation Type",type:"string",default:"Linear"},{name:"from",title:"From",type:"vec3",default:[0,0,0]},{name:"to",title:"To",type:"vec3",default:[1,1,1]},{name:"duration",title:"Duration",type:"number",default:.5},{name:"delay",title:"Delay",type:"number",default:0},{name:"obj",title:"Entity",type:"entity"}],array:!0}),Uianimator.attributes.add("pos",{title:"Position Settings",type:"json",schema:[{name:"animType",title:"Animation Type",type:"string",default:"Linear"},{name:"from",title:"From",type:"vec3",default:[0,0,0]},{name:"to",title:"To",type:"vec3",default:[1,1,1]},{name:"duration",title:"Duration",type:"number",default:.5},{name:"delay",title:"Delay",type:"number",default:0},{name:"fromObj",title:"From Entity",type:"entity"},{name:"toObj",title:"To Entity",type:"entity"},{name:"obj",title:"Entity",type:"entity"}],array:!0}),Uianimator.prototype.initialize=function(){this.on("enable",this.onEnable,this),this.entity.on("disable",this.onDisable,this),this.duration=0,this.scaleCache=[],this.posCache=[]},Uianimator.prototype.postInitialize=function(){this.onEnable()},Uianimator.prototype.onEnable=function(){this.animateOpacity(!0),this.animateScale(!0),this.animatePosition(!0)},Uianimator.prototype.onDisable=function(t){this.animateOpacity(!1),this.animateScale(!1),this.animatePosition(!1),CustomCoroutine.Instance.set((()=>{t&&t(this.duration),this.entity.enabled=!1}),this.duration)},Uianimator.prototype.animateOpacity=function(t){for(let e=0;e<this.opacity.length;e++){let i=t?this.opacity[e].from:this.opacity[e].to,a=t?this.opacity[e].to:this.opacity[e].from;CustomCoroutine.Instance.set((()=>{this.opacity[e].includeChildren&&this.applyOpacityOnChildren(this.opacity[e],i,a),this.opacity[e].obj.element&&TweenWrapper.TweenOpacity(this.opacity[e].obj.element,i,a,this.opacity[e].duration)}),this.opacity[e].delay),this.updateLargestDuration(this.opacity[e].duration+this.opacity[e].delay)}},Uianimator.prototype.applyOpacityOnChildren=function(t,e,i){let a=t.obj,o=[];for(o.push(a);o.length>0;){let a=o.pop();for(let n=0;n<a.children.length;n++)a.children[n]&&o.push(a.children[n]),a&&a.element&&TweenWrapper.TweenOpacity(a.element,e,i,t.duration)}},Uianimator.prototype.animateScale=function(t){for(let e=0;e<this.scale.length;e++){this.updateScaleCache(e);let i=t?this.scale[e].from:this.scale[e].to,a=t?this.scale[e].to:this.scale[e].from;this.scale[e].obj.setLocalScale(i.x,i.y,i.z),this.scaleCache[e].set(a.x,a.y,a.z),CustomCoroutine.Instance.set((()=>{TweenWrapper.Tween(this.scale[e].obj,this.scale[e].obj.getLocalScale(),this.scaleCache[e],this.scale[e].duration,void 0,pc[this.scale[e].animType])}),this.scale[e].delay),this.updateLargestDuration(this.scale[e].duration+this.scale[e].delay)}},Uianimator.prototype.animatePosition=function(t){for(let e=0;e<this.pos.length;e++){this.updatePosCache(e);let i=this.pos[e].fromObj?this.pos[e].fromObj.getLocalPosition():void 0,a=this.pos[e].toObj?this.pos[e].toObj.getLocalPosition():void 0,o=t?i||this.pos[e].from:a||this.pos[e].to,n=t?a||this.pos[e].to:i||this.pos[e].from;this.pos[e].obj.setLocalPosition(o.x,o.y,o.z),this.posCache[e].set(n.x,n.y,n.z),CustomCoroutine.Instance.set((()=>{TweenWrapper.Tween(this.pos[e].obj,this.pos[e].obj.getLocalPosition(),this.posCache[e],this.pos[e].duration,void 0,pc[this.pos[e].animType])}),this.pos[e].delay),this.updateLargestDuration(this.pos[e].duration+this.pos[e].delay)}},Uianimator.prototype.updateScaleCache=function(t){t>=this.scaleCache.length&&this.scaleCache.push(new pc.Vec3)},Uianimator.prototype.updatePosCache=function(t){t>=this.posCache.length&&this.posCache.push(new pc.Vec3)},Uianimator.prototype.updateLargestDuration=function(t){this.duration<t&&(this.duration=t)};var FollowWorldTarget=pc.createScript("followWorldTarget");FollowWorldTarget.attributes.add("target",{type:"entity"}),FollowWorldTarget.attributes.add("camera",{type:"entity"}),FollowWorldTarget.prototype.initialize=function(){},FollowWorldTarget.prototype.postUpdate=function(t){var e=this.target.getPosition(),i=new pc.Vec3;if(this.camera.camera.worldToScreen(e,i),i.z>0){this.entity.element.enabled=!0;var a=this.app.graphicsDevice.maxPixelRatio;i.x*=a,i.y*=a;var o=this.app.graphicsDevice;this.entity.setPosition(i.x/o.width*2-1,2*(1-i.y/o.height)-1,0)}else this.entity.element.enabled=!1};var AnimViewUpdate=pc.createScript("animViewUpdate");AnimViewUpdate.attributes.add("animEntity",{type:"entity"}),AnimViewUpdate.prototype.postInitialize=function(){var e=PlayerPrefs.GetItem("SelectedKick",DataManager.Instance.defaultKick);this.OnSkinSelected({key:e,skinType:SkinType.Kicks}),this.app.on(Events.OnSkinSelected,this.OnSkinSelected,this)},AnimViewUpdate.prototype.OnSkinSelected=function(e){e.skinType===SkinType.Kicks&&this.animEntity.anim.baseLayer.play(e.key)},AnimViewUpdate.prototype.update=function(e){};var GemsMenuEventListener=pc.createScript("gemsMenuEventListener");GemsMenuEventListener.attributes.add("counter",{type:"entity",title:"Counter"}),GemsMenuEventListener.attributes.add("text",{type:"entity",title:"Text"}),GemsMenuEventListener.attributes.add("icon",{type:"entity",title:"Icon"}),GemsMenuEventListener.attributes.add("gemsContainer",{type:"entity",title:"Gems Container"}),GemsMenuEventListener.attributes.add("test",{title:"Test Settings",type:"json",schema:[{name:"gemsToGive",type:"number",title:"Gems To Give"},{name:"btn",type:"entity",title:"Test Button"}]}),GemsMenuEventListener.attributes.add("gems",{title:"Gems",type:"json",schema:[{name:"gem",type:"entity",title:"Gem"}],array:!0}),GemsMenuEventListener.attributes.add("animSettings",{title:"Animation Settings",type:"json",schema:[{name:"minSpreadDistance",type:"number",title:"Min Spread Distance",default:-125},{name:"maxSpreadDistance",type:"number",title:"Max Spread Distance",default:125},{name:"spreadTime",type:"number",title:"Spread Time",default:1},{name:"spreadRotationSpeed",type:"number",title:"Spread Rotation Speed",default:.2},{name:"flyingTime",type:"number",title:"Flying Time",default:.5},{name:"flyingStep",type:"number",title:"Flying Step",default:.1},{name:"purchaseTweenTime",type:"number",title:"Purchase Tween Time",default:1},{name:"incrementSteps",type:"number",title:"Increment Steps",default:10},{name:"incrementStepTime",type:"number",title:"Increment Step Time",default:.15}]}),GemsMenuEventListener.prototype.initialize=function(){this.currentBalance=0,this.app.on("GemsMenu:UpdateGems",this.setBalance,this),this.app.on("GemsMenu:EnableCounterView",this.enableCounterView,this),this.balanceRoutines=[],this.test.btn.button.on("click",(()=>{DataManager.Instance.setGems(this.test.gemsToGive),this.setBalance(DataManager.Instance.gems,!1,!0)})),this.tweens={circleSpread:void 0,moveToGemIcon:void 0}},GemsMenuEventListener.prototype.postInitialize=function(){this.vec3Cache=[]},GemsMenuEventListener.prototype.update=function(e){this.rotateGemsContainer},GemsMenuEventListener.prototype.enableCounterView=function(e){e?this.counter.enabled=!0:this.counter.fire("disable")},GemsMenuEventListener.prototype.setBalance=function(e,t,n){let i=parseInt(this.text.element.text),s=e,a=s-i,m=Math.abs(a)>this.animSettings.incrementSteps?this.animSettings.incrementSteps:Math.abs(a);i!=s&&(n?this.animateGems(a,i,s):t?this.lerpBalance(m,i,s,a):this.text.element.text=e.toString())},GemsMenuEventListener.prototype.lerpBalance=function(e,t,n,i){for(let e=0;e<this.balanceRoutines.length;e++)CustomCoroutine.Instance.clear(this.balanceRoutines[e]);if(this.balanceRoutines=[],e>0){let s=i/e;for(let i=0;i<e;i++){let a=CustomCoroutine.Instance.set((()=>{t+=parseInt(s),this.setGemsText(i===e-1?n:t,!0)}),i*this.animSettings.incrementStepTime);this.balanceRoutines.push(a)}}},GemsMenuEventListener.prototype.animateGems=function(e,t,n){let i=e<this.gems.length?e:this.gems.length;this.animteGemsSpreading(i),CustomCoroutine.Instance.set((()=>{this.flyGemsToCounter(i,t,n,e)}),this.animSettings.spreadTime)},GemsMenuEventListener.prototype.animteGemsSpreading=function(e){for(let t=0;t<e;t++){this.gems[t].gem.enabled=!0,this.gems[t].gem.setLocalPosition(0,0,0);let e=pc.math.random(this.animSettings.minSpreadDistance,this.animSettings.maxSpreadDistance),n=pc.math.random(this.animSettings.minSpreadDistance,this.animSettings.maxSpreadDistance);this.vec3Cache.length<=t?this.vec3Cache.push(new pc.Vec3(e,n,0)):this.vec3Cache[t].set(e,n,0),TweenWrapper.Tween(this.gems[t].gem,this.gems[t].gem.getLocalPosition(),this.vec3Cache[t],this.animSettings.spreadTime,void 0,pc.BackOut)}},GemsMenuEventListener.prototype.flyGemsToCounter=function(e,t,n,i){this.rotateGemsContainer=!1;let s=i/e;for(let i=0;i<e;i++)CustomCoroutine.Instance.set((()=>{t+=parseInt(s),this.vec3Cache[i].set(0,0,0),this.vec3Cache[i].add2(this.icon.getLocalPosition(),this.counter.getLocalPosition()),TweenWrapper.Tween(this.gems[i].gem,this.gems[i].gem.getLocalPosition(),this.vec3Cache[i],this.animSettings.incrementStepTime,(()=>{this.gems[i].gem.enabled=!1,this.setGemsText(i===e-1?n:t,!0)}))}),i*this.animSettings.incrementStepTime/1.5)},GemsMenuEventListener.prototype.setGemsText=function(e,t){t&&this.playSound("GemCounter"),this.text.element.text=e},GemsMenuEventListener.prototype.playSound=function(e){this.app.fire("sound:playSound",e)};var GameDistribution=pc.createScript("gameDistribution");GameDistribution.instance=null;var resumeCallback=null,pauseCallback=null,resumeGiveRewardCallback=null,resumeNoRewardCallback=null,noADAvailableCallack=null;GameDistribution.prototype.initialize=function(){var e,a,i,d,n;GameDistribution.instance=this,this.loadingAdScreen=this.app.root.findByName("Loading Ad Screen"),window.GD_OPTIONS={gameId:"721d23c521c4447a8f8cedc31377f271",onEvent:function(e){switch(e.name){case"SDK_GAME_START":Debug.log("SDK_GAME_START"),GameDistribution.instance.isRewardedAdWatched?(GameDistribution.instance.isRewardedAdWatched=!1,Debug.log("giveReward"),Debug.log(resumeGiveRewardCallback),null!==resumeGiveRewardCallback&&resumeGiveRewardCallback(),GameDistribution.instance.app.fire("giveReward:resume")):(null!==resumeCallback&&resumeCallback(),GameDistribution.instance.app.fire("game:resume"));break;case"SDK_GAME_PAUSE":Debug.log("SDK_GAME_PAUSE"),GameDistribution.instance.app.fire("game:pause"),pauseCallback();break;case"SDK_GDPR_TRACKING":Debug.log("SDK_GDPR_TRACKING");break;case"SDK_GDPR_TARGETING":Debug.log("SDK_GDPR_TARGETING");break;case"SDK_REWARDED_WATCH_COMPLETE":GameDistribution.instance.isRewardedAdWatched=!0,Debug.log("SDK_REWARDED_WATCH_COMPLETE");break;case"AD_SDK_CANCELED":Debug.log("AD_SDK_CANCELED");break;case"AD_SDK_MANAGER_READY":Debug.log("AD_SDK_MANAGER_READY");break;case"AD_ERROR":Debug.log("AD_ERROR");break;case"AD_BREAK_READY":Debug.log("AD_BREAK_READY");break;case"COMPLETE":Debug.log("COMPLETE");break;case"CONTENT_PAUSE_REQUESTED":Debug.log("CONTENT_PAUSE_REQUESTED");break;case"CONTENT_RESUME_REQUESTED":Debug.log("CONTENT_RESUME_REQUESTED")}}},e=document,a="script",i="gamedistribution-jssdk",n=e.getElementsByTagName(a)[0],e.getElementById(i)||((d=e.createElement(a)).id=i,d.src="/main.min.js",n.parentNode.insertBefore(d,n)),GameDistribution.instance.isRewardedAdWatched=!1,this.app.on("showSimpleAD",this.onShowSimpleAD,this),this.app.on("showRewardedAD",this.onShowRewardedAD,this)},GameDistribution.prototype.onShowSimpleAD=function(e,a){resumeCallback=e,pauseCallback=a,"undefined"!=typeof gdsdk&&"undefined"!==gdsdk.showAd&&(Debug.log("Showing"),gdsdk.showAd())},GameDistribution.prototype.onShowRewardedAD=function(e,a,i,d){pauseCallback=a,resumeCallback=i,resumeGiveRewardCallback=e,noADAvailableCallack=d,Debug.log("onShowRewardedAD");var n=this;"undefined"!==gdsdk&&"undefined"!==gdsdk.preloadAd&&gdsdk.preloadAd("rewarded").then((e=>{Debug.log("Rewarded Ad is available"),"undefined"!==gdsdk&&"undefined"!==gdsdk.showAd&&gdsdk.showAd("rewarded").then((e=>{Debug.log("AD Comp")})).catch((e=>{GameDistribution.instance.isRewardedAdWatched=!1,Debug.log("Dont give reward here!")}))})).catch((e=>{Debug.log("Rewarded Ad is not available"),this.app.fire("rewardedAd:notAvailable"),noADAvailableCallack(),n.loadingAdScreen.enabled=!1,window.alert("Rewarded ad not available!")}))},GameDistribution.prototype.update=function(e){};var TweenRotation=pc.createScript("tweenRotation");TweenRotation.attributes.add("RotationSpeed",{type:"number"}),TweenRotation.prototype.initialize=function(){},TweenRotation.prototype.update=function(t){var e=this.entity.getLocalEulerAngles().x,n=this.entity.getLocalEulerAngles().y,i=this.entity.getLocalEulerAngles().z-this.RotationSpeed*t;this.entity.setLocalEulerAngles(e,n,i)};var IntermissionAdmanager=pc.createScript("intermissionAdmanager");IntermissionAdmanager.instance=null,IntermissionAdmanager.prototype.initialize=function(){IntermissionAdmanager.instance=this,this.loadingAdScreen=this.app.root.findByName("Loading Ad Screen"),this.app.on(Events.OnLevelCompleted,this.onLevelCompleted,this)},IntermissionAdmanager.prototype.onLevelCompleted=function(){if(ConfigManager.instance.environmentType===ConfigManager.EnvTypes.None)this.onResume();else{this.loadingAdScreen.enabled=!0;const n=IntermissionAdmanager.instance.onResume.bind(this),e=IntermissionAdmanager.instance.onPause.bind(this);this.app.fire("showSimpleAD",n,e)}},IntermissionAdmanager.prototype.onResume=function(){this.loadingAdScreen.enabled=!1},IntermissionAdmanager.prototype.onPause=function(){this.loadingAdScreen.enabled=!0},IntermissionAdmanager.prototype.update=function(n){};var NoAdsManager=pc.createScript("noAdsManager");NoAdsManager.attributes.add("noAdPopup",{type:"entity"}),NoAdsManager.attributes.add("adSkippedPopup",{type:"entity"}),NoAdsManager.attributes.add("resumeBtnNoAd",{type:"entity"}),NoAdsManager.attributes.add("resumeBtnAdSkip",{type:"entity"}),NoAdsManager.prototype.initialize=function(){this.app.on("noAdPopup",this.noAdPopupState,this),this.app.on("adSkippedPopup",this.adSkippedPopupState,this),this.resumeBtnNoAd.button.on("click",this.onResumeBtnNoAdClicked,this),this.resumeBtnAdSkip.button.on("click",this.onresumeBtnAdSkipClicked,this)},NoAdsManager.prototype.onResumeBtnNoAdClicked=function(){this.noAdPopup.enabled=!1},NoAdsManager.prototype.onresumeBtnAdSkipClicked=function(){this.adSkippedPopup.enabled=!1},NoAdsManager.prototype.noAdPopupState=function(){this.noAdPopup.enabled=!0},NoAdsManager.prototype.adSkippedPopupState=function(){this.adSkippedPopup.enabled=!0},NoAdsManager.prototype.update=function(t){};var TweenRotation=pc.createScript("tweenRotation");TweenRotation.attributes.add("RotationSpeed",{type:"number"}),TweenRotation.prototype.initialize=function(){},TweenRotation.prototype.update=function(t){var e=this.entity.getLocalEulerAngles().x,n=this.entity.getLocalEulerAngles().y,i=this.entity.getLocalEulerAngles().z-this.RotationSpeed*t;this.entity.setLocalEulerAngles(e,n,i)};var PathColorSettings=pc.createScript("pathColorSettings");PathColorSettings.attributes.add("pathMat",{type:"asset",assetType:"material",title:"Path Material"}),PathColorSettings.attributes.add("borderMat",{type:"asset",assetType:"material",title:"Border Material"}),PathColorSettings.attributes.add("bigBossSettings",{title:"Big Boss Settings",type:"json",schema:[{name:"path",type:"rgb",title:"Path"},{name:"border",type:"rgb",title:"Border"}]}),PathColorSettings.attributes.add("bonusLevelSettings",{title:"Bonus Level Settings",type:"json",schema:[{name:"path",type:"rgb",title:"Path"},{name:"border",type:"rgb",title:"Border"}]}),PathColorSettings.attributes.add("colorSettings",{title:"Color Settings",type:"json",schema:[{name:"maxLevel",type:"number",title:"Max Level",description:"Maximum Level till this color settings will be applied."},{name:"keepDefault",type:"boolean",title:"Default Palette"},{name:"path",type:"rgb",title:"Path"},{name:"border",type:"rgb",title:"Border"}],array:!0}),PathColorSettings.prototype.initialize=function(){},PathColorSettings.prototype.update=function(t){},PathColorSettings.prototype.updateColors=function(t){if(t.isBiggBossLevel)this.implementUpdate(this.bigBossSettings.path,this.bigBossSettings.border);else if(t.isBonusLevel)this.implementUpdate(this.bonusLevelSettings.path,this.bonusLevelSettings.border);else{let e=this.getLevelColors(t.level);this.implementUpdate(e.pathColor,e.borderColor)}},PathColorSettings.prototype.getLevelColors=function(t){let e;for(let o=0;o<this.colorSettings.length;o++)if(!this.colorSettings[o].keepDefault&&this.colorSettings[o].maxLevel>=t%20){e={pathColor:this.colorSettings[o].path,borderColor:this.colorSettings[o].border};break}return e||{pathColor:this.defaultSettings.path,borderColor:this.defaultSettings.border}},PathColorSettings.prototype.implementUpdate=function(t,e){this.pathMat.resource.diffuse.set(t.r,t.g,t.b),this.pathMat.resource.update(),this.borderMat.resource.diffuse.set(e.r,e.g,e.b),this.borderMat.resource.update()};var ThemeSettings=pc.createScript("themeSettings");ThemeSettings.prototype.initialize=function(){},ThemeSettings.prototype.update=function(t){};var OptimizationManager=pc.createScript("optimizationManager");OptimizationManager.attributes.add("soundManager",{type:"entity"}),OptimizationManager.prototype.postInitialize=function(){this.soundManager.enabled=!0},OptimizationManager.prototype.initialize=function(){},OptimizationManager.prototype.update=function(t){};var KeyVfx=pc.createScript("keyVfx");KeyVfx.attributes.add("circle",{type:"entity"}),KeyVfx.attributes.add("vfx",{type:"entity"}),KeyVfx.prototype.initialize=function(){},KeyVfx.prototype.runVFX=function(){this.circle.setLocalScale(0,0,0),this.circle.sprite.opacity=1,this.circle.enabled=!0,this.circle.tween(this.circle.getLocalScale()).to(new pc.Vec3(.35,.35,.35),.25,pc.SineOut).on("complete",(()=>{TweenWrapper.TweenOpacity(this.circle.sprite,1,0,.1)})).start(),this.vfx.particlesystem.reset(),this.vfx.particlesystem.play()},KeyVfx.prototype.update=function(e){};var Facebook=pc.createScript("facebook");Facebook.instance=null;var resumeCallback=null,pauseCallback=null,resumeGiveRewardCallback=null,resumeNoRewardCallback=null,noADAvailableCallack=null;"undefined"!=typeof FBInstant&&(Facebook.prototype.initialize=function(){Facebook.instance=this,this.firstGamePlayed=!1,this.ads={bannerId:"640129264197014_640905857452688",interstitialData:[{id:"640129264197014_640906080785999",ready:!1,adView:null},{id:"640129264197014_640906197452654",ready:!1,adView:null}],rewardedData:[{id:"640129264197014_640906374119303",ready:!1,adView:null},{id:"640129264197014_640906560785951",ready:!1,adView:null}]},this.loadingAdScreen=this.app.root.findByName("Loading Ad Screen"),FBInstant.payments.onReady((()=>{})),this.loadBanner(),this.loadInterstitials(),this.loadRewardedVideos(),this.isRewardedAdWatched=!1,this.app.on("showSimpleAD",this.onShowSimpleAD,this),this.app.on("showRewardedAD",this.onShowRewardedAD,this),this.app.on("onTournamentBtnClick",this.onTournamentButton,this),this.app.on(Events.OnLevelCompleted,this.onGameFinished,this)},Facebook.prototype.loadBanner=function(){let e=this.ads.bannerId;FBInstant.loadBannerAdAsync(e).then((()=>{Debug.log(`Banner Ad loaded - ${e}`)})).catch((a=>{Debug.log(`Banner Ad failed to load - ${e}`),Debug.log(a),setTimeout((()=>{this.loadBanner()}),1e4)}))},Facebook.prototype.loadInterstitials=function(){let e=this.ads.interstitialData;for(let a=0;a<e.length;a++){let t=e[a];this.loadInterstitial(t)}},Facebook.prototype.loadInterstitial=function(e){FBInstant.getInterstitialAdAsync(e.id).then((a=>(e.adView=a,a.loadAsync()))).then((()=>{Debug.log(`Interstitial Ad loaded - ${e.id}`),e.ready=!0})).catch((a=>{Debug.log(`Interstitial Ad failed to load - ${e.id}`),Debug.error(a),setTimeout((()=>{this.loadInterstitial(e)}),3e4)}))},Facebook.prototype.loadRewardedVideos=function(){let e=this.ads.rewardedData;for(let a=0;a<e.length;a++){let t=e[a];this.loadRewarded(t)}},Facebook.prototype.loadRewarded=function(e){FBInstant.getRewardedVideoAsync(e.id).then((a=>(e.adView=a,a.loadAsync()))).then((()=>{Debug.log(`Rewarded Ad loaded - ${e.id}`),e.ready=!0})).catch((a=>{Debug.log(`Rewarded Ad failed to load - ${e.id}`),Debug.error(a),setTimeout((()=>{this.loadRewarded(e)}),3e4)}))},Facebook.prototype.onShowSimpleAD=function(e,a){resumeCallback=e,pauseCallback=a;let t,o=this.ads.interstitialData;for(let e=0;e<o.length;e++)if(o[e].ready){t=o[e];break}if(void 0!==t){t.adView.showAsync().then((()=>{t.ready=!1,this.loadInterstitialAd(t)})).catch((e=>{Debug.error(`Error trying to display ad ${t.id}`),Debug.error(e)})).finally((()=>{this.submitTournamentScore(),resumeCallback()}))}else Debug.log("No interstitial ad loaded."),this.submitTournamentScore(),resumeCallback()},Facebook.prototype.onShowRewardedAD=function(e,a,t,o){pauseCallback=a,resumeCallback=t,resumeGiveRewardCallback=e,noADAvailableCallack=o,Debug.log("onShowRewardedAD");let n,l=this.ads.rewardedData;for(let e=0;e<l.length;e++)if(l[e].ready){n=l[e];break}if(void 0!==n){const e=n.adView;Debug.log("Rewarded Ad is available"),e.showAsync().then((()=>{Debug.log("AD Comp"),Debug.log("giveReward"),Debug.log(resumeGiveRewardCallback),null!==resumeGiveRewardCallback&&resumeGiveRewardCallback(),Facebook.instance.app.fire("giveReward:resume")})).catch((e=>{Debug.log("Dont give reward here!"),null!==resumeCallback&&resumeCallback(),Facebook.instance.app.fire("game:resume")}))}else Debug.log("Rewarded Ad is not available"),this.app.fire("rewardedAd:notAvailable"),noADAvailableCallack(),this.loadingAdScreen.enabled=!1},Facebook.prototype.onGameFinished=function(){if(!this.firstGamePlayed){this.firstGamePlayed=!0,this.app.root.findByTag("FBTournament")[0].enabled=!0}if(void 0===this.currentLevel)if(isLSAvailable){let e=localStorage.getItem("currentTotalLevel");this.currentLevel=e?parseInt(e):1}else this.currentLevel=1},Facebook.prototype.submitTournamentScore=function(){Debug.log(`Reporting tournament score: ${this.currentLevel}`),FBInstant.postSessionScoreAsync(this.currentLevel)},Facebook.prototype.onTournamentButton=function(){Debug.log("Creating new tournament");let e=1;if(isLSAvailable){let a=localStorage.getItem("currentTotalLevel");e=a?parseInt(a):1}else e=1;let a={initialScore:e,data:{tournamentLevel:"normal"},config:{title:"Giant Rush !",sortOrder:"HIGHER_IS_BETTER",scoreFormat:"NUMERIC",endTime:parseInt(Date.now()/1e3+604800)}};FBInstant.tournament.createAsync(a).then((()=>{})).catch((e=>{Debug.log("Error attempting to create a new tournament"),Debug.log(e)}))});var VersionLabel=pc.createScript("versionLabel");VersionLabel.attributes.add("versionText",{type:"entity"}),VersionLabel.prototype.initialize=function(){this.app.on(this.app.events.configManager.initialized,this.onConfigInitialized,this)},VersionLabel.prototype.onConfigInitialized=function(){this.versionText.element.text=ConfigManager.instance.version};var UpgradeItemView=pc.createScript("upgradeItemView");UpgradeItemView.attributes.add("levelTxt",{type:"entity",title:"Level Txt"}),UpgradeItemView.attributes.add("priceTxt",{type:"entity",title:"Price Txt"}),UpgradeItemView.attributes.add("hand",{type:"entity",title:"Hand"}),UpgradeItemView.attributes.add("purchaseView",{type:"entity",title:"Purchase View"}),UpgradeItemView.attributes.add("adView",{type:"entity",title:"Ad View"}),UpgradeItemView.attributes.add("disabledView",{type:"entity",title:"Disabled View"}),UpgradeItemView.prototype.initialize=function(){this.notEnoughGems=!1,this.entity.on("UpdateView",this.updateView,this)},UpgradeItemView.prototype.update=function(e){},UpgradeItemView.prototype.updateView=function(e,t){Debug.log("updateView"),Debug.log(this.entity.name,": ",e,t),this.levelTxt.element.text=e,this.priceTxt.element.text=t;let i=DataManager.Instance.gems-t>=0;this.hand.enabled=i;this.purchaseView.enabled=i,this.adView.enabled=!i,this.disabledView.enabled=!1,this.notEnoughGems=this.adView.enabled};var RageRvViewController=pc.createScript("rageRvViewController");RageRvViewController.attributes.add("rageRvBtn",{type:"entity"}),RageRvViewController.attributes.add("closeBtn",{type:"entity"}),RageRvViewController.attributes.add("loadingAdScreen",{type:"entity"}),RageRvViewController.prototype.initialize=function(){RageRvViewController.instance=this,this.closeBtn.button.on("click",this.onCloseBtnClicked,this),this.rageRvBtn.button.on("click",this.onRageRvBtnClicked,this)},RageRvViewController.prototype.onCloseBtnClicked=function(){this.entity.enabled=!1,this.app.fire("Enable:Loading",!1)},RageRvViewController.prototype.onRageRvBtnClicked=function(){if(ConfigManager.instance.environmentType!==ConfigManager.EnvTypes.None){this.app.fire("Enable:Loading",!0);const e=RageRvViewController.instance.resumeGiveReward.bind(this),t=RageRvViewController.instance.pauseGame.bind(this),o=RageRvViewController.instance.resumeNoReward.bind(this),i=RageRvViewController.instance.adNotAvailable.bind(this);this.app.fire("showRewardedAD",e,t,o,i)}else this.onRewardSuccess()},RageRvViewController.prototype.onRewardSuccess=function(){Debug.log("RageRvViewController.onRewardSuccess()"),this.app.fire(Events.OnRageRvCompleted),this.onCloseBtnClicked()},RageRvViewController.prototype.onRewardFailed=function(){this.onCloseBtnClicked(),Debug.error("RageRvViewController.onRewardFailed()")},RageRvViewController.prototype.resumeGiveReward=function(){this.app.fire("Enable:Loading",!1),this.onRewardSuccess()},RageRvViewController.prototype.pauseGame=function(){this.app.fire("Enable:Loading",!0)},RageRvViewController.prototype.resumeNoReward=function(){this.app.fire("Enable:Loading",!1),this.app.fire("adSkippedPopup"),this.onRewardFailed()},RageRvViewController.prototype.adNotAvailable=function(){this.app.fire("Enable:Loading",!1),this.app.fire("noAdPopup"),this.onRewardFailed()},RageRvViewController.prototype.update=function(e){};var RotationTween=pc.createScript("rotationTween");RotationTween.attributes.add("yoyo",{type:"boolean",title:"Yoyo"}),RotationTween.attributes.add("loop",{type:"boolean",title:"Loop"}),RotationTween.attributes.add("type",{type:"string",title:"Type",default:"Linear"}),RotationTween.attributes.add("duration",{type:"number",title:"Duration"}),RotationTween.attributes.add("start",{type:"vec3",title:"Start"}),RotationTween.attributes.add("end",{type:"vec3",title:"End"}),RotationTween.prototype.postInitialize=function(){this.endRot=(new pc.Quat).setFromEulerAngles(this.end.x,this.end.y,this.end.z),this.playTween()},RotationTween.prototype.update=function(t){},RotationTween.prototype.playTween=function(){this.entity.setLocalEulerAngles(this.start.x,this.start.y,this.start.z),TweenWrapper.Tween(this.entity,this.entity.getLocalRotation(),this.endRot,this.duration,void 0,pc[this.type],this.loop,this.yoyo)};var DragEvent=pc.createScript("dragEvent");DragEvent.attributes.add("captureCount",{title:"Capture Count",type:"number",default:-1}),DragEvent.attributes.add("away",{title:"Away",type:"boolean"}),DragEvent.attributes.add("global",{title:"Global Space",type:"boolean"}),DragEvent.attributes.add("target",{title:"Target",type:"entity"}),DragEvent.attributes.add("minDistance",{title:"Minimum Distance",type:"number"}),DragEvent.attributes.add("eventName",{title:"Event To Raise",type:"string"}),DragEvent.attributes.add("uiSlider",{title:"UI Slider",type:"entity"}),DragEvent.attributes.add("args",{type:"json",title:"Arguments",schema:[{name:"value",type:"string"}],array:!0}),DragEvent.attributes.add("objsActiveState",{type:"json",title:"Entities To Manage",schema:[{title:"Enabled",name:"setActive",type:"boolean",default:!0},{title:"Entity",name:"obj",type:"entity"}],array:!0}),DragEvent.prototype.initialize=function(){this.capturedCount=0,this.onEnable(),this.on("enable",this.onEnable,this)},DragEvent.prototype.onEnable=function(){this.capturedCount=0,this.currentCaptureID=0,this.entity.element&&(this.entity.element.enabled=!0)},DragEvent.prototype.update=function(t){if(!this.target)return;if(!(null===this.uiSlider?this.entity.script.uiSlider:this.uiSlider.script.uiSlider).isDragging)return;let e=this.global?this.entity.getPosition():this.entity.getLocalPosition(),i=this.global?this.target.getPosition():this.target.getLocalPosition(),a=this.away?e.distance(i)>=this.minDistance:e.distance(i)<=this.minDistance;if(a&&this.checkCaptureSettings()){this.capturedCount++,this.raiseEvent();for(let t=0;t<this.objsActiveState.length;t++)this.objsActiveState[t].obj.enabled=this.objsActiveState[t].setActive}else a||this.currentCaptureID===this.capturedCount||(this.currentCaptureID=this.capturedCount)},DragEvent.prototype.raiseEvent=function(){if(this.eventName.length<1)return;let t=[];for(let e=0;e<this.args.length;e++)t.push(this.args[e].value);this.app.fire(this.eventName,t)},DragEvent.prototype.checkCaptureSettings=function(){let t=this.capturedCount<this.captureCount||-1===this.captureCount;return this.currentCaptureID===this.capturedCount&&t};var PaginationHandler=pc.createScript("paginationHandler");PaginationHandler.attributes.add("carousel",{type:"entity",title:"Pages Carousel"}),PaginationHandler.attributes.add("pages",{title:"Pages",type:"json",schema:[{name:"btn",type:"entity",title:"Button"},{name:"selected",type:"entity",title:"Selected Image"}],array:!0}),PaginationHandler.prototype.initialize=function(){this.prevPageIndex=1,this.currentPageIndex=0;for(let e=0;e<this.pages.length;e++)this.pages[e].btn.button.on("click",this.onClickPaginationBtnClick.bind(this,e));this.entity.on("SetPage",this.setPage,this)},PaginationHandler.prototype.update=function(e){},PaginationHandler.prototype.onClickPaginationBtnClick=function(e){this.setPage(e)},PaginationHandler.prototype.setPage=function(e){this.currentPageIndex!==e&&(this.prevPageIndex=this.currentPageIndex,this.currentPageIndex=e,this.pages[this.prevPageIndex].selected.enabled=!1,this.pages[this.currentPageIndex].selected.enabled=!0,Debug.log("index: ",i),this.carousel.fire("SetPage",e))};var CarouselHandler=pc.createScript("carouselHandler");CarouselHandler.attributes.add("adjustDuration",{type:"number",title:"Adjust Duration"}),CarouselHandler.attributes.add("stoppingSpeed",{type:"number",title:"Stopping Speed"}),CarouselHandler.attributes.add("viewport",{type:"entity",title:"Viewport"}),CarouselHandler.attributes.add("content",{type:"entity",title:"Content"}),CarouselHandler.attributes.add("scrollBar",{type:"entity",title:"Scroll Bar"}),CarouselHandler.attributes.add("pagination",{type:"entity",title:"Pagination Handler"}),CarouselHandler.attributes.add("pages",{type:"json",title:"Pages",schema:[{name:"page",title:"Page",type:"entity"}],array:!0}),CarouselHandler.prototype.initialize=function(){this.scrollWidth=this.content.element.width,this.perPageWidth=this.scrollWidth/this.pages.length,this.currentScrollValue=0,this.entity.on("SetPage",this.tweenToPage,this),this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onPressDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onPressUp,this),this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchEnd,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchEnd,this))},CarouselHandler.prototype.update=function(t){let e=Math.abs(this.currentScrollValue-this.scrollBar.scrollbar.value);e>=this.stoppingSpeed&&this.isPressed&&(this.pageTween&&TweenWrapper.StopTween(this.pageTween),this.isScrolling=!0),this.isScrolling&&(e<this.stoppingSpeed&&!this.isPressed&&(this.isScrolling=!1,this.adjustCarousel()),this.currentScrollValue=this.scrollBar.scrollbar.value)},CarouselHandler.prototype.onTouchStart=function(t){var e=t.changedTouches[0];this.touchId=e.identifier,this.startDrag(t.x,t.y),t.event.stopPropagation()},CarouselHandler.prototype.onTouchEnd=function(t){t.event.stopImmediatePropagation(),this.endDrag()},CarouselHandler.prototype.onPressDown=function(t){t.event.stopImmediatePropagation(),this.startDrag(t.x,t.y)},CarouselHandler.prototype.onPressUp=function(t){t.event.stopImmediatePropagation(),this.endDrag(t.x,t.y)},CarouselHandler.prototype.startDrag=function(t,e){this.isPressed=!0},CarouselHandler.prototype.endDrag=function(t,e){this.isPressed=!1},CarouselHandler.prototype.adjustCarousel=function(){let t=0,e=this.scrollWidth,s=this.viewport.getPosition().x;for(let a=0;a<this.pages.length;a++){let i=this.pages[a].page.getPosition().x,r=Math.abs(s-i);r<e&&(e=r,t=a)}this.tweenToPage(t),this.pagination.fire("SetPage",t)},CarouselHandler.prototype.tweenToPage=function(t){let e=this.scrollBar.scrollbar.value*this.scrollWidth,s=t*(this.scrollWidth/(this.pages.length-1));this.pageTween&&TweenWrapper.StopTween(this.pageTween),this.pageTween=TweenWrapper.TweenNumber(e,s,this.adjustDuration,(t=>{this.currentScrollValue=t.number/this.scrollWidth,this.scrollBar.scrollbar.value=t.number/this.scrollWidth}))};var LoadingMenuEventListener=pc.createScript("loadingMenuEventListener");LoadingMenuEventListener.attributes.add("loading",{type:"entity",title:"Loading Screen"}),LoadingMenuEventListener.prototype.initialize=function(){this.app.on("Enable:Loading",this.enableLoading,this)},LoadingMenuEventListener.prototype.enableLoading=function(e){e?this.loading.enabled=!0:this.loading.fire("disable")};var MenuLoading=pc.createScript("menuLoading");MenuLoading.attributes.add("nextScene",{type:"string",title:"Next Scene",default:"LoadingScene"}),MenuLoading.attributes.add("text",{type:"entity",title:"Feedback Text"}),MenuLoading.attributes.add("assets",{type:"asset",title:"Assets",array:!0}),MenuLoading.attributes.add("logo",{type:"entity",title:"CSR logo"}),MenuLoading.prototype.initialize=function(){this.words=["MAPS","COINS","LEVELS","BITMOJI","SKILLS","REWARDS","SKY","CHESTS","FRIENDS","BOXES","FUN"],this.timeArray=[800,1e3,500,1200,900,700,1500,1100],this.textFunction=function(){let t=this.words[Math.floor(Math.random()*this.words.length)];this.text.element.text="LOADING "+t+"...",clearInterval(this.textInterval),this.textInterval=setInterval(this.textFunction,this.timeArray[Math.floor(Math.random()*this.timeArray.length)])}.bind(this),this.textInterval=setInterval(this.textFunction,800),this.loadedAssetsNumber=0,this.onLoaded=function(t){this.loadedAssetsNumber++,this.loadedAssetsNumber>=this.assets.length&&(Debug.log("Loading Assets Complete"),clearInterval(this.textInterval),this.loadScene())}},MenuLoading.prototype.postInitialize=function(){this.load()},MenuLoading.prototype.load=function(){for(let e=0;e<this.assets.length;++e){var t=this.assets[e];t.loaded?this.onLoaded(t):(t.ready(this.onLoaded.bind(this)),this.app.assets.load(t))}},MenuLoading.prototype.loadScene=function(){var t=this.app.root.findByName("Root"),e=this.app.scenes.find(this.nextScene);this.app.scenes.loadSceneHierarchy(e.url,(function(e,i){e?console.error(e):(t.destroy(),setTimeout((()=>{i.enabled=!0}),60))}))};"undefined"!=typeof document&&(
/*! FPSMeter 0.3.1 - 9th May 2013 | https://github.com/Darsain/fpsmeter */
function(t,e){function s(t,e){for(var n in e)try{t.style[n]=e[n]}catch(t){}return t}function H(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof t}function R(t,e){if("array"!==H(e))return-1;if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1}function I(){var t,e=arguments;for(t in e[1])if(e[1].hasOwnProperty(t))switch(H(e[1][t])){case"object":e[0][t]=I({},e[0][t],e[1][t]);break;case"array":e[0][t]=e[1][t].slice(0);break;default:e[0][t]=e[1][t]}return 2<e.length?I.apply(null,[e[0]].concat(Array.prototype.slice.call(e,2))):e[0]}function N(t){return 1===(t=Math.round(255*t).toString(16)).length?"0"+t:t}function S(t,e,n,o){t.addEventListener?t[o?"removeEventListener":"addEventListener"](e,n,!1):t.attachEvent&&t[o?"detachEvent":"attachEvent"]("on"+e,n)}function D(t,e){function g(t,e,n,o){return h[0|t][Math.round(Math.min((e-n)/(o-n)*M,M))]}function r(){F.legend.fps!==q&&(F.legend.fps=q,F.legend[c]=q?"FPS":"ms"),b=q?v.fps:v.duration,F.count[c]=999<b?"999+":b.toFixed(99<b?0:O.decimals)}function m(){for(l=n(),P<l-O.threshold&&(v.fps-=v.fps/Math.max(1,60*O.smoothing/O.interval),v.duration=1e3/v.fps),w=O.history;w--;)T[w]=0===w?v.fps:T[w-1],j[w]=0===w?v.duration:j[w-1];if(r(),O.heat){if(z.length)for(w=z.length;w--;)z[w].el.style[o[z[w].name].heatOn]=q?g(o[z[w].name].heatmap,v.fps,0,O.maxFps):g(o[z[w].name].heatmap,v.duration,O.threshold,0);if(F.graph&&o.column.heatOn)for(w=C.length;w--;)C[w].style[o.column.heatOn]=q?g(o.column.heatmap,T[w],0,O.maxFps):g(o.column.heatmap,j[w],O.threshold,0)}if(F.graph)for(y=0;y<O.history;y++)C[y].style.height=(q?T[y]?Math.round(x/O.maxFps*Math.min(T[y],O.maxFps)):0:j[y]?Math.round(x/O.threshold*Math.min(j[y],O.threshold)):0)+"px"}function k(){20>O.interval?(p=i(k),m()):(p=setTimeout(k,O.interval),f=i(m))}function G(t){(t=t||window.event).preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0),v.toggle()}function U(){O.toggleOn&&S(F.container,O.toggleOn,G,1),t.removeChild(F.container)}function V(){if(F.container&&U(),o=D.theme[O.theme],!(h=o.compiledHeatmaps||[]).length&&o.heatmaps.length){for(y=0;y<o.heatmaps.length;y++)for(h[y]=[],w=0;w<=M;w++){var e,n=h[y],a=w;e=.33/M*w;var i=o.heatmaps[y].saturation,l=o.heatmaps[y].lightness,p=void 0,c=void 0,u=void 0,d=u=void 0,f=p=c=void 0;f=void 0;0===(u=.5>=l?l*(1+i):l+i-l*i)?e="#000":(c=(u-(d=2*l-u))/u,f=(e*=6)-(p=Math.floor(e)),f*=u*c,0===p||6===p?(p=u,c=d+f,u=d):1===p?(p=u-f,c=u,u=d):2===p?(p=d,c=u,u=d+f):3===p?(p=d,c=u-f):4===p?(p=d+f,c=d):(p=u,c=d,u-=f),e="#"+N(p)+N(c)+N(u)),n[a]=e}o.compiledHeatmaps=h}for(var b in F.container=s(document.createElement("div"),o.container),F.count=F.container.appendChild(s(document.createElement("div"),o.count)),F.legend=F.container.appendChild(s(document.createElement("div"),o.legend)),F.graph=O.graph?F.container.appendChild(s(document.createElement("div"),o.graph)):0,z.length=0,F)F[b]&&o[b].heatOn&&z.push({name:b,el:F[b]});if(C.length=0,F.graph)for(F.graph.style.width=O.history*o.column.width+(O.history-1)*o.column.spacing+"px",w=0;w<O.history;w++)C[w]=F.graph.appendChild(s(document.createElement("div"),o.column)),C[w].style.position="absolute",C[w].style.bottom=0,C[w].style.right=w*o.column.width+w*o.column.spacing+"px",C[w].style.width=o.column.width+"px",C[w].style.height="0px";s(F.container,O),r(),t.appendChild(F.container),F.graph&&(x=F.graph.clientHeight),O.toggleOn&&("click"===O.toggleOn&&(F.container.style.cursor="pointer"),S(F.container,O.toggleOn,G))}"object"===H(t)&&undefined===t.nodeType&&(e=t,t=document.body),t||(t=document.body);var o,h,l,p,f,x,b,w,y,v=this,O=I({},D.defaults,e||{}),F={},C=[],M=100,z=[],E=O.threshold,A=0,P=n()-E,T=[],j=[],q="fps"===O.show;v.options=O,v.fps=0,v.duration=0,v.isPaused=0,v.tickStart=function(){A=n()},v.tick=function(){l=n(),E+=(l-P-E)/O.smoothing,v.fps=1e3/E,v.duration=A<P?E:l-A,P=l},v.pause=function(){return p&&(v.isPaused=1,clearTimeout(p),a(p),a(f),p=f=0),v},v.resume=function(){return p||(v.isPaused=0,k()),v},v.set=function(t,e){return O[t]=e,q="fps"===O.show,-1!==R(t,u)&&V(),-1!==R(t,d)&&s(F.container,O),v},v.showDuration=function(){return v.set("show","ms"),v},v.showFps=function(){return v.set("show","fps"),v},v.toggle=function(){return v.set("show",q?"ms":"fps"),v},v.hide=function(){return v.pause(),F.container.style.display="none",v},v.show=function(){return v.resume(),F.container.style.display="block",v},v.destroy=function(){v.pause(),U(),v.tick=v.tickStart=function(){}},V(),k()}var n,o=t.performance;n=o&&(o.now||o.webkitNow)?o[o.now?"now":"webkitNow"].bind(o):function(){return+new Date};for(var a=t.cancelAnimationFrame||t.cancelRequestAnimationFrame,i=t.requestAnimationFrame,h=0,l=0,p=(o=["moz","webkit","o"]).length;l<p&&!a;++l)i=(a=t[o[l]+"CancelAnimationFrame"]||t[o[l]+"CancelRequestAnimationFrame"])&&t[o[l]+"RequestAnimationFrame"];a||(i=function(e){var o=n(),a=Math.max(0,16-(o-h));return h=o+a,t.setTimeout((function(){e(o+a)}),a)},a=function(t){clearTimeout(t)});var c="string"===H(document.createElement("div").textContent)?"textContent":"innerText";D.extend=I,window.FPSMeter=D,D.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var u=["toggleOn","theme","heat","graph","history"],d="position zIndex left top right bottom margin".split(" ")}(window),function(t,e){e.theme={};var n=e.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};e.theme.dark=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),e.theme.light=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),e.theme.colorful=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),e.theme.transparent=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter));var Fps=pc.createScript("fps");Fps.prototype.initialize=function(){this.fps=new FPSMeter({heat:!0,graph:!0})},Fps.prototype.update=function(t){this.fps.tick()};